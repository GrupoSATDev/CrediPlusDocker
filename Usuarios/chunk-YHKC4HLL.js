import{a as ye,b as Ee,c as De,d as Ie,e as Fe,f as q}from"./chunk-3CKGSKVJ.js";import{a as we,b as Ae}from"./chunk-LLFQKHOK.js";import{a as L,b as D}from"./chunk-NQLJHABK.js";import"./chunk-MQ3T6S2J.js";import{g as B}from"./chunk-YJXL6IUM.js";import{c as le,p as se,q as me,r as de,s as ce}from"./chunk-ORVZHQWX.js";import{a as _e}from"./chunk-ZJ2UEKX5.js";import{B as P,C as Ce,F as Se,a as pe,b as ue,h as fe,l as xe,n as U,p as ve,s as be,v as he}from"./chunk-GY3TTE7T.js";import{J as re,K as ne,M as ae,Z as N,ca as ge}from"./chunk-M2VJVOQM.js";import"./chunk-ZLDQXQHK.js";import{a as O}from"./chunk-627EBV2J.js";import{d as j,e as te,f as k,i as V,k as $,p as R,w as ie,y as oe}from"./chunk-E6T5AQHJ.js";import{$ as b,$b as T,Ab as t,Bb as n,Cb as C,Db as z,Eb as G,Gb as Z,Mb as S,Ob as g,Wb as i,Xa as s,Xb as c,Yb as _,Zb as W,_b as M,cc as X,dc as ee,ea as h,fa as d,hc as f,ia as I,ic as E,jc as w,nb as x,pb as p,q as J,sa as F,ta as A,wa as K,wb as Q}from"./chunk-5OWIQWP2.js";import{a as y}from"./chunk-NEB6MB4Y.js";var Me=(()=>{let o=class o{constructor(e,l){this._http=e,this.appSettings=l}getCreditos(e){return this._http.get(`${this.appSettings.creditos.url.base}/${e}`)}getCredito(e){return this._http.get(`${this.appSettings.creditos.url.base}/${e}`)}putCredito(e){let l=e.id;return delete e.id,this._http.put(`${this.appSettings.creditos.url.base}/${l}`,e)}};o.\u0275fac=function(l){return new(l||o)(h(R),h(O))},o.\u0275prov=b({token:o,factory:o.\u0275fac,providedIn:"root"});let r=o;return r})();var Te=(()=>{let o=class o extends ae{parse(e){if(e){let[l,m,u]=e.split("-").map(Number);return new Date(l,m-1,u)}return null}format(e,l){let m=e.getFullYear(),u=(e.getMonth()+1).toString().padStart(2,"0");return`${e.getDate().toString().padStart(2,"0")}/${u}/${m}`}};o.\u0275fac=(()=>{let e;return function(m){return(e||(e=K(o)))(m||o)}})(),o.\u0275prov=b({token:o,factory:o.\u0275fac});let r=o;return r})();var Re=(r,o)=>({"bg-crediblue-50":r,"bg-credigray-100":o});function Ne(r,o){r&1&&(t(0,"mat-error"),i(1,"El valor es requerido!"),n())}function Be(r,o){r&1&&(t(0,"mat-error"),i(1,"El valor ingresado no puede superar el cupo disponible!"),n())}var Oe={validation:!1},je=(()=>{let o=class o{constructor(){this._matData=d(me),this.swalService=d(L),this.tipoSolicitudService=d(Fe),this.tipoSolicitud$=this.tipoSolicitudService.getTipos().pipe(J(e=>(this.idSolicitud=e.data[0].id,e))).subscribe(),this.cupo=new be(""),this.fuseService=d(B),this.solicitudService=d(Ee),this.dialogRef=d(se)}validarCampo(){this.cupoAvance=this._matData.data.cupoDisponible*20/100,this.cupo.setValidators(U.compose([U.required,Pe(this.cupoAvance)])),this.cupo.updateValueAndValidity()}onSave(){let e={cupo:Number(this.cupo.value),idTipoSolicitud:this.idSolicitud};this.fuseService.open(y({},D)).afterClosed().subscribe(m=>{m==="confirmed"?this.solicitudService.postSolicitudes(e).subscribe(u=>{this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.closeDialog()},u=>{this.swalService.ToastAler({icon:"info",title:u.error.errorMenssages[0],timer:6e3})}):this.closeDialog()})}closeDialog(){this.dialogRef.close()}ngOnInit(){this.validarCampo()}};o.\u0275fac=function(l){return new(l||o)},o.\u0275cmp=I({type:o,selectors:[["app-dialog-confirm-desembolso"]],standalone:!0,features:[M([De(Oe)]),T],decls:25,vars:17,consts:[[1,"relative","flex","h-full","w-full","flex-col"],[1,"flex","flex-auto","flex-col","items-center","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"flex","h-10","w-10","flex-0","items-center","justify-center","rounded-full","sm:mr-4","bg-blue-100","text-blue-600","dark:bg-blue-600","dark:text-blue-50"],[3,"svgIcon"],[1,"flex","flex-col","items-center","space-y-1","text-center","sm:mt-0","sm:items-start","sm:pr-8","sm:text-left"],[1,"text-xl","font-medium","leading-6"],[1,"text-secondary"],[1,"mt-4","flex","flex-col","items-center","space-y-1","text-center","sm:mt-0","sm:items-start","sm:text-left"],["floatLabel","always",1,"w-full"],["matInput","","thousandSeparator",".","placeholder","Valor solicitado",3,"formControl","mask"],[4,"ngIf"],[1,"flex","flex-col","sm:flex-row","gap-2","items-center","justify-center","bg-gray-50","py-4","dark:bg-black","dark:bg-opacity-10","sm:justify-end"],["mat-stroked-button","",1,"sm:w-auto","w-full","bg-crediorange-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"matDialogClose"],["mat-flat-button","",1,"sm:w-auto","w-full","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click","color","matDialogClose","ngClass","disabled"]],template:function(l,m){l&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),C(3,"mat-icon",3),n(),t(4,"div",4)(5,"div",5),i(6," Confirmacion "),n(),t(7,"div",6),i(8," Tu cupo disponible para avance es de "),t(9,"b"),i(10),f(11,"currency"),n(),i(12,", puedes solicitar un valor menor o igual a este. "),n()()(),t(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),i(16,"Valor"),n(),C(17,"input",9),x(18,Ne,2,0,"mat-error",10)(19,Be,2,0,"mat-error",10),n()(),t(20,"div",11)(21,"button",12),i(22," Cancelar "),n(),t(23,"button",13),S("click",function(){return m.onSave()}),i(24," Confirmar "),n()()()),l&2&&(s(3),p("svgIcon","heroicons_solid:question-mark-circle"),s(7),c(w(11,11,m.cupoAvance,"USD")),s(7),p("formControl",m.cupo)("mask","separator.0"),s(),p("ngIf",m.cupo.touched&&m.cupo.hasError("required")),s(),p("ngIf",(m.cupo.touched||m.cupo.dirty)&&m.cupo.hasError("notEqual")),s(2),p("matDialogClose","cancelled"),s(2),p("color","primary")("matDialogClose","confirmed")("ngClass",X(14,Re,m.cupo.valid,m.cupo.invalid))("disabled",m.cupo.invalid))},dependencies:[P,xe,ve,N,fe,ge,Se,pe,ce,Ce,he,k,ue,$,Ie,j],styles:[".custom-dialog-container{width:100%}@media (min-width: 600px){  .custom-dialog-container{width:40%}}@media (min-width: 1280px){  .custom-dialog-container{width:33.333333%}}"]});let r=o;return r})();function Pe(r){return o=>{let a=o.value;return console.log(r),a>r?{notEqual:!0}:null}}var ke=(()=>{let o=class o{constructor(e,l){this._http=e,this.appSettings=l}getDetalle(e){return this._http.get(`${this.appSettings.detalleConsumos.url.base}/${e}`)}getConsumo(e){return this._http.get(`${this.appSettings.detalleConsumos.url.base}/${e}`)}getConsumoTrabajador(e){return this._http.get(`${this.appSettings.detalleConsumos.url.baseTrabajador}/${e}`)}postDetalle(e){return this._http.post(this.appSettings.detalleConsumos.url.base,e)}postDesembolso(e){return this._http.post(this.appSettings.detalleConsumos.url.base,e)}getResumen(e){return this._http.get(`${this.appSettings.detalleConsumos.url.base}/trabajador/${e}`)}patchConsumo(e){let l=e.id;delete e.id;let{idEstado:m}=e;return this._http.patch(`${this.appSettings.detalleConsumos.url.base}/${l}?idEstado=${m}`,{})}};o.\u0275fac=function(l){return new(l||o)(h(R),h(O))},o.\u0275prov=b({token:o,factory:o.\u0275fac,providedIn:"root"});let r=o;return r})();var Le=(r,o,a)=>({"bg-green-600":r,"bg-yellow-600":o,"bg-red-600":a});function qe(r,o){r&1&&(t(0,"p",16),i(1,"Movimientos"),n())}function He(r,o){if(r&1){let a=Z();z(0),t(1,"div",25)(2,"button",26),S("click",function(){F(a);let l=g().$implicit,m=g(3);return A(m.onReject(l.id))}),i(3," Rechazar "),n(),t(4,"button",27),S("click",function(){F(a);let l=g().$implicit,m=g(3);return A(m.onSave(l.id))}),i(5," Aprobar "),n()(),G()}}function ze(r,o){if(r&1&&(z(0),t(1,"fuse-card",20)(2,"div",21)(3,"p",10),i(4),n(),t(5,"p",10),i(6),f(7,"date"),n()(),t(8,"div",21)(9,"p",10),i(10,"Factura: "),t(11,"span",11),i(12),n()(),t(13,"p",10),i(14,"Valor: "),t(15,"span",11),i(16),f(17,"currency"),n()()(),t(18,"div",21)(19,"p",10),i(20,"Cuotas: "),t(21,"span",11),i(22),n()(),t(23,"p",10),i(24),n()(),t(25,"div",21)(26,"p",10),i(27,"Tipo: "),t(28,"span",11),i(29),n()()(),t(30,"div",22),C(31,"p",23),n(),x(32,He,6,0,"ng-container",24),n(),G()),r&2){let a=o.$implicit,e=g(3);s(4),c(a.nombreSubEmpresa),s(2),c(w(7,9,a.fechaCreacion,"dd/MM/yyyy")),s(6),_(" ",a.numeroFactura," "),s(4),_(" ",E(17,12,a.montoConsumo)," "),s(6),_(" ",a.cantidadCuotas," "),s(2),c(a.nombreEstadoCredito),s(5),_(" ",a.nombreTipoConsumo," "),s(2),p("ngClass",ee(14,Le,a.idEstadoCredito==e.CodigosDetalleConsumo.APROBADA,a.idEstadoCredito==e.CodigosDetalleConsumo.EN_REVISION,a.idEstadoCredito==e.CodigosDetalleConsumo.RECHAZADA)),s(),p("ngIf",a.idEstadoCredito==e.CodigosDetalleConsumo.EN_REVISION)}}function Ge(r,o){if(r&1&&(t(0,"div",17)(1,"div",18),x(2,ze,33,18,"ng-container",19),n()()),r&2){let a=g(2);s(2),p("ngForOf",a.items.detalleConsumos)}}function Ze(r,o){if(r&1){let a=Z();t(0,"div",0)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h2",5),i(5,"Detalle de Cr\xE9dito"),n()(),t(6,"div",6)(7,"div",7)(8,"div",8)(9,"h3",9),i(10),n(),t(11,"p",10),i(12,"Identificaci\xF3n: "),t(13,"span",11),i(14),n()(),t(15,"p",10),i(16,"Empresa: "),t(17,"span",11),i(18),n()(),t(19,"p",10),i(20,"Cargo: "),t(21,"span",11),i(22),n()(),t(23,"p",10),i(24,"Correo: "),t(25,"span",11),i(26),n()(),t(27,"p",10),i(28,"Direcci\xF3n: "),t(29,"span",11),i(30),n()(),t(31,"p",10),i(32,"Tel\xE9fono: "),t(33,"span",11),i(34),n()()(),t(35,"div",8)(36,"p",10),i(37,"N\xFAmero de cr\xE9dito: "),t(38,"span",11),i(39),n()(),t(40,"p",10),i(41,"Cupo aprobado: "),t(42,"span",11),i(43),f(44,"currency"),n()(),t(45,"p",10),i(46,"Tasa de interes: "),t(47,"span",11),i(48),n()(),t(49,"p",10),i(50,"Fecha de aprobacion: "),t(51,"span",11),i(52),f(53,"date"),n()(),t(54,"p",10),i(55,"Fecha de vencimiento: "),t(56,"span",11),i(57),f(58,"date"),n()(),t(59,"p",10),i(60,"Cupo utilizado: "),t(61,"span",11),i(62),f(63,"currency"),n()(),t(64,"p",10),i(65,"Saldo Disponible: "),t(66,"span",11),i(67),f(68,"currency"),n()(),t(69,"button",12),S("click",function(){F(a);let l=g();return A(l.onSolicitud())}),i(70," Solicitar avance "),n()()(),C(71,"hr",13),x(72,qe,2,0,"p",14)(73,Ge,3,1,"div",15),n()()()()}if(r&2){let a=g();s(10),W("",a.items.trabajador.primerNombre," ",a.items.trabajador.segundoNombre," ",a.items.trabajador.primerApellido," ",a.items.trabajador.segundoApellido," "),s(4),c(a.items.trabajador.numDoc),s(4),c(a.items.nombreSubEmpresa),s(4),c(a.items.trabajador.cargo),s(4),c(a.items.trabajador.correo),s(4),c(a.items.trabajador.direccion),s(4),c(a.items.trabajador.telefono),s(5),c(a.items.numCredito),s(4),c(E(44,19,a.items.cupoAprobado)),s(5),_("",a.items.porcTasaInteres,"%"),s(4),c(w(53,21,a.items.fechaAprobacion,"dd/MM/yyyy")),s(5),c(w(58,24,a.items.fechaVencimiento,"dd/MM/yyyy")),s(5),c(E(63,27,a.items.cupoConsumido)),s(5),c(E(68,29,a.items.cupoDisponible)),s(5),p("ngIf",a.items.detalleConsumos),s(),p("ngIf",a.items.detalleConsumos)}}function Ue(r,o){r&1&&(t(0,"div",1)(1,"div",2)(2,"fuse-alert",28)(3,"span",29),i(4,"Informaci\xF3n"),n(),i(5," No cuentas con cr\xE9ditos activos. "),n()()()),r&2&&(s(2),p("type","info")("appearance","outline"))}var Y=(()=>{let o=class o{constructor(){this.toasService=d(ye),this.fuseService=d(B),this.estadosDatosService=d(we),this.activatedRoute=d(ie),this.creditoService=d(Me),this.detalleConsumoService=d(ke),this.router=d(oe),this.datePipe=d(V),this.data=[],this.capital=[],this.estadoCredito=[],this.tasas=[],this.idCredito="",this._matDialog=d(de),this.swalService=d(L),this.CodigosDetalleConsumo=q}ngOnDestroy(){this.subcription$.unsubscribe()}onSolicitud(){this._matDialog.open(je,{data:{data:this.items},disableClose:!0,panelClass:"custom-dialog-container"})}onSave(e){let l={idEstado:q.APROBADA,id:e};this.fuseService.open(y({},D)).afterClosed().subscribe(u=>{u==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(l).subscribe(v=>{v.isExitoso&&(this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.getCredito(this.idCredito))},v=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}))})}onReject(e){let l={idEstado:q.RECHAZADA,id:e};this.fuseService.open(y({},D)).afterClosed().subscribe(u=>{u==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(l).subscribe(v=>{v.isExitoso&&(this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.getCredito(this.idCredito))},v=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}))})}ngOnInit(){this.idCredito="Trabajador",this.getCredito(this.idCredito)}getCredito(e){this.subcription$=this.creditoService.getCredito(e).subscribe(l=>{this.items=l.data})}};o.\u0275fac=function(l){return new(l||o)},o.\u0275cmp=I({type:o,selectors:[["app-form-view-detalle"]],standalone:!0,features:[M([{provide:ne,useClass:Te},{provide:re,useValue:"en-GB"},V]),T],decls:2,vars:1,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-4","sm:p-8","print:p-0","w-full"],[1,"bg-card","shadow","print:bg-transparent","print:p-0","print:shadow-none","rounded-2xl","mx-auto","overflow-hidden","w-full","max-w-5xl"],[1,"bg-crediblue-50","px-6","py-4","flex","items-center","justify-between"],[1,"text-lg","sm:text-xl","font-bold","text-white"],[1,"p-4","sm:p-6"],[1,"mb-4","grid","grid-cols-1","md:grid-cols-2","gap-4","justify-items-stretch","lg:justify-items-center"],[1,"space-y-4"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-800"],[1,"font-medium","text-gray-600"],[1,"text-md","text-secondary"],["mat-flat-button","",1,"lg:w-auto","w-full","mt-4","bg-green-600","transition","duration-200","text-white","font-semibold","rounded-lg","md:w-auto",3,"click"],[1,"my-4"],["class","lg:text-center text-lg font-semibold font-bold mb-6",4,"ngIf"],["class","mb-4",4,"ngIf"],[1,"lg:text-center","text-lg","font-semibold","font-bold","mb-6"],[1,"mb-4"],[1,"flex","flex-wrap","gap-2.5","justify-center"],[4,"ngFor","ngForOf"],[1,"flex","flex-col","p-6","rounded-2xl","shadow-2xl","w-full","md:w-1/2","lg:w-96"],[1,"flex","justify-between"],[1,"w-full","mt-2"],[1,"h-2.5","rounded-full",3,"ngClass"],[4,"ngIf"],[1,"flex","justify-between","items-center","mt-2","p-4","gap-2.5"],["mat-flat-button","",1,"lg:w-auto","w-full","bg-crediorange-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],["mat-flat-button","",1,"lg:w-auto","w-full","bg-crediblue-50","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],[3,"type","appearance"],["fuseAlertTitle",""]],template:function(l,m){l&1&&x(0,Ze,74,31,"div",0)(1,Ue,6,2,"div",1),l&2&&Q(m.items?0:1)},dependencies:[le,$,V,P,N,te,k,Ae,j,_e]});let r=o;return r})();var Gt=[{path:"",component:Y},{path:"view-detalle/:id",component:Y}];export{Gt as default};
