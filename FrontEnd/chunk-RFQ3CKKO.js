import"./chunk-JDCS2AFX.js";import{a as k}from"./chunk-5WR2EL64.js";import{a as Y}from"./chunk-TWXLIPGF.js";import{a as Z,b as ee}from"./chunk-XTBUANS6.js";import{a as te}from"./chunk-OFI6PGZL.js";import{a as X}from"./chunk-72OGA3YA.js";import{a as j}from"./chunk-4WJQLHI3.js";import{a as y}from"./chunk-VOLXTRGQ.js";import"./chunk-54OZA4EP.js";import"./chunk-BGM5RQG6.js";import{g as L}from"./chunk-B24N63ZV.js";import{a as N,b as G,c as R}from"./chunk-PG3Z5E5P.js";import"./chunk-P2KBT4CK.js";import{C as Q,F as W,J as C,b as $,i as g,l as B,p as H,q as U,u as q,x as J,y as K}from"./chunk-XMPVE5LH.js";import{Q as V,R as P,ea as S,ja as z}from"./chunk-AAD5V3QY.js";import"./chunk-AUCKEBH6.js";import{b as O}from"./chunk-MFC34HHM.js";import{Cb as u,Dc as f,Ea as T,Gc as w,Mb as c,Mc as I,Ob as A,Qa as s,Ub as v,Vb as b,ba as _,ga as F,ha as l,ib as n,ma as h,q as M,tb as i,ub as a,vb as p}from"./chunk-YBEOGPR3.js";import{a as x}from"./chunk-NEB6MB4Y.js";var D=(()=>{let r=class r{constructor(e,t){this._http=e,this.appSettings=t}getCobros(){return this._http.get(this.appSettings.cobrosFijos.url.base)}getCobro(e){return this._http.get(`${this.appSettings.cobrosFijos.url.base}/${e}`)}postCobros(e){return delete e.id,this._http.post(this.appSettings.cobrosFijos.url.base,e)}putCobros(e){let t=e.id;return delete e.id,this._http.put(`${this.appSettings.cobrosFijos.url.base}/${t}`,e)}};r.\u0275fac=function(t){return new(t||r)(F(I),F(O))},r.\u0275prov=_({token:r,factory:r.\u0275fac,providedIn:"root"});let m=r;return m})();var ae={validation:!1},E=(()=>{let r=class r{constructor(){this.fb=l(Q),this.dialogRef=l(N),this.fuseService=l(L),this.estadosDatosService=l(y),this._matData=l(G),this.swalService=l(te),this.destroyedRef=l(T),this.cobrosFijosService=l(D)}ngOnInit(){this.createForm();let e=this._matData;if(e.edit){let t=e.data;this.getCobro(t.id)}}onSave(){if(this.form.valid)if(this._matData.edit){let e=this.form.getRawValue();this.fuseService.open(x({},j)).afterClosed().subscribe(o=>{o==="confirmed"?this.cobrosFijosService.putCobros(e).pipe(k(this.destroyedRef)).subscribe(d=>{this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro actualizado con exito!",timer:4e3}),this.closeDialog()},d=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al actualizar el registro!",timer:4e3})}):this.closeDialog()})}else{let e=this.form.getRawValue();this.fuseService.open(x({},j)).afterClosed().subscribe(o=>{o==="confirmed"?this.cobrosFijosService.postCobros(e).pipe(k(this.destroyedRef)).subscribe(d=>{console.log(d),this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro Creado o Actualizado con Exito.",timer:4e3}),this.closeDialog()},d=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}):this.closeDialog()})}}getCobro(e){this.cobrosFijosService.getCobro(e).subscribe(t=>{if(t){let o=t.data,d={periodo:o.periodo,valorAval:o.valorAval,valorFirmaElectronica:o.valorFirmaElectronica,valorTarjeta:o.valorTarjeta,id:o.id};this.form.patchValue(d)}})}createForm(){this.form=this.fb.group({id:[null],valorAval:[""],valorFirmaElectronica:[""],valorTarjeta:[""],periodo:[""]})}closeDialog(){this.dialogRef.close()}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=h({type:r,selectors:[["app-form-cobro-fijo"]],standalone:!0,features:[v([{provide:P,useClass:Y},{provide:V,useValue:"en-GB"},f,Z(ae)]),b],decls:31,vars:19,consts:[[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[1,""],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","gap-2.5"],["floatLabel","always",1,"w-full"],["matInput","","placeholder","Valor de aval","decimalMarker",".",3,"formControlName","thousandSeparator","dropSpecialCharacters","mask"],["matInput","","placeholder","Valor firma electronica","thousandSeparator",".",3,"formControlName","mask","dropSpecialCharacters"],["matInput","","placeholder","Valor de tarjeta","decimalMarker",".",3,"formControlName","thousandSeparator","dropSpecialCharacters","mask"],["matInput","","placeholder","Valor de periodo","decimalMarker",".",3,"formControlName","thousandSeparator","dropSpecialCharacters","mask"],[1,"flex","flex-wrap","justify-end","gap-2.5"],["mat-flat-button","",1,"sm:w-auto","w-full","sm:mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:w-auto","w-full","sm:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"]],template:function(t,o){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),c(3),a(),i(4,"form",3)(5,"div")(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),c(9,"Valor de aval"),a(),p(10,"input",6),a(),i(11,"mat-form-field",5)(12,"mat-label"),c(13,"Valor firma electronica"),a(),p(14,"input",7),a()(),i(15,"div",4)(16,"mat-form-field",5)(17,"mat-label"),c(18,"Valor de tarjeta"),a(),p(19,"input",8),a(),i(20,"mat-form-field",5)(21,"mat-label"),c(22,"Valor de periodo"),a(),p(23,"input",9),a()()(),i(24,"div",10)(25,"button",11),u("click",function(){return o.closeDialog()}),i(26,"span"),c(27," Cancelar "),a()(),i(28,"button",12),u("click",function(){return o.onSave()}),i(29,"span"),c(30," Guardar "),a()()()()()()),t&2&&(s(3),A(" ",o._matData.edit?"Actualizar cobro adicional":"Agregar cobro adicional"," "),s(),n("formGroup",o.form),s(6),n("formControlName","valorAval")("thousandSeparator","")("dropSpecialCharacters",!0)("mask","separator.6"),s(4),n("formControlName","valorFirmaElectronica")("mask","separator.0")("dropSpecialCharacters",!0),s(5),n("formControlName","valorTarjeta")("thousandSeparator","")("dropSpecialCharacters",!0)("mask","separator.6"),s(4),n("formControlName","periodo")("thousandSeparator","")("dropSpecialCharacters",!0)("mask","separator.6"),s(2),n("color","primary"),s(3),n("color","primary"))},dependencies:[S,g,C,$,ee,W,q,B,H,U,J,K],styles:[".custom-dialog-container{width:100%}@media (min-width: 1280px){  .custom-dialog-container{width:50%}}"]});let m=r;return m})();var re=(()=>{let r=class r{constructor(){this.datePipe=l(f),this.currencyPipe=l(w),this.searchTerm="",this._matDialog=l(R),this.estadoDatosService=l(y),this.cobrosFijosService=l(D),this.data=[],this.columns=["Valor aval","Valor firma electronica","Valor tarjeta","Periodo"],this.columnPropertyMap={"Valor aval":"valorAval","Valor firma electronica":"valorFirmaElectronica","Valor tarjeta":"valorTarjeta",Periodo:"periodo"},this.buttons=[{label:"Edit",icon:"edit",action:e=>{console.log("Editing",e),this.selectedData=e,this.onEdit()}}]}onNew(){this._matDialog.open(E,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",disableClose:!0,panelClass:"custom-dialog-container"})}onEdit(){this._matDialog.open(E,{autoFocus:!1,data:{edit:!0,data:this.selectedData},maxHeight:"90vh",disableClose:!0,panelClass:"custom-dialog-container"})}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(t=>{t&&this.getCobros()})}onSearch(e){let t=e.target;this.searchTerm=t.value.trim().toLowerCase()}getCobros(){this.subcription$=this.cobrosFijosService.getCobros().pipe(M(e=>(e.data.forEach(t=>{t.valorAval=this.currencyPipe.transform(t.valorAval,"USD","symbol","1.2-2"),t.valorFirmaElectronica=this.currencyPipe.transform(t.valorFirmaElectronica,"USD","symbol","1.2-2"),t.valorTarjeta=this.currencyPipe.transform(t.valorTarjeta,"USD","symbol","1.2-2"),t.periodo=this.currencyPipe.transform(t.periodo,"USD","symbol","1.2-2")}),e))).subscribe(e=>{e.data&&(this.data=e.data)})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.listenGrid(),this.getCobros()}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=h({type:r,selectors:[["app-grid-cobro-fijo"]],standalone:!0,features:[v([f,w]),b],decls:15,vars:12,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],["mat-flat-button","",1,"mt-2","w-full","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold","sm:ml-4","sm:mt-0","sm:w-auto",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons","searchTerm"]],template:function(t,o){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),c(3,"Parametros de Costos Adicionales"),a(),i(4,"div",3)(5,"mat-form-field",4),p(6,"mat-icon",5),i(7,"input",6),u("input",function(ie){return o.onSearch(ie)}),a()(),i(8,"button",7),u("click",function(){return o.onNew()}),p(9,"mat-icon",8),i(10,"span",9),c(11,"Agregar"),a()()()(),i(12,"div",10)(13,"div",11),p(14,"app-custom-table",12),a()()()),t&2&&(s(5),n("subscriptSizing","dynamic"),s(),n("svgIcon","heroicons_solid:magnifying-glass"),s(),n("autocomplete","off")("placeholder","Buscar"),s(),n("color","primary"),s(),n("svgIcon","heroicons_outline:plus"),s(5),n("columns",o.columns)("displayedColumns",o.columns)("columnPropertyMap",o.columnPropertyMap)("data",o.data)("buttons",o.buttons)("searchTerm",o.searchTerm))},dependencies:[X,S,g,z,C]});let m=r;return m})();var Je=[{path:"",component:re}];export{Je as default};
