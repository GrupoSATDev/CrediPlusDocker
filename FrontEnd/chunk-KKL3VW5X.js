import{a as G}from"./chunk-BNLJYKYO.js";import{a as Ie,b as Me,c as Ne}from"./chunk-V7YY5USQ.js";import{a as Te}from"./chunk-E27GYA5F.js";import{a as De}from"./chunk-4GQ5MQ3M.js";import{a as we,b as ke}from"./chunk-BAD57Q24.js";import{a as xe}from"./chunk-YEQVMDAS.js";import{a as Z}from"./chunk-6IEWE3OU.js";import{a as Ae}from"./chunk-ACIMG2KZ.js";import{a as ye}from"./chunk-QE3E4OX7.js";import{a as W,b as Fe}from"./chunk-GD676RBR.js";import{a as O}from"./chunk-OFEOPKCC.js";import{a as _e}from"./chunk-QYSIOB6Y.js";import"./chunk-ISHIQJYM.js";import{g as fe}from"./chunk-CUGJBCL5.js";import{a as ne,b as se,c as me}from"./chunk-3P4FUJJD.js";import"./chunk-4CCKGQO6.js";import{C as Ee,G as j,b as le,e as pe,i as A,j as ce,l as ue,p as he,q as ge,u as ve,w as Ce,x as Se,z as be}from"./chunk-7YVLRDAA.js";import{$ as ae,Q as oe,R as re,ea as $,ja as de}from"./chunk-T34F2ICN.js";import"./chunk-XMIUBE2U.js";import{a as V}from"./chunk-PDEGUYSW.js";import{f as ee,g as te,i as ie,j as L,s as k}from"./chunk-YH7HM3TK.js";import{$ as F,Cb as n,Db as o,Eb as f,Fb as S,Gb as b,Ib as Q,Ob as v,Xb as U,Yb as m,Za as i,Zb as E,_a as T,_b as X,dc as Y,ea as g,ec as w,fa as d,ka as I,mc as _,nc as y,pb as u,q as K,rb as r,ua as M,va as N}from"./chunk-32HXX3OB.js";import{a as C,d as B}from"./chunk-NEB6MB4Y.js";var $e=(()=>{let e=class e{constructor(s,a){this._http=s,this.appSettings=a}getTiposEmpresas(){return this._http.get(this.appSettings.tiposEmpresas.url.base)}};e.\u0275fac=function(a){return new(a||e)(g(k),g(V))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ve=(()=>{let e=class e{constructor(s,a){this._http=s,this.appSettingService=a}getSubcripciones(){return this._http.get(this.appSettingService.subcripciones.url.base)}getSubcripcion(s){return this._http.get(`${this.appSettingService.subcripciones.url.base}`)}};e.\u0275fac=function(a){return new(a||e)(g(k),g(V))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ze(t,e){if(t&1&&(n(0,"mat-option",27),m(1),o()),t&2){let p=e.$implicit;r("value",p.id),i(),E(p.nombre)}}function Re(t,e){if(t&1&&(S(0),u(1,ze,2,2,"mat-option",26),b()),t&2){let p=e.ngIf;i(),r("ngForOf",p.data)}}function He(t,e){if(t&1&&(n(0,"mat-option",27),m(1),o()),t&2){let p=e.$implicit;r("value",p.id),i(),E(p.nombre)}}function Be(t,e){if(t&1&&(S(0),u(1,He,2,2,"mat-option",26),b()),t&2){let p=e.ngIf;i(),r("ngForOf",p.data)}}function Le(t,e){if(t&1&&(n(0,"mat-option",27),m(1),o()),t&2){let p=e.$implicit;r("value",p.id),i(),E(p.nombre)}}function We(t,e){if(t&1&&(S(0),u(1,Le,2,2,"mat-option",26),b()),t&2){let p=e.ngIf;i(),r("ngForOf",p.data)}}function Ze(t,e){if(t&1&&(n(0,"mat-option",27),m(1),o()),t&2){let p=e.$implicit;r("value",p.id),i(),E(p.nombre)}}function Je(t,e){if(t&1&&(S(0),u(1,Ze,2,2,"mat-option",26),b()),t&2){let p=e.ngIf;i(),r("ngForOf",p.data)}}var qe={validation:!1},q=(()=>{let e=class e{constructor(){this.fb=d(be),this._locacionService=d(xe),this.empresasService=d(De),this.dialogRef=d(ne),this.fuseService=d(fe),this.estadosDatosService=d(O),this.toasService=d(Fe),this.tiposEmpresaService=d($e),this.empresaClienteService=d(G),this.subcripciones=d(Ve),this.departamentos$=this._locacionService.getDepartamentos(),this.empresas$=this.empresasService.getEmpresas(),this.tiposEmpresas$=this.tiposEmpresaService.getTiposEmpresas(),this.subcripciones$=this.subcripciones.getSubcripciones(),this._matData=d(se),this.datePipe=d(L),this.swalService=d(Ae)}getMunicipios(s){let a=s.value;this.municipios$=this._locacionService.getMunicipio(a)}ngOnInit(){this.createForm();let s=this._matData;if(s.edit){let a=s.data;this.form.patchValue(a);let{idDepartamento:l,fechaCorte:c}=a,h=new Date(c);this.form.patchValue({fechaCorte:h}),this.municipios$=this._locacionService.getMunicipio(l)}}onSave(){if(this.form.valid)if(this._matData.edit){let a=this.form.getRawValue(),{idDepartamento:c,fechaCobro:h,estado:x}=a,P=B(a,["idDepartamento","fechaCobro","estado"]),z=this.datePipe.transform(h,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),R=C({fechaCobro:z},P);this.fuseService.open(C({},W)).afterClosed().subscribe(H=>{H==="confirmed"?this.empresaClienteService.putEmpresaCliente(R).subscribe(D=>{this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro actualizado con exito!",timer:4e3}),this.closeDialog()},D=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al actualizar el registro!",timer:4e3})}):this.closeDialog()})}else{let s=this.form.getRawValue(),{idDepartamento:c,idEmpresa:h,fechaCobro:x}=s,P=B(s,["idDepartamento","idEmpresa","fechaCobro"]),z=this.datePipe.transform(x,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),R=C({fechaCobro:z},P);this.fuseService.open(C({},W)).afterClosed().subscribe(H=>{H==="confirmed"?this.empresaClienteService.postEmpresaCliente(R).subscribe(D=>{console.log(D),this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.closeDialog()},D=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}):this.closeDialog()})}}createForm(){this.form=this.fb.group({id:[null],nit:[""],razonSocial:[""],correo:[""],telefono:[""],direccion:[""],idDepartamento:[""],idTipoEmpresa:[""],idMunicipio:[""],fechaCorte:[""],idSuscripcion:[""],valorSuscripcion:[""],porcCobro:[""],fechaCobro:[""],estado:[!0]})}closeDialog(){this.dialogRef.close()}};e.\u0275fac=function(a){return new(a||e)},e.\u0275cmp=I({type:e,selectors:[["app-form-empresas-clientes"]],standalone:!0,features:[Y([{provide:re,useClass:Te},{provide:oe,useValue:"en-GB"},L,we(qe)]),w],decls:79,vars:30,consts:[["data",""],["picker",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[1,""],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8",3,"formGroup"],[1,"flex","mb-4","gap-2"],[1,"w-full"],["matInput","","placeholder","Nit",3,"formControlName"],["matInput","","placeholder","Raz\xF3n social",3,"formControlName"],["matInput","","placeholder","Correo electronico",3,"formControlName"],["matInput","","placeholder","Tel\xE9fono",3,"formControlName"],["placeholder","Departamento",3,"selectionChange","formControlName"],[4,"ngIf"],["placeholder","Ciudad",3,"formControlName"],[1,"flex","mb-4"],["matInput","","placeholder","Direcci\xF3n",3,"formControlName"],["placeholder","Tipo de empresa",3,"formControlName"],["placeholder","Subscripci\xF3n",3,"formControlName"],["matInput","","mask","separator.0","thousandSeparator",".","placeholder","Valor subcripci\xF3n",3,"formControlName"],["matInput","","placeholder","Porcentaje %",3,"formControlName"],["matInput","",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],[1,"flex","flex-wrap","justify-end","gap-2.5"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(a,l){if(a&1){let c=Q();n(0,"div",2)(1,"div",3)(2,"div",4),m(3),o(),n(4,"form",5)(5,"div",6)(6,"mat-form-field",7)(7,"mat-label"),m(8,"Nit"),o(),f(9,"input",8),o(),n(10,"mat-form-field",7)(11,"mat-label"),m(12,"Raz\xF3n social"),o(),f(13,"input",9),o()(),n(14,"div",6)(15,"mat-form-field",7)(16,"mat-label"),m(17,"Correo"),o(),f(18,"input",10),o(),n(19,"mat-form-field",7)(20,"mat-label"),m(21,"Tel\xE9fono"),o(),f(22,"input",11),o()(),n(23,"div",6)(24,"mat-form-field",7)(25,"mat-label"),m(26,"Departamento"),o(),n(27,"mat-select",12,0),v("selectionChange",function(x){return M(c),N(l.getMunicipios(x))}),u(29,Re,2,1,"ng-container",13),_(30,"async"),o()(),n(31,"mat-form-field",7)(32,"mat-label"),m(33,"Ciudad"),o(),n(34,"mat-select",14),u(35,Be,2,1,"ng-container",13),_(36,"async"),o()()(),n(37,"div",15)(38,"mat-form-field",7)(39,"mat-label"),m(40,"Direcci\xF3n"),o(),f(41,"input",16),o()(),n(42,"div",6)(43,"mat-form-field",7)(44,"mat-label"),m(45,"Tipo de empresa"),o(),n(46,"mat-select",17),u(47,We,2,1,"ng-container",13),_(48,"async"),o()(),n(49,"mat-form-field",7)(50,"mat-label"),m(51,"Subscripci\xF3n"),o(),n(52,"mat-select",18),u(53,Je,2,1,"ng-container",13),_(54,"async"),o()()(),n(55,"div",6)(56,"mat-form-field",7)(57,"mat-label"),m(58,"Valor subscripci\xF3n"),o(),f(59,"input",19),o(),n(60,"mat-form-field",7)(61,"mat-label"),m(62,"Porcentaje cobro"),o(),f(63,"input",20),o()(),n(64,"div",15)(65,"mat-form-field",7)(66,"mat-label"),m(67,"Fecha de cobro"),o(),f(68,"input",21)(69,"mat-datepicker-toggle",22)(70,"mat-datepicker",null,1),o()(),n(72,"div",23)(73,"button",24),v("click",function(){return M(c),N(l.closeDialog())}),n(74,"span"),m(75," Cancelar "),o()(),n(76,"button",25),v("click",function(){return M(c),N(l.onSave())}),n(77,"span"),m(78," Guardar "),o()()()()()()}if(a&2){let c=U(71);i(3),X(" ",l._matData.edit?"Actualizar empresa":"Agregar empresa"," "),i(),r("formGroup",l.form),i(5),r("formControlName","nit"),i(4),r("formControlName","razonSocial"),i(5),r("formControlName","correo"),i(4),r("formControlName","telefono"),i(5),r("formControlName","idDepartamento"),i(2),r("ngIf",y(30,22,l.departamentos$)),i(5),r("formControlName","idMunicipio"),i(),r("ngIf",y(36,24,l.municipios$)),i(6),r("formControlName","direccion"),i(5),r("formControlName","idTipoEmpresa"),i(),r("ngIf",y(48,26,l.tiposEmpresas$)),i(5),r("formControlName","idSuscripcion"),i(),r("ngIf",y(54,28,l.subcripciones$)),i(6),r("formControlName","valorSuscripcion"),i(4),r("formControlName","porcCobro"),i(5),r("matDatepicker",c)("formControlName","fechaCobro"),i(),r("for",c),i(4),r("color","primary"),i(3),r("color","primary")}},dependencies:[$,A,j,le,Ee,ve,ue,he,ge,Ce,Se,ie,ae,_e,ee,te,Me,Ne,Ie,ce,pe,ke]});let t=e;return t})();var je=(()=>{let e=class e{constructor(s,a,l){this._matDialog=s,this.empresaClienteService=a,this.estadoDatosService=l,this.data=[],this.columns=["Nit","Razon social","Correo","Telefono","Direccion","Estado"],this.columnPropertyMap={Nit:"nit","Razon social":"razonSocial",Correo:"correo",Telefono:"telefono",Direccion:"direccion",Estado:"estado"},this.buttons=[{label:"Edit",icon:"edit",action:c=>{console.log("Editing",c),this.selectedData=c,this.onEdit()}}]}onNew(){this._matDialog.open(q,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",width:"50%",maxWidth:"100%",disableClose:!0})}onEdit(){this._matDialog.open(q,{autoFocus:!1,data:{edit:!0,data:this.selectedData},maxHeight:"90vh",width:"50%",maxWidth:"100%",disableClose:!0})}getEmpresas(){this.subcription$=this.empresaClienteService.getEmpresas().pipe(K(s=>(s.data.forEach(a=>{a.estado?a.estado=Z.ACTIVO:a.estado=Z.INACTIVO}),s))).subscribe(s=>{this.data=s.data})}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(a=>{a&&this.getEmpresas()})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getEmpresas(),this.listenGrid()}};e.\u0275fac=function(a){return new(a||e)(T(me),T(G),T(O))},e.\u0275cmp=I({type:e,selectors:[["app-grid-empresas-clientes"]],standalone:!0,features:[w],decls:15,vars:11,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","rounded-lg","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],["mat-flat-button","",1,"ml-4","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(a,l){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),m(3,"Clientes - Aliados"),o(),n(4,"div",3)(5,"mat-form-field",4),f(6,"mat-icon",5)(7,"input",6),o(),n(8,"button",7),v("click",function(){return l.onNew()}),f(9,"mat-icon",8),n(10,"span",9),m(11,"Agregar"),o()()()(),n(12,"div",10)(13,"div",11),f(14,"app-custom-table",12),o()()()),a&2&&(i(5),r("subscriptSizing","dynamic"),i(),r("svgIcon","heroicons_solid:magnifying-glass"),i(),r("autocomplete","off")("placeholder","Buscar"),i(),r("color","primary"),i(),r("svgIcon","heroicons_outline:plus"),i(5),r("columns",l.columns)("displayedColumns",l.columns)("columnPropertyMap",l.columnPropertyMap)("data",l.data)("buttons",l.buttons))},dependencies:[$,A,de,j,ye]});let t=e;return t})();var Gt=[{path:"",component:je}];export{Gt as default};
