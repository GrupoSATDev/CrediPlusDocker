import{a as je,b as Be}from"./chunk-UFCSVQHO.js";import{a as ke}from"./chunk-W4MSDUA6.js";import{a as Ie,b as Te,c as Ae,d as Ve}from"./chunk-LVIWDW4T.js";import{a as qe}from"./chunk-DILWLRGT.js";import{a as Me}from"./chunk-TV6VIIET.js";import{a as we,b as Ne}from"./chunk-BAD57Q24.js";import{a as De}from"./chunk-E27GYA5F.js";import{a as Ge}from"./chunk-WIZ6UNWW.js";import{a as xe}from"./chunk-O65ADVMT.js";import{a as Fe,b as _e}from"./chunk-GD676RBR.js";import{a as Ee}from"./chunk-OFEOPKCC.js";import{a as ye}from"./chunk-QYSIOB6Y.js";import{g as se}from"./chunk-CUGJBCL5.js";import"./chunk-3P4FUJJD.js";import{h as re}from"./chunk-4CCKGQO6.js";import{a as Se}from"./chunk-WHODWZY4.js";import"./chunk-ZFQVSUZG.js";import{B as he,C as be,G as ge,b as ne,c as ae,i as me,l as de,n as u,p as pe,q as ue,u as ce,w as fe,x as ve,z as Ce}from"./chunk-7YVLRDAA.js";import{$ as ie,Q as te,R as oe,ea as le}from"./chunk-T34F2ICN.js";import"./chunk-WDNNZS2B.js";import"./chunk-XMIUBE2U.js";import{a as w}from"./chunk-XHZ6JD3E.js";import{d as ee}from"./chunk-HGIHZLIS.js";import{e as J,f as K,g as U,i as X,j as _,l as Y,m as Z,s as D}from"./chunk-YH7HM3TK.js";import{$ as x,Cb as r,Db as e,Eb as c,Fb as k,Gb as R,Ib as P,Ob as T,Qb as A,Ub as $,Vb as O,Wb as L,Yb as n,Za as o,Zb as v,_b as F,dc as Q,ea as h,ec as H,fa as p,hc as W,ka as B,l as y,mc as b,nc as E,oc as z,pb as f,rb as l,ua as G,va as I}from"./chunk-32HXX3OB.js";import{a as N,d as j}from"./chunk-NEB6MB4Y.js";var Pe=(()=>{let m=class m{constructor(s,i){this._http=s,this.appSettings=i}getTipoCuentas(){return this._http.get(this.appSettings.tipoCuentas.url.base)}getTipoCuenta(s){return this._http.get(`${this.appSettings.tipoCuentas.url.base}/${s}`)}};m.\u0275fac=function(i){return new(i||m)(h(D),h(w))},m.\u0275prov=x({token:m,factory:m.\u0275fac,providedIn:"root"});let a=m;return a})();var $e=(()=>{let m=class m{constructor(s,i){this._http=s,this.AppSettings=i}postDesembolso(s){return this._http.post(this.AppSettings.detalleConsumos.url.desembolsoBase,s)}};m.\u0275fac=function(i){return new(i||m)(h(D),h(w))},m.\u0275prov=x({token:m,factory:m.\u0275fac,providedIn:"root"});let a=m;return a})();var We=["stepper"],ze=(a,m)=>({"bg-crediblue-50":a,"bg-credigray-100":m});function Je(a,m){if(a&1&&(r(0,"mat-option",34),n(1),e()),a&2){let d=m.$implicit;l("value",d.id),o(),v(d.nombre)}}function Ke(a,m){if(a&1&&(k(0),f(1,Je,2,2,"mat-option",29),R()),a&2){let d=m.ngIf;o(),l("ngForOf",d.data)}}function Ue(a,m){a&1&&(r(0,"mat-error"),n(1," El tipo de documento es requerido!. "),e())}function Xe(a,m){a&1&&(r(0,"mat-error"),n(1," El n\xFAmero de identificaci\xF3n es requerido!. "),e())}function Ye(a,m){if(a&1&&(r(0,"fuse-alert",35),n(1),e()),a&2){let d=A();l("appearance","outline")("showIcon",!1)("type",d.alert.type)("@shake",d.alert.type==="error"),o(),F(" ",d.alert.message," ")}}function Ze(a,m){a&1&&(r(0,"mat-error"),n(1,"El valor es requerido!"),e())}function et(a,m){a&1&&(r(0,"mat-error"),n(1,"El valor ingresado no puede superar el cupo disponible!"),e())}function tt(a,m){if(a&1&&(r(0,"mat-option",34),n(1),e()),a&2){let d=m.$implicit;l("value",d.idTipoCuenta),o(),v(d.nombreBanco)}}function ot(a,m){if(a&1&&(r(0,"div",17)(1,"div",36)(2,"div",37)(3,"h2",38),n(4,"Resumen de desembolso"),e(),r(5,"p",39),n(6,"Revise los detalles"),e()(),r(7,"div",40)(8,"div",41)(9,"div")(10,"h3",42),n(11,"Fecha"),e()(),r(12,"p",43),n(13),b(14,"date"),e()(),r(15,"div",41)(16,"div")(17,"h3",42),n(18,"N\xFAmero de comprobante"),e()(),r(19,"p",43),n(20),e()(),r(21,"div",41)(22,"div")(23,"h3",42),n(24,"Valor $"),e()(),r(25,"p",43),n(26),b(27,"currency"),e()(),r(28,"div",44)(29,"p",42),n(30,"N\xFAmero de cuotas"),e(),r(31,"p",43),n(32),e()(),r(33,"div",45)(34,"p",42),n(35,"Estado"),e(),r(36,"p",43),n(37),e()()()()()),a&2){let d=A();o(13),v(z(14,5,d.detaleConsumo.fechaCreacion,"dd/MM/yyyy")),o(7),v(d.detaleConsumo.numeroFactura),o(6),v(E(27,8,d.detaleConsumo.montoConsumo)),o(6),v(d.detaleConsumo.cantidadCuotas),o(5),v(d.detaleConsumo.nombreEstadoCredito)}}var it={validation:!1},Oe=(()=>{let m=class m{constructor(){this.tiposDocumentosService=p(Ge),this.fuseService=p(se),this.estadosDatosService=p(Ee),this.toasService=p(_e),this.empleadosServices=p(qe),this.tipoConsumosService=p(Be),this.cuentasServices=p(ke),this.tipoCuentaService=p(Pe),this.datePipe=p(_),this.router=p(ee),this.fb=p(Ce),this._locacionService=p(xe),this.detalleConsumo=p(Me),this.departamentos$=this._locacionService.getDepartamentos(),this.tipoConsumo$=this.tipoConsumosService.getTipoConsumos(),this.cuentas=[],this.tipoCuentas$=this.tipoCuentaService.getTipoCuentas(),this.desembolsoService=p($e),this.showAlert=!1,this.alert={type:"success",message:""},this.tiposDocumentos$=this.tiposDocumentosService.getTiposDocumentos(),this.creditos=[],this.focus=focus,this.FormatoOptionsPipe=je}ngOnDestroy(){}ngOnInit(){this.createForm(),this.getCuentas()}getCuentas(){this.subscription$=this.cuentasServices.getCuentas().subscribe(s=>{this.cuentas=s.data})}selected(s){let i=s.value;this.compareValor=i.cupoDisponible,this.thirdFormGroup.get("montoConsumo").setValidators(rt(this.compareValor)),this.thirdFormGroup.get("montoConsumo").updateValueAndValidity()}compareWithConstants(s){let i=s.value,t=this.secondFormGroup.get("idCredito")?.value;return!t||!t.montoConsumo?(console.error("No se encontr\xF3 el objeto idCredito o montoConsumo"),y(null)):(console.log(i),console.log(t.montoConsumo),i>t.montoConsumo?y({notEqual:!0}):y(null))}get montoConsumo(){return this.thirdFormGroup.get("montoConsumo")}onSearch(){let s=this.firstFormGroup.getRawValue();this.empleadosServices.getEmpleadoParams(s).subscribe(i=>{if(console.log(i),i){this.showAlert=!1;let t={numDoc:i.data.numDoc,primerNombre:i.data.primerNombre,segundoNombre:i.data.segundoNombre,primerApellido:i.data.primerApellido,segundoApellido:i.data.segundoApellido,idTrabajador:i.data.id,correo:i.data.correo,credito:i.data.creditos[0].numCredito+" - "+i.data.creditos[0].cupoDisponible,idCredito:i.data.creditos[0].id,numCuentaBancaria:i.data.numCuentaBancaria,idTipoCuenta:i.data.idTipoCuenta};this.secondFormGroup.patchValue(t),console.log(t),console.log(this.thirdFormGroup.getRawValue()),this.thirdFormGroup.patchValue({idCuentaBancaria:t.idTipoCuenta,cuentaDestino:t.numCuentaBancaria}),this.creditos=i.data.creditos,setTimeout(()=>{this.stepper.next()},1200)}},i=>{this.alert={type:"error",message:"El empleado no existe!"},this.showAlert=!0})}onSave(){if(this.thirdFormGroup.valid){let s=this.thirdFormGroup.getRawValue(),{montoConsumo:i,idCuentaBancaria:t}=s,C=j(s,["montoConsumo","idCuentaBancaria"]),{idCredito:g,idTrabajador:V}=this.secondFormGroup.getRawValue();console.log(g);let q=this.cuentas.filter(S=>{if(S.idTipoCuenta==t)return S.id});console.log(q[0].id);let M=N({idCredito:g,idTrabajador:V,montoConsumo:Number(i),idCuentaBancaria:q[0].id},C);console.log(M),this.fuseService.open(N({},Fe)).afterClosed().subscribe(S=>{S==="confirmed"&&this.desembolsoService.postDesembolso(M).subscribe(Le=>{console.log(Le),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.getResumenCompra(V)})})}}getResumenCompra(s){this.subscription$=this.detalleConsumo.getResumen(s).subscribe(i=>{i&&(console.log(i),this.detaleConsumo=i.data,this.stepper.next())})}createForm(){this.firstFormGroup=this.fb.group({idTipoDoc:["",u.required],numDocumento:["",u.required]}),this.secondFormGroup=this.fb.group({numDoc:["",u.required],primerNombre:["",u.required],segundoNombre:["",u.required],primerApellido:["",u.required],segundoApellido:["",u.required],idTrabajador:[""],correo:["",u.required],credito:["",u.required],idCredito:["",u.required],numCuentaBancaria:[""],idTipoCuenta:[""]}),this.thirdFormGroup=this.fb.group({montoConsumo:["",[u.required]],numeroFactura:["",u.required],idCuentaBancaria:["",u.required],cuentaDestino:["",u.required],idCuenta:[""]})}};m.\u0275fac=function(i){return new(i||m)},m.\u0275cmp=B({type:m,selectors:[["app-form-desembolso"]],viewQuery:function(i,t){if(i&1&&$(We,5),i&2){let C;O(C=L())&&(t.stepper=C.first)}},standalone:!0,features:[Q([{provide:oe,useClass:De},{provide:te,useValue:"en-GB"},_,we(it)]),H],decls:99,vars:50,consts:[["stepper",""],["data",""],["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","print:p-0","w-full"],[1,"sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto","overflow-hidden"],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[3,"linear"],["label","Consultar empleado",3,"stepControl"],[1,"flex","flex-col","items-center","justify-center","w-full","h-full","px-4"],[3,"formGroup"],[1,"w-full"],[3,"formControlName"],[4,"ngIf"],["matInput","","placeholder","Ingrese identificaci\xF3n",3,"formControlName"],["class","mb-4",3,"appearance","showIcon","type",4,"ngIf"],["mat-raised-button","",1,"text-white","px-6","py-2","rounded-md","w-full",3,"click","disabled","ngClass"],["label","Verificar informaci\xF3n",3,"stepControl"],[1,"w-full","h-full","px-4"],[1,"flex","flex-row","gap-2.5"],["matInput","",3,"formControlName","readonly"],[1,"flex","flex-row"],[1,"flex","justify-end","gap-2.5"],["mat-button","","matStepperPrevious","",1,"bg-gray-500","text-white","py-2","px-4","rounded","hover:bg-gray-600"],["mat-button","","matStepperNext","",1,"bg-crediblue-50","text-white","py-2","px-4","rounded",3,"disabled"],["label","Confirmar desembolso",3,"stepControl"],[1,"w-full","h-full","p-4","shadow-lg"],[1,"flex","flex-row","items-baseline","gap-2.5"],["matInput","",3,"formControlName"],["matInput","","thousandSeparator",".",3,"formControlName","mask"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","text",3,"formControlName"],["mat-button","",1,"bg-crediblue-50","text-white","py-2","px-4","rounded",3,"click","disabled"],["label","Resumen de desembolso",3,"stepControl"],["class","w-full h-full px-4",4,"ngIf"],[3,"value"],[1,"mb-4",3,"appearance","showIcon","type"],[1,"max-w-2xl","mx-auto","p-4","bg-white","shadow-lg","rounded-lg"],[1,"border-b","pb-4","mb-4"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"space-y-4"],[1,"flex","justify-between","items-center","border-b","pb-2"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","justify-between","items-center","pt-4","border-t"],[1,"flex","justify-between","items-center"]],template:function(i,t){if(i&1){let C=P();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),n(4),e(),r(5,"mat-horizontal-stepper",6,0)(7,"mat-step",7)(8,"div",8)(9,"form",9)(10,"mat-form-field",10)(11,"mat-label"),n(12,"Tipo de documento"),e(),r(13,"mat-select",11),f(14,Ke,2,1,"ng-container",12),b(15,"async"),e(),f(16,Ue,2,0,"mat-error",12),e(),r(17,"mat-form-field",10)(18,"mat-label"),n(19,"N\xFAmero de identificaci\xF3n"),e(),c(20,"input",13),f(21,Xe,2,0,"mat-error",12),e(),f(22,Ye,2,5,"fuse-alert",14),r(23,"button",15),T("click",function(){return G(C),I(t.onSearch())}),n(24,"Consultar"),e()()()(),r(25,"mat-step",16)(26,"div",17)(27,"form",9)(28,"div",18)(29,"mat-form-field",10)(30,"mat-label"),n(31,"Primer nombre"),e(),c(32,"input",19),e(),r(33,"mat-form-field",10)(34,"mat-label"),n(35,"Segundo nombre"),e(),c(36,"input",19),e()(),r(37,"div",18)(38,"mat-form-field",10)(39,"mat-label"),n(40,"Primer apellido"),e(),c(41,"input",19),e(),r(42,"mat-form-field",10)(43,"mat-label"),n(44,"Segundo apellido"),e(),c(45,"input",19),e()(),r(46,"div",18)(47,"mat-form-field",10)(48,"mat-label"),n(49,"Identificaci\xF3n"),e(),c(50,"input",19),e(),r(51,"mat-form-field",10)(52,"mat-label"),n(53,"Email"),e(),c(54,"input",19),e()(),r(55,"div",20)(56,"mat-form-field",10)(57,"mat-label"),n(58,"Cr\xE9dito"),e(),c(59,"input",19),e()()(),r(60,"div",21)(61,"button",22),n(62,"Anterior"),e(),r(63,"button",23),n(64,"Siguiente"),e()()()(),r(65,"mat-step",24)(66,"div",25)(67,"form",9)(68,"div",26)(69,"mat-form-field",10)(70,"mat-label"),n(71,"N\xFAmero de comprobante"),e(),c(72,"input",27),e(),r(73,"mat-form-field",10)(74,"mat-label"),n(75,"Valor de la transferencia"),e(),c(76,"input",28),f(77,Ze,2,0,"mat-error",12)(78,et,2,0,"mat-error",12),e()(),n(79),b(80,"json"),r(81,"div",18)(82,"mat-form-field",10)(83,"mat-label"),n(84,"Cuenta de origen"),e(),r(85,"mat-select",11,1),f(87,tt,2,2,"mat-option",29),e()(),r(88,"mat-form-field",10)(89,"mat-label"),n(90,"Cuenta destino"),e(),c(91,"input",30),e()()(),r(92,"div",21)(93,"button",22),n(94,"Anterior"),e(),r(95,"button",31),T("click",function(){return G(C),I(t.onSave())}),n(96,"Confirmar"),e()()()(),r(97,"mat-step",32),f(98,ot,38,10,"div",33),e()()()()()}i&2&&(o(4),F(" ","Desembolso"," "),o(),l("linear",!0),o(2),l("stepControl",t.firstFormGroup),o(2),l("formGroup",t.firstFormGroup),o(4),l("formControlName","idTipoDoc"),o(),l("ngIf",E(15,43,t.tiposDocumentos$)),o(2),l("ngIf",t.firstFormGroup.get("idTipoDoc").dirty||t.firstFormGroup.get("idTipoDoc").touched&&t.firstFormGroup.get("idTipoDoc").errors.required),o(4),l("formControlName","numDocumento"),o(),l("ngIf",t.firstFormGroup.get("numDocumento").dirty||t.firstFormGroup.get("numDocumento").touched&&t.firstFormGroup.get("numDocumento").errors.required),o(),l("ngIf",t.showAlert),o(),l("disabled",t.firstFormGroup.invalid)("ngClass",W(47,ze,t.firstFormGroup.valid,t.firstFormGroup.invalid)),o(2),l("stepControl",t.secondFormGroup),o(2),l("formGroup",t.secondFormGroup),o(5),l("formControlName","primerNombre")("readonly",!0),o(4),l("formControlName","segundoNombre")("readonly",!0),o(5),l("formControlName","primerApellido")("readonly",!0),o(4),l("formControlName","segundoApellido")("readonly",!0),o(5),l("formControlName","numDoc")("readonly",!0),o(4),l("formControlName","correo")("readonly",!0),o(5),l("formControlName","credito")("readonly",!0),o(4),l("disabled",t.secondFormGroup.invalid),o(2),l("stepControl",t.thirdFormGroup),o(2),l("formGroup",t.thirdFormGroup),o(5),l("formControlName","numeroFactura"),o(4),l("formControlName","montoConsumo")("mask","separator.0"),o(),l("ngIf",(t.montoConsumo.touched||t.montoConsumo.dirty)&&t.montoConsumo.hasError("required")),o(),l("ngIf",(t.montoConsumo.touched||t.montoConsumo.dirty)&&t.montoConsumo.hasError("notEqual")),o(),F(" ",E(80,45,t.thirdFormGroup.getRawValue())," "),o(6),l("formControlName","idCuentaBancaria"),o(2),l("ngForOf",t.cuentas),o(4),l("formControlName","cuentaDestino"),o(4),l("disabled",t.thirdFormGroup.invalid),o(2),l("stepControl",t.thirdFormGroup),o(),l("ngIf",t.detaleConsumo))},dependencies:[X,re,Z,_,he,ce,de,pe,ue,Se,le,ae,me,ge,ne,ie,ye,Ie,Te,Ae,Ve,K,U,Ne,be,fe,ve,J,Y]});let a=m;return a})();function rt(a){return m=>{let d=m.value;return console.log(a),d>a?{notEqual:!0}:null}}var Lt=[{path:"",component:Oe}];export{Lt as default};
