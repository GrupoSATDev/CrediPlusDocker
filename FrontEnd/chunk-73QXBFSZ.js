import{a as ye,b as Fe,c as xe,d as Ee}from"./chunk-PM7Y6XOW.js";import{a as De}from"./chunk-VS2UVASU.js";import{a as Se}from"./chunk-DJUJLN2G.js";import{a as _e}from"./chunk-IWDGODRY.js";import{a as ge}from"./chunk-3GXOUDBK.js";import{a as Ce,c as be,d as he}from"./chunk-NYXXZLC7.js";import{a as ve}from"./chunk-XLGI4M45.js";import{k as Y}from"./chunk-7MJ462UO.js";import{h as W}from"./chunk-C2BDAT5Z.js";import{a as fe}from"./chunk-6DQ2YNY3.js";import"./chunk-ANW7W3BV.js";import{B as se,D as de,E as ce,I as ue,b as K,i as U,l as te,n as I,p as ie,q as oe,t as re,u as ne,w as ae,x as me,y as le,z as pe}from"./chunk-DESY5WO2.js";import{$ as J,Q as z,R as H,ea as X}from"./chunk-JWHB23S2.js";import{a as ee}from"./chunk-PYFTLBTT.js";import"./chunk-TAOXPEWO.js";import{a as Z}from"./chunk-QEQK4NML.js";import{d as q}from"./chunk-7GFVIFOO.js";import{f as R,g as B,i as L,j as w,r as Q}from"./chunk-TI3VW26V.js";import{$ as M,Cb as r,Db as e,Eb as d,Fb as v,Gb as g,Ib as G,Ob as y,Qb as V,Ub as k,Vb as O,Wb as j,Yb as m,Za as t,Zb as C,_b as N,dc as P,ea as D,ec as $,fa as c,ka as T,mc as F,nc as x,pb as u,rb as i,ua as S,va as _}from"./chunk-MZ7JCHPI.js";import{a as E,d as A}from"./chunk-NEB6MB4Y.js";var Ne=(()=>{let n=class n{constructor(s,a){this._http=s,this.appSettings=a}postDetalle(s){return this._http.post(this.appSettings.detalleConsumos.url.base,s)}};n.\u0275fac=function(a){return new(a||n)(D(Q),D(Z))},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"});let o=n;return o})();var Te=["stepper"];function Ge(o,n){if(o&1&&(r(0,"mat-option",33),m(1),e()),o&2){let l=n.$implicit;i("value",l.id),t(),C(l.nombre)}}function Ve(o,n){if(o&1&&(v(0),u(1,Ge,2,2,"mat-option",32),g()),o&2){let l=n.ngIf;t(),i("ngForOf",l.data)}}function ke(o,n){if(o&1&&(r(0,"fuse-alert",34),m(1),e()),o&2){let l=V();i("appearance","outline")("showIcon",!1)("type",l.alert.type)("@shake",l.alert.type==="error"),t(),N(" ",l.alert.message," ")}}function Oe(o,n){if(o&1&&(v(0),r(1,"mat-option",33),m(2),e(),g()),o&2){let l=n.$implicit;t(),i("value",l.id),t(),C(l.numCredito)}}function je(o,n){if(o&1&&(r(0,"mat-option",33),m(1),e()),o&2){let l=n.$implicit;i("value",l.id),t(),C(l.nombre)}}function Pe(o,n){if(o&1&&(v(0),u(1,je,2,2,"mat-option",32),g()),o&2){let l=n.ngIf;t(),i("ngForOf",l.data)}}function $e(o,n){if(o&1&&(r(0,"mat-option",33),m(1),e()),o&2){let l=n.$implicit;i("value",l.id),t(),C(l.nombre)}}function Re(o,n){if(o&1&&(v(0),u(1,$e,2,2,"mat-option",32),g()),o&2){let l=n.ngIf;t(),i("ngForOf",l.data)}}var we=(()=>{let n=class n{constructor(){this.tiposDocumentosService=c(_e),this.fuseService=c(Y),this.estadosDatosService=c(be),this.toasService=c(he),this.empleadosServices=c(De),this.datePipe=c(w),this.router=c(q),this.fb=c(se),this._locacionService=c(ge),this.detalleConsumo=c(Ne),this.departamentos$=this._locacionService.getDepartamentos(),this.showAlert=!1,this.alert={type:"success",message:""},this.tiposDocumentos$=this.tiposDocumentosService.getTiposDocumentos(),this.creditos=[],this.focus=focus}ngOnDestroy(){}ngOnInit(){this.createForm()}getMunicipios(s){let a=s.value;this.municipios$=this._locacionService.getMunicipio(a)}onSearch(){let s=this.firstFormGroup.getRawValue();this.empleadosServices.getEmpleadoParams(s).subscribe(a=>{if(console.log(a),a){this.showAlert=!1;let p={numDoc:a.data.numDoc,primerNombre:a.data.primerNombre,segundoNombre:a.data.segundoNombre,primerApellido:a.data.primerApellido,segundoApellido:a.data.segundoApellido,idTrabajador:a.data.id,correo:a.data.correo};this.secondFormGroup.patchValue(p),this.creditos=a.data.creditos,setTimeout(()=>{this.stepper.next()},1200)}},a=>{this.alert={type:"error",message:"El empleado no existe!"},this.showAlert=!0})}onSave(){if(this.thirdFormGroup.valid){let s=this.thirdFormGroup.getRawValue(),{montoConsumo:a}=s,p=A(s,["montoConsumo"]),{idCredito:f,idTrabajador:b}=this.secondFormGroup.getRawValue(),h=E({idCredito:f,idTrabajador:b,montoConsumo:Number(a)},p);console.log(h),this.fuseService.open(E({},Ce)).afterClosed().subscribe(Ie=>{Ie==="confirmed"&&this.detalleConsumo.postDetalle(h).subscribe(Ae=>{console.log(Ae),this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/creditos/"])})})}}createForm(){this.firstFormGroup=this.fb.group({idTipoDoc:["",I.required],numDocumento:["",I.required]}),this.secondFormGroup=this.fb.group({numDoc:[{value:"",disabled:!0}],primerNombre:[{value:"",disabled:!0}],segundoNombre:[{value:"",disabled:!0}],primerApellido:[{value:"",disabled:!0}],segundoApellido:[{value:"",disabled:!0}],idTrabajador:[""],correo:[{value:"",disabled:!0}],idCredito:[""]}),this.thirdFormGroup=this.fb.group({cantidadCuotas:[""],montoConsumo:[""],numeroFactura:[""],detalleCompra:[""],idMunicipio:[""]})}};n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=T({type:n,selectors:[["app-form-detalle-consumo"]],viewQuery:function(a,p){if(a&1&&k(Te,5),a&2){let f;O(f=j())&&(p.stepper=f.first)}},standalone:!0,features:[P([{provide:H,useClass:Se},{provide:z,useValue:"en-GB"},w]),$],decls:102,vars:41,consts:[["stepper",""],["data",""],["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","print:p-0","w-full"],[1,"sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto","overflow-hidden"],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[3,"linear"],["label","Consultar empleado",3,"stepControl"],[1,"flex","flex-col","items-center","justify-center","w-full","h-full","px-4"],[3,"formGroup"],[1,"w-full"],[3,"formControlName"],[4,"ngIf"],["matInput","","placeholder","Ingrese identificaci\xF3n",3,"formControlName"],["class","mb-4",3,"appearance","showIcon","type",4,"ngIf"],["mat-raised-button","",1,"bg-crediblue-50","text-white","px-6","py-2","rounded-md","w-full",3,"click"],["label","Verifica informaci\xF3n",3,"stepControl"],[1,"w-full","h-full","px-4"],[1,"flex","flex-row","gap-2.5"],["matInput","",3,"formControlName","disabled"],[1,"flex","flex-row"],[4,"ngFor","ngForOf"],[1,"flex","justify-end","gap-2.5"],["mat-button","","matStepperPrevious","",1,"bg-gray-500","text-white","py-2","px-4","rounded","hover:bg-gray-600"],["mat-button","","matStepperNext","",1,"bg-crediblue-50","text-white","py-2","px-4","rounded"],["label","Finalizar",3,"stepControl"],[1,"flex","flex-row","items-baseline","gap-2.5"],["matInput","",3,"formControlName"],["matInput","","placeholder","Detalle",3,"formControlName"],[3,"selectionChange"],["matInput","","type","number",3,"min","max","formControlName"],["mat-button","",1,"bg-blue-500","text-white","py-2","px-4","rounded","hover:bg-blue-600",3,"click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mb-4",3,"appearance","showIcon","type"]],template:function(a,p){if(a&1){let f=G();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),m(4),e(),r(5,"mat-horizontal-stepper",6,0)(7,"mat-step",7)(8,"div",8)(9,"form",9)(10,"mat-form-field",10)(11,"mat-label"),m(12,"Tipo de documento"),e(),r(13,"mat-select",11),u(14,Ve,2,1,"ng-container",12),F(15,"async"),e()(),r(16,"mat-form-field",10)(17,"mat-label"),m(18,"N\xFAmero de identificaci\xF3n"),e(),d(19,"input",13),e(),u(20,ke,2,5,"fuse-alert",14),r(21,"button",15),y("click",function(){return S(f),_(p.onSearch())}),m(22,"Consultar"),e()()()(),r(23,"mat-step",16)(24,"div",17)(25,"form",9)(26,"div",18)(27,"mat-form-field",10)(28,"mat-label"),m(29,"Primer nombre"),e(),d(30,"input",19),e(),r(31,"mat-form-field",10)(32,"mat-label"),m(33,"Segundo nombre"),e(),d(34,"input",19),e()(),r(35,"div",18)(36,"mat-form-field",10)(37,"mat-label"),m(38,"Primer apellido"),e(),d(39,"input",19),e(),r(40,"mat-form-field",10)(41,"mat-label"),m(42,"Segundo apellido"),e(),d(43,"input",19),e()(),r(44,"div",18)(45,"mat-form-field",10)(46,"mat-label"),m(47,"Identificaci\xF3n"),e(),d(48,"input",19),e(),r(49,"mat-form-field",10)(50,"mat-label"),m(51,"Email"),e(),d(52,"input",19),e()(),r(53,"div",20)(54,"mat-form-field",10)(55,"mat-label"),m(56,"Cr\xE9ditos"),e(),r(57,"mat-select",11),u(58,Oe,3,2,"ng-container",21),e()()()(),r(59,"div",22)(60,"button",23),m(61,"Anterior"),e(),r(62,"button",24),m(63,"Siguiente"),e()()()(),r(64,"mat-step",25)(65,"div",17)(66,"form",9)(67,"div",26)(68,"mat-form-field",10)(69,"mat-label"),m(70,"N\xFAmero de factura"),e(),d(71,"input",27),e(),r(72,"mat-form-field",10)(73,"mat-label"),m(74,"Observaci\xF3nes"),e(),d(75,"textarea",28),e()(),r(76,"div",18)(77,"mat-form-field",10)(78,"mat-label"),m(79,"Departamento"),e(),r(80,"mat-select",29,1),y("selectionChange",function(h){return S(f),_(p.getMunicipios(h))}),u(82,Pe,2,1,"ng-container",12),F(83,"async"),e()(),r(84,"mat-form-field",10)(85,"mat-label"),m(86,"Ciudad"),e(),r(87,"mat-select",11),u(88,Re,2,1,"ng-container",12),F(89,"async"),e()()(),r(90,"div",18)(91,"mat-form-field",10)(92,"mat-label"),m(93,"Valor cuotas"),e(),d(94,"input",27),e(),r(95,"mat-form-field",10)(96,"mat-label"),m(97,"Cantidad de cuotas"),e(),d(98,"input",30),e()()(),r(99,"div",22)(100,"button",31),y("click",function(){return S(f),_(p.onSave())}),m(101,"Guardar"),e()()()()()()()()}a&2&&(t(4),N(" ","Detalle consumo"," "),t(),i("linear",!0),t(2),i("stepControl",p.firstFormGroup),t(2),i("formGroup",p.firstFormGroup),t(4),i("formControlName","idTipoDoc"),t(),i("ngIf",x(15,35,p.tiposDocumentos$)),t(5),i("formControlName","numDocumento"),t(),i("ngIf",p.showAlert),t(3),i("stepControl",p.secondFormGroup),t(2),i("formGroup",p.secondFormGroup),t(5),i("formControlName","primerNombre")("disabled",!0),t(4),i("formControlName","segundoNombre")("disabled",!0),t(5),i("formControlName","primerApellido")("disabled",!0),t(4),i("formControlName","segundoApellido")("disabled",!0),t(5),i("formControlName","numDoc")("disabled",!0),t(4),i("formControlName","correo")("disabled",!0),t(5),i("formControlName","idCredito"),t(),i("ngForOf",p.creditos),t(6),i("stepControl",p.thirdFormGroup),t(2),i("formGroup",p.thirdFormGroup),t(5),i("formControlName","numeroFactura"),t(4),i("formControlName","detalleCompra"),t(7),i("ngIf",x(83,37,p.departamentos$)),t(5),i("formControlName","idMunicipio"),t(),i("ngIf",x(89,39,p.municipios$)),t(6),i("formControlName","montoConsumo"),t(4),i("min",1)("max",6)("formControlName","cantidadCuotas"))},dependencies:[Fe,ye,de,re,te,ne,ie,oe,pe,le,U,ue,K,X,xe,L,J,ve,R,B,ce,ae,me,W,Ee,fe],data:{animation:ee}});let o=n;return o})();var _t=[{path:"",component:we}];export{_t as default};
