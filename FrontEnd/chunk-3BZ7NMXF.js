import{a as Fe,b as Ne,c as Me,d as we,e as Te}from"./chunk-XZNPYCN3.js";import{a as Ae}from"./chunk-NHEIDCKX.js";import{a as De}from"./chunk-7BBUV72N.js";import{a as ke}from"./chunk-MMS7G32A.js";import{a as K}from"./chunk-6IEWE3OU.js";import{a as q,b as j,c as Ie}from"./chunk-VG7RFQST.js";import{a as ye,b as xe}from"./chunk-L7DHXJYW.js";import{a as se,b as pe,c as ce,k as ue}from"./chunk-BEUMGSBU.js";import"./chunk-XWKUJA73.js";import{A as Ce,E as V,a as de,d as fe,h as A,k as ge,o as ve,p as he,s as _e,u as be,v as Se,x as Ee}from"./chunk-JABQIN56.js";import{N as re,O as me,Y as le,ba as k,ga as $}from"./chunk-COZCVVRH.js";import"./chunk-NFYLEJKB.js";import{a as G}from"./chunk-T2KHVOBS.js";import{f as oe,g as ne,i as ae,j as J,q as T}from"./chunk-LP47ZEUX.js";import{$ as F,Cb as m,Db as o,Eb as d,Fb as h,Gb as _,Ib as ee,Ob as b,Qb as H,Wa as Z,Xb as W,Yb as s,Za as n,Zb as E,_a as M,_b as U,cc as te,dc as w,ea as S,fa as u,ka as N,lc as C,mc as y,oc as ie,pb as g,q as L,rb as r,ua as D,va as I}from"./chunk-5H7N2SGK.js";import{a as x,d as z}from"./chunk-NEB6MB4Y.js";var P=(()=>{let t=class t{constructor(a,i){this._http=a,this.appSettings=i}getEmpleados(){return this._http.get(this.appSettings.empleados.url.base)}postEmpleados(a){return delete a.id,this._http.post(this.appSettings.empleados.url.base,a)}putEmpleados(a){let i=a.id;return delete a.id,this._http.put(`${this.appSettings.empleados.url.base}/${i}`,a)}};t.\u0275fac=function(i){return new(i||t)(S(T),S(G))},t.\u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var $e=(()=>{let t=class t{constructor(a,i){this._http=a,this.appSettings=i}getCargos(){return this._http.get(this.appSettings.cargos.url.base)}postCargos(a){return delete a.id,this._http.post(this.appSettings.cargos.url.base,a)}putCargos(a){let i=a.id;return delete a.id,this._http.put(`${this.appSettings.cargos.url.base}/${i}`,a)}};t.\u0275fac=function(i){return new(i||t)(S(T),S(G))},t.\u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function Re(e,t){if(e&1&&(h(0),d(1,"img",24),_()),e&2){let l=H();n(),r("src",l.image,Z)("alt","Profile avatar")}}function Be(e,t){if(e&1&&(m(0,"div",25),s(1),o()),e&2){let l,a=H();n(),U(" ",(l=a.form.get("primerNombre").value.charAt(0))!==null&&l!==void 0?l:"P"," ")}}function ze(e,t){if(e&1&&(m(0,"mat-option",27),s(1),o()),e&2){let l=t.$implicit;r("value",l.id),n(),E(l.nombre)}}function Le(e,t){if(e&1&&(h(0),g(1,ze,2,2,"mat-option",26),_()),e&2){let l=t.ngIf;n(),r("ngForOf",l.data)}}function He(e,t){if(e&1&&(m(0,"mat-option",27),s(1),o()),e&2){let l=t.$implicit;r("value",l.id),n(),E(l.nombre)}}function We(e,t){if(e&1&&(h(0),g(1,He,2,2,"mat-option",26),_()),e&2){let l=t.ngIf;n(),r("ngForOf",l.data)}}function Ue(e,t){if(e&1&&(m(0,"mat-option",27),s(1),o()),e&2){let l=t.$implicit;r("value",l.id),n(),E(l.nombre)}}function Je(e,t){if(e&1&&(h(0),g(1,Ue,2,2,"mat-option",26),_()),e&2){let l=t.ngIf;n(),r("ngForOf",l.data)}}function qe(e,t){if(e&1&&(m(0,"mat-option",27),s(1),o()),e&2){let l=t.$implicit;r("value",l.id),n(),E(l.nombre)}}function Ke(e,t){if(e&1&&(h(0),g(1,qe,2,2,"mat-option",26),_()),e&2){let l=t.ngIf;n(),r("ngForOf",l.data)}}function Qe(e,t){if(e&1&&(m(0,"mat-option",27),s(1),o()),e&2){let l=t.$implicit;r("value",l.id),n(),E(l.razonSocial)}}function Xe(e,t){if(e&1&&(h(0),g(1,Qe,2,2,"mat-option",26),_()),e&2){let l=t.ngIf;n(),r("ngForOf",l.data)}}var X=(()=>{let t=class t{constructor(){this.fb=u(Ee),this.dialogRef=u(se),this.fuseService=u(ue),this.estadosDatosService=u(j),this.toasService=u(Ie),this.tiposDocumentosService=u(Ae),this._locacionService=u(De),this.generoService=u(ke),this.empresaClienteService=u(we),this.datePipe=u(J),this.empleadosServices=u(P),this.cargosServices=u($e),this.departamentos$=this._locacionService.getDepartamentos(),this.tiposDocumentos$=this.tiposDocumentosService.getTiposDocumentos(),this.generos$=this.generoService.getGeneros(),this.empresasClientes$=this.empresaClienteService.getEmpresas(),this.cargos$=this.cargosServices.getCargos(),this._matData=u(pe),this.profile={avatar:"",name:"Pedro"}}ngOnInit(){this.createForm();let a=this._matData;if(a.edit){let i=a.data;this.form.patchValue(i);let{idDepartamento:p,fechaNacimiento:c}=i,f=new Date(c);this.form.patchValue({fechaNacimiento:f}),this.municipios$=this._locacionService.getMunicipio(p),this.image=`data:image/png;base64,  ${i.foto}`}}onFileSelected(a){let i=a.target;if(i.files&&i.files.length>0){let p=i.files[0],c=new FileReader;c.onload=()=>{let f=c.result;this.image=f;let v=f.split(",")[1];this.form.get("foto").setValue(v)},c.readAsDataURL(p)}}getMunicipios(a){let i=a.value;this.municipios$=this._locacionService.getMunicipio(i)}onSave(){if(this.form.valid)if(this._matData.edit){let i=this.form.getRawValue(),{idDepartamento:c,fechaNacimiento:f}=i,v=z(i,["idDepartamento","fechaNacimiento"]),O=this.datePipe.transform(f,"dd/MM/yyyy"),R=x({fechaNacimiento:O},v);this.fuseService.open(x({},q)).afterClosed().subscribe(B=>{B==="confirmed"?this.empleadosServices.putEmpleados(R).subscribe(Y=>{this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro actualizado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}else{let a=this.form.getRawValue(),{idDepartamento:c,fechaNacimiento:f}=a,v=z(a,["idDepartamento","fechaNacimiento"]),O=this.datePipe.transform(f,"dd/MM/yyyy"),R=x({fechaNacimiento:O},v);this.fuseService.open(x({},q)).afterClosed().subscribe(B=>{B==="confirmed"?this.empleadosServices.postEmpleados(R).subscribe(Y=>{console.log(Y),this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}}createForm(){this.form=this.fb.group({id:[null],primerNombre:[""],segundoNombre:[""],primerApellido:[""],segundoApellido:[""],idTipoDoc:[""],numDoc:[""],idDepartamento:[""],idMunicipio:[""],telefono:[""],telefono2:[""],direccion:[""],idGenero:[""],correo:[""],cargo:[""],fechaNacimiento:[""],foto:[""],firma:[""],idSubEmpresa:[""]})}closeDialog(){this.dialogRef.close()}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=N({type:t,selectors:[["app-form-empleados"]],standalone:!0,features:[te([{provide:me,useClass:Te},{provide:re,useValue:"en-GB"},J]),w],decls:107,vars:40,consts:[["noAvatar",""],["picker",""],["data",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[1,""],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8",3,"formGroup"],[1,"group","relative","mx-auto","mt-8","flex","h-40","w-40","flex-0","rounded-full","mb-8"],[1,"absolute","inset-0","hidden","cursor-pointer","flex-col","items-center","justify-center","rounded-full","bg-gray-800","bg-opacity-80","backdrop-blur","backdrop-filter","group-hover:flex"],[1,"text-white",3,"svgIcon"],[1,"mx-6","mt-2","text-center","font-medium","text-white"],["type","file",1,"absolute","inset-0","opacity-0","cursor-pointer",3,"change"],[4,"ngIf","ngIfElse"],[1,"flex","gap-2.5"],[1,"w-full"],["matInput","",3,"formControlName"],[3,"formControlName"],[4,"ngIf"],["matInput","",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],[3,"selectionChange","formControlName"],[1,"flex","flex-wrap","justify-end","gap-2.5"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","bg-credigray-100",3,"click","color"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","bg-crediblue-50",3,"click","color"],[1,"h-full","w-full","rounded-full","object-cover",3,"src","alt"],[1,"flex","h-full","w-full","items-center","justify-center","rounded-full","bg-gray-200","text-8xl","font-semibold","uppercase","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,p){if(i&1){let c=ee();m(0,"div",3)(1,"div",4)(2,"div",5),s(3),o(),m(4,"form",6)(5,"div",7)(6,"div",8),d(7,"mat-icon",9),m(8,"div",10),s(9," Cambiar foto "),o(),m(10,"input",11),b("change",function(v){return D(c),I(p.onFileSelected(v))}),o()(),g(11,Re,2,2,"ng-container",12)(12,Be,2,1,"ng-template",null,0,ie),o(),m(14,"div",13)(15,"mat-form-field",14)(16,"mat-label"),s(17,"Primer nombre"),o(),d(18,"input",15),o(),m(19,"mat-form-field",14)(20,"mat-label"),s(21,"Segundo nombre"),o(),d(22,"input",15),o()(),m(23,"div",13)(24,"mat-form-field",14)(25,"mat-label"),s(26,"Primer apellido"),o(),d(27,"input",15),o(),m(28,"mat-form-field",14)(29,"mat-label"),s(30,"Segundo apellido"),o(),d(31,"input",15),o()(),m(32,"div",13)(33,"mat-form-field",14)(34,"mat-label"),s(35,"Tipo de documento"),o(),m(36,"mat-select",16),g(37,Le,2,1,"ng-container",17),C(38,"async"),o()(),m(39,"mat-form-field",14)(40,"mat-label"),s(41,"N\xFAmero de identificaci\xF3n"),o(),d(42,"input",15),o()(),m(43,"div",13)(44,"mat-form-field",14)(45,"mat-label"),s(46,"G\xE9nero"),o(),m(47,"mat-select",16),g(48,We,2,1,"ng-container",17),C(49,"async"),o()(),m(50,"mat-form-field",14)(51,"mat-label"),s(52,"Fecha de nacimiento"),o(),d(53,"input",18)(54,"mat-datepicker-toggle",19)(55,"mat-datepicker",null,1),o()(),m(57,"div",13)(58,"mat-form-field",14)(59,"mat-label"),s(60,"Departamento"),o(),m(61,"mat-select",20,2),b("selectionChange",function(v){return D(c),I(p.getMunicipios(v))}),g(63,Je,2,1,"ng-container",17),C(64,"async"),o()(),m(65,"mat-form-field",14)(66,"mat-label"),s(67,"Ciudad"),o(),m(68,"mat-select",16),g(69,Ke,2,1,"ng-container",17),C(70,"async"),o()()(),m(71,"div",13)(72,"mat-form-field",14)(73,"mat-label"),s(74,"Direcci\xF3n"),o(),d(75,"input",15),o(),m(76,"mat-form-field",14)(77,"mat-label"),s(78,"Celular"),o(),d(79,"input",15),o()(),m(80,"div",13)(81,"mat-form-field",14)(82,"mat-label"),s(83,"Tel\xE9fono"),o(),d(84,"input",15),o(),m(85,"mat-form-field",14)(86,"mat-label"),s(87,"Email"),o(),d(88,"input",15),o()(),m(89,"div",13)(90,"mat-form-field",14)(91,"mat-label"),s(92,"Cargo"),o(),d(93,"input",15),o(),m(94,"mat-form-field",14)(95,"mat-label"),s(96,"Empresa"),o(),m(97,"mat-select",16),g(98,Xe,2,1,"ng-container",17),C(99,"async"),o()()(),m(100,"div",21)(101,"button",22),b("click",function(){return D(c),I(p.closeDialog())}),m(102,"span"),s(103," Cancelar "),o()(),m(104,"button",23),b("click",function(){return D(c),I(p.onSave())}),m(105,"span"),s(106," Guardar "),o()()()()()()}if(i&2){let c=W(13),f=W(56);n(3),U(" ",p._matData.edit?"Actualizar empleado":"Crear empleado"," "),n(),r("formGroup",p.form),n(3),r("svgIcon","heroicons_outline:camera"),n(4),r("ngIf",p.form.get("foto").value)("ngIfElse",c),n(7),r("formControlName","primerNombre"),n(4),r("formControlName","segundoNombre"),n(5),r("formControlName","primerApellido"),n(4),r("formControlName","segundoApellido"),n(5),r("formControlName","idTipoDoc"),n(),r("ngIf",y(38,30,p.tiposDocumentos$)),n(5),r("formControlName","numDoc"),n(5),r("formControlName","idGenero"),n(),r("ngIf",y(49,32,p.generos$)),n(5),r("matDatepicker",f)("formControlName","fechaNacimiento"),n(),r("for",f),n(7),r("formControlName","idDepartamento"),n(2),r("ngIf",y(64,34,p.departamentos$)),n(5),r("formControlName","idMunicipio"),n(),r("ngIf",y(70,36,p.municipios$)),n(6),r("formControlName","direccion"),n(4),r("formControlName","telefono"),n(5),r("formControlName","telefono2"),n(4),r("formControlName","correo"),n(5),r("formControlName","cargo"),n(4),r("formControlName","idSubEmpresa"),n(),r("ngIf",y(99,38,p.empresasClientes$)),n(3),r("color","primary"),n(3),r("color","primary")}},dependencies:[k,A,V,de,Ce,_e,ge,ve,he,be,Se,ae,le,ye,oe,ne,Fe,Ne,Me,fe,$]});let e=t;return e})();var Ge=(()=>{let t=class t{constructor(a,i,p){this._matDialog=a,this.estadoDatosService=i,this.empleadoService=p,this.data=[],this.columns=["Estado","Documento","Identificaci\xF3n","Nombre completo","Tel\xE9fono","Cargo"],this.columnPropertyMap={Estado:"estado",Documento:"nombreTipoDocumento",Identificaci\u00F3n:"numDoc","Nombre completo":"nombreCompleto",Tel\u00E9fono:"telefono",Cargo:"cargo"},this.buttons=[{label:"Edit",icon:"edit",action:c=>{console.log("Editing",c),this.selectedData=c,this.onEdit()}}]}onNew(){this._matDialog.open(X,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",width:"50%",maxWidth:"100%"})}onEdit(){this._matDialog.open(X,{autoFocus:!1,data:{edit:!0,data:this.selectedData},maxHeight:"90vh",width:"50%",maxWidth:"100%"})}getEmpleados(){this.subcription$=this.empleadoService.getEmpleados().pipe(L(a=>(a.data.forEach(i=>{i.estado?i.estado=K.ACTIVO:i.estado=K.INACTIVO}),a)),L(a=>(a.data.forEach(i=>{i&&(i.nombreCompleto=i.primerNombre.concat(" ",i.segundoNombre?i.segundoNombre+" ":"",i.primerApellido," ",i.segundoApellido))}),a))).subscribe(a=>{this.data=a.data})}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(i=>{i&&this.getEmpleados()})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getEmpleados(),this.listenGrid()}};t.\u0275fac=function(i){return new(i||t)(M(ce),M(j),M(P))},t.\u0275cmp=N({type:t,selectors:[["app-grid-empleados"]],standalone:!0,features:[w],decls:15,vars:11,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],["mat-flat-button","",1,"ml-4","bg-crediblue-50",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(i,p){i&1&&(m(0,"div",0)(1,"div",1)(2,"div",2),s(3,"Empleados"),o(),m(4,"div",3)(5,"mat-form-field",4),d(6,"mat-icon",5)(7,"input",6),o(),m(8,"button",7),b("click",function(){return p.onNew()}),d(9,"mat-icon",8),m(10,"span",9),s(11,"Crear empleado"),o()()()(),m(12,"div",10)(13,"div",11),d(14,"app-custom-table",12),o()()()),i&2&&(n(5),r("subscriptSizing","dynamic"),n(),r("svgIcon","heroicons_solid:magnifying-glass"),n(),r("autocomplete","off")("placeholder","Buscar"),n(),r("color","primary"),n(),r("svgIcon","heroicons_outline:plus"),n(5),r("columns",p.columns)("displayedColumns",p.columns)("columnPropertyMap",p.columnPropertyMap)("data",p.data)("buttons",p.buttons))},dependencies:[xe,k,A,$,V]});let e=t;return e})();var Pt=[{path:"",component:Ge}];export{Pt as default};
