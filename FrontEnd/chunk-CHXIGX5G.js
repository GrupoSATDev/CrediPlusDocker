import{a as M,b as L,c as Te,d as Ge,e as Ne}from"./chunk-LZSQI2LX.js";import{a as Ae,b as Ie,c as we,d as Me}from"./chunk-Y4MQD3WA.js";import{a as H}from"./chunk-PWHPCRCN.js";import{a as Q}from"./chunk-6IEWE3OU.js";import{a as De}from"./chunk-LBLJGZM7.js";import{a as R,b as Fe,c as w,d as W}from"./chunk-4N6RINGF.js";import"./chunk-55LFJ2HF.js";import"./chunk-CHOSRW5W.js";import{a as ce,b as pe,c as ue,k as z}from"./chunk-GIPKHLVS.js";import{h as me}from"./chunk-7U4JZNVG.js";import{B as Ee,E as _e,I as B,b as fe,i as q,l as he,n as y,p as ve,q as Se,t as xe,w as Ce,x as ye}from"./chunk-CURMXRYA.js";import{ea as I,fa as be,ja as O}from"./chunk-DARKUWJB.js";import"./chunk-EENLYY7H.js";import{a as ge}from"./chunk-EJW5UVWF.js";import{b as le,d as $,e as de}from"./chunk-DJAHQBBJ.js";import{g as k,j as P,l as j,r as se}from"./chunk-NP3GUERB.js";import{$ as te,$b as ie,Cb as e,Db as i,Eb as u,Fb as _,Gb as D,Ib as F,Ob as C,Qb as f,Yb as r,Za as n,Zb as g,_a as V,dc as oe,ea as J,ec as A,fa as p,fc as re,ka as E,mc as K,nc as ae,oc as ne,pb as b,q as N,rb as d,ua as S,va as x}from"./chunk-32HXX3OB.js";import{a as v,d as U}from"./chunk-NEB6MB4Y.js";var T=(()=>{let m=class m{constructor(a,o){this._http=a,this.appSettings=o}getSolicitudes(a){return this._http.get(`${this.appSettings.solicitudesCreditos.url.base}/${a}`)}getSolicitud(a){return this._http.get(`${this.appSettings.solicitudesCreditos.url.base}/${a}`)}postSolicitudes(a){return delete a.id,this._http.post(this.appSettings.solicitudesCreditos.url.base,a)}putSolicitudes(a){let o=a.id;return delete a.id,this._http.put(`${this.appSettings.solicitudesCreditos.url.base}/${o}`,a)}patchSolicitud(a){let o=a.id;delete a.id;let{idEstado:t}=a;return this._http.patch(`${this.appSettings.solicitudesCreditos.url.base}/${o}?idEstado=${t}`,{})}};m.\u0275fac=function(o){return new(o||m)(J(se),J(ge))},m.\u0275prov=te({token:m,factory:m.\u0275fac,providedIn:"root"});let l=m;return l})();var Pe=(()=>{let m=class m{constructor(){this.fb=p(Ee),this.dialogRef=p(ce),this.fuseService=p(z),this.estadosDatosService=p(w),this.toasService=p(W),this.empleadoService=p(H),this._matData=p(pe),this.solicitudService=p(T)}ngOnInit(){this.initialInfoForm=this.fb.group({}),this.firstFormGroup=this.fb.group({nombreCompleto:[{value:"",disabled:!0},y.required],numDoc:[{value:"",disabled:!0},y.required],direccion:[{value:"",disabled:!0},y.required],idMunicipio:[{value:"",disabled:!0},y.required],correo:[{value:"",disabled:!0},y.required]}),this.secondFormGroup=this.fb.group({cupo:["",[y.required]],observacion:["",[y.required]]}),this.createForm();let a=this._matData;if(a.edit){let t=a.data;this.form.patchValue(t)}let o="c6d6b3a7-799f-42eb-8868-e069df989b11";this.subcripstion$=this.empleadoService.getEmpleado(o).pipe(N(t=>(t.data.nombreCompleto=t.data.primerNombre+" "+t.data.segundoNombre+" "+t.data.primerApellido+" "+t.data.segundoApellido,t))).subscribe(t=>{let c=t.data,h={nombreCompleto:t.data.nombreCompleto,numDoc:t.data.numDoc,direccion:t.data.direccion,idMunicipio:t.data.nombreMunicipio,correo:t.data.correo};this.firstFormGroup.patchValue(h)})}onSave(){if(this.secondFormGroup.valid)if(this._matData.edit){let o=this.form.getRawValue(),{cupo:c}=o,h=U(o,["cupo"]),G=v({cupo:Number(c)},h);this.fuseService.open(v({},R)).afterClosed().subscribe(Z=>{Z==="confirmed"?this.solicitudService.putSolicitudes(G).subscribe(ee=>{this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro actualizado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}else{let a=this.secondFormGroup.getRawValue(),{cupo:c}=a,h=U(a,["cupo"]),G=v({cupo:Number(c)},h);this.fuseService.open(v({},R)).afterClosed().subscribe(Z=>{Z==="confirmed"?this.solicitudService.postSolicitudes(G).subscribe(ee=>{console.log(ee),this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}}createForm(){this.form=this.fb.group({id:[null],cupo:[""],observacion:[""]})}closeDialog(){this.dialogRef.close()}};m.\u0275fac=function(o){return new(o||m)},m.\u0275cmp=E({type:m,selectors:[["app-form-solicitudes"]],standalone:!0,features:[A],decls:70,vars:19,consts:[["stepper",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[3,"linear"],["label","Terminos y condiciones",3,"stepControl"],[1,"flex","flex-col","items-center","justify-center","w-full","h-full","px-4"],[1,"max-w-lg","text-center",3,"formGroup"],[1,"text-2xl","font-bold","mb-4"],[1,"mb-6"],["mat-raised-button","","matStepperNext","",1,"bg-blue-500","text-white","px-6","py-2","rounded-md","bg-credigray-100",3,"disabled"],["label","Verifica tu informaci\xF3n",3,"stepControl"],[3,"formGroup"],[1,"w-full"],["matInput","",3,"formControlName"],[1,"flex","flex-wrap","justify-center","gap-2.5"],["mat-raised-button","","matStepperPrevious","",1,"px-6","py-2","rounded-md"],["label","Pasos a seguir"],["label","Solicita tu cupo",3,"stepControl"],["matInput","","placeholder","observacion",3,"formControlName"],["mat-raised-button","",1,"bg-blue-500","text-white","px-6","py-2","rounded-md","bg-credigray-100",3,"click","disabled"]],template:function(o,t){if(o&1){let c=F();e(0,"div",1)(1,"mat-horizontal-stepper",2,0)(3,"mat-step",3)(4,"div",4)(5,"form",5)(6,"h2",6),r(7,"Terminos y condiciones"),i(),e(8,"p",7),r(9," Se presentar\xE1n los t\xE9rminos y condiciones para acceder al cr\xE9dito en la plataforma. En espera de los textos, por ahora se mantiene el lorem ipsu. "),i(),e(10,"button",8),r(11," Siguiente "),i()()()(),e(12,"mat-step",9)(13,"div",4)(14,"form",10)(15,"mat-form-field",11)(16,"mat-label"),r(17,"Nombre de completo"),i(),u(18,"input",12),i(),e(19,"mat-form-field",11)(20,"mat-label"),r(21,"Identificaci\xF3n"),i(),u(22,"input",12),i(),e(23,"mat-form-field",11)(24,"mat-label"),r(25,"Direcci\xF3n"),i(),u(26,"input",12),i(),e(27,"mat-form-field",11)(28,"mat-label"),r(29,"Email"),i(),u(30,"input",12),i(),e(31,"mat-form-field",11)(32,"mat-label"),r(33,"Ciudad"),i(),u(34,"input",12),i(),e(35,"div",13)(36,"button",14),r(37,"Anterior"),i(),e(38,"button",8),r(39,"Siguiente"),i()()()()(),e(40,"mat-step",15)(41,"div",4)(42,"form",5)(43,"h2",6),r(44,"Pasos a seguir"),i(),e(45,"p",7),r(46," 1. Al completar estos pasos nuestro equipo validar\xE1 la informaci\xF3n y aprobar\xE1 o rechazar\xE1 la solicitud, puedes ver el estado en cualquier momento. "),i(),e(47,"p",7),r(48," 2.	Si tu solicitud fue aprobada nuestro equipo se comunicar\xE1 contigo para socializarte el cupo aprobado y los detalles de tu cr\xE9dito. "),i(),e(49,"p",7),r(50," 3.	Si tu solicitud fue rechazada puedes comunicarte con nuestro equipo para obtener m\xE1s informaci\xF3n, podr\xE1s realizar una nueva solicitud dentro de XXX d\xEDas. "),i(),e(51,"button",8),r(52," Siguiente "),i()()()(),e(53,"mat-step",16)(54,"div",4)(55,"form",5)(56,"h2",6),r(57,"Solicita tu cupo"),i(),e(58,"p",7),r(59," Lorem ipsum dolor sit amet, consectetur adipisicing elit. Alias architecto consequuntur eveniet exercitationem expedita facere in, magnam magni molestiae mollitia natus obcaecati odit quibusdam quisquam sit soluta, sunt vel voluptatibus! "),i(),e(60,"mat-form-field",11)(61,"mat-label"),r(62,"Cupo"),i(),u(63,"input",12),i(),e(64,"mat-form-field",11)(65,"mat-label"),r(66,"Observaci\xF3nes"),i(),u(67,"textarea",17),i(),e(68,"button",18),C("click",function(){return S(c),x(t.onSave())}),r(69,"Finalizar"),i()()()()()()}o&2&&(n(),d("linear",!0),n(2),d("stepControl",t.initialInfoForm),n(2),d("formGroup",t.initialInfoForm),n(5),d("disabled",t.initialInfoForm.invalid),n(2),d("stepControl",t.firstFormGroup),n(2),d("formGroup",t.firstFormGroup),n(4),d("formControlName","nombreCompleto"),n(4),d("formControlName","numDoc"),n(4),d("formControlName","direccion"),n(4),d("formControlName","correo"),n(4),d("formControlName","idMunicipio"),n(4),d("disabled",t.firstFormGroup.invalid),n(4),d("formGroup",t.initialInfoForm),n(9),d("disabled",t.initialInfoForm.invalid),n(2),d("stepControl",t.secondFormGroup),n(2),d("formGroup",t.secondFormGroup),n(8),d("formControlName","cupo"),n(4),d("formControlName","observacion"),n(),d("disabled",t.secondFormGroup.invalid))},dependencies:[I,q,B,fe,_e,xe,he,ve,Se,Ce,ye,Ie,Ae,Me,we]});let l=m;return l})();var ke=()=>["/pages/gestion-creditos/solicitudes"];function $e(l,m){if(l&1){let s=F();_(0),e(1,"div",15)(2,"button",16),C("click",function(){S(s);let o=f(2);return x(o.onSave())}),r(3," Aprobar "),i(),e(4,"button",17),C("click",function(){S(s);let o=f(2);return x(o.onReject())}),r(5," Rechazar "),i()(),D()}}function qe(l,m){if(l&1&&(e(0,"div",8)(1,"div",9)(2,"div")(3,"h3",10),r(4),i(),e(5,"p",11),r(6,"Identificaci\xF3n: "),e(7,"span",12),r(8),i()(),e(9,"p",11),r(10,"Empresa: "),e(11,"span",12),r(12),i()(),e(13,"p",13),r(14,"Cargo: "),e(15,"span",12),r(16),i()(),e(17,"p",11),r(18,"Correo: "),e(19,"span",12),r(20),i()(),e(21,"p",11),r(22,"Direcci\xF3n: "),e(23,"span",12),r(24),i()(),e(25,"p",11),r(26,"Tel\xE9fono: "),e(27,"span",12),r(28),i()()(),e(29,"div")(30,"p",11),r(31,"N\xFAmero de solicitud: #12345"),i(),e(32,"p",11),r(33,"Monto solicitado: "),e(34,"span",12),r(35),K(36,"currency"),i()(),e(37,"p",11),r(38,"Fecha de Solicitud: "),e(39,"span",12),r(40),K(41,"date"),i()()()(),b(42,$e,6,0,"ng-container",14),i()),l&2){let s=f();n(4),ie("",s.items.trabajador.primerNombre," ",s.items.trabajador.segundoNombre," ",s.items.trabajador.primerApellido," ",s.items.trabajador.segundoApellido," "),n(4),g(s.items.trabajador.numDoc),n(4),g(s.items.nombreSubEmpresa),n(4),g(s.items.trabajador.cargo),n(4),g(s.items.trabajador.correo),n(4),g(s.items.trabajador.direccion),n(4),g(s.items.trabajador.telefono),n(7),g(ae(36,13,s.items.cupo)),n(5),g(ne(41,15,s.items.fechaCreacion,"dd/MM/yyyy")),n(2),d("ngIf",s.detalleEmpleado.idEstadoSolicitud==s.CodigosEstadosSolicitudes.PENDIENTE)}}var X=(()=>{let m=class m{constructor(){this.empleadosServices=p(H),this.solicitudService=p(T),this.toasService=p(W),this.fuseService=p(z),this.estadosDatosService=p(w),this.activatedRoute=p(le),this.router=p($),this.CodigosEstadosSolicitudes=L}ngOnInit(){let a=this.activatedRoute.snapshot.paramMap.get("id");this.getSolicitud(a)}getSolicitud(a){this.subcription$=this.solicitudService.getSolicitud(a).subscribe(o=>{this.items=o.data,this.detalleEmpleado=o.data})}onSave(){let a={idEstado:L.APROBADA,id:this.detalleEmpleado.id};this.fuseService.open(v({},R)).afterClosed().subscribe(t=>{t==="confirmed"&&(this.subcription$=this.solicitudService.patchSolicitud(a).subscribe(c=>{c&&(this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/solicitudes"]))},c=>{this.toasService.toasAlertWarn({message:"Ha ocurrido un error!!!!",actionMessage:"Cerrar",duration:3e3})}))})}onReject(){let a={idEstado:L.RECHAZADA,id:this.detalleEmpleado.id};this.fuseService.open(v({},Fe)).afterClosed().subscribe(t=>{t==="confirmed"&&(this.subcription$=this.solicitudService.patchSolicitud(a).subscribe(c=>{c&&(this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/solicitudes"]))},c=>{this.toasService.toasAlertWarn({message:"Ha ocurrido un error!!!!",actionMessage:"Cerrar",duration:3e3})}))})}ngOnDestroy(){this.subcription$.unsubscribe()}};m.\u0275fac=function(o){return new(o||m)},m.\u0275cmp=E({type:m,selectors:[["app-form-approve"]],standalone:!0,features:[A],decls:10,vars:4,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","print:p-0","w-full"],[1,"bg-card","shadow","print:bg-transparent","print:p-0","print:shadow-none","rounded-2xl","max-w-xl","mx-auto","overflow-hidden"],[1,"bg-crediblue-50","px-6","py-4","flex","items-center","justify-between"],["mat-button","",1,"flex","items-center",3,"routerLink"],[1,"text-white",3,"svgIcon"],[1,"text-xl","font-bold","text-white"],["class","p-6",4,"ngIf"],[1,"p-6"],[1,"mb-4","flex","justify-between"],[1,"text-lg","font-semibold","text-gray-800"],[1,"text-gray-600","font-bold"],[1,"text-gray-800"],[1,"text-gray-600","font-semibold"],[4,"ngIf"],[1,"flex","justify-between","items-center","mt-10"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediblue-50","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediorange-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"]],template:function(o,t){o&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),u(6,"mat-icon",5),i()(),e(7,"h2",6),r(8,"Detalle de Solicitud"),i()(),b(9,qe,43,18,"div",7),i()()()),o&2&&(n(5),d("routerLink",re(3,ke)),n(),d("svgIcon","heroicons_outline:arrow-long-left"),n(3),d("ngIf",t.items))},dependencies:[I,j,k,me,P,be,O,de]});let l=m;return l})();function Oe(l,m){if(l&1&&(_(0),u(1,"app-custom-table",19),D()),l&2){let s=f(2);n(),d("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("buttons",s.buttons)}}function ze(l,m){if(l&1&&b(0,Oe,2,5,"ng-container",18),l&2){let s=f();d("ngIf",s.data.length)}}function Be(l,m){if(l&1&&(_(0),u(1,"app-custom-table",19),D()),l&2){let s=f(2);n(),d("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("buttons",s.buttons)}}function We(l,m){if(l&1&&b(0,Be,2,5,"ng-container",18),l&2){let s=f();d("ngIf",s.data.length)}}function He(l,m){if(l&1&&(_(0),u(1,"app-custom-table",19),D()),l&2){let s=f(2);n(),d("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("buttons",s.buttons)}}function Le(l,m){if(l&1&&b(0,He,2,5,"ng-container",18),l&2){let s=f();d("ngIf",s.data.length)}}var je=(()=>{let m=class m{constructor(a,o,t){this._matDialog=a,this.estadoDatosService=o,this.solicitudService=t,this.datePipe=p(P),this.currencyPipe=p(j),this.router=p($),this.selectedTab=M.APROBADA,this.data=[],this.columns=["Empleado","Cupo solicitado","Empresa","Estado","Fecha de solicitud"],this.columnPropertyMap={Empleado:"nombreTrabajador","Cupo solicitado":"cupo",Empresa:"nombreSubEmpresa",Estado:"nombreEstadoSolicitud","Fecha de solicitud":"fechaCreacion"},this.buttons=[{label:"View",icon:"visibility",action:c=>{console.log("Approve",c),this.selectedData=c,this.router.navigate(["pages/gestion-creditos/solicitudes/estados",this.selectedData.id])}}],this.tabChanged=c=>{console.log("tabChangeEvent => ",c),console.log("index => ",c.index),this.selectedTab=c.index==0?M.APROBADA:c.index==1?M.RECHAZADA:c.index==2?M.PENDIENTE:M.APROBADA,this.getSolicitudes(this.selectedTab)}}onNew(){this._matDialog.open(Pe,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",maxWidth:"100%"})}onApprove(){this._matDialog.open(X,{autoFocus:!1,data:{data:this.selectedData},maxHeight:"90vh",width:"50%",maxWidth:"100%"})}getSolicitudes(a){this.subcription$=this.solicitudService.getSolicitudes(a).pipe(N(o=>(o.data.forEach(t=>{t.estado?t.estado=Q.ACTIVO:t.estado=Q.INACTIVO}),o)),N(o=>(o.data.forEach(t=>{t.fechaCreacion=this.datePipe.transform(t.fechaCreacion,"dd/MM/yyyy"),t.cupo=this.currencyPipe.transform(t.cupo,"USD","symbol","1.2-2")}),o))).subscribe(o=>{o?this.data=o.data:this.data=[]},o=>{this.data=[]})}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(o=>{o&&this.getSolicitudes(this.selectedTab)})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getSolicitudes(this.selectedTab),this.listenGrid()}};m.\u0275fac=function(o){return new(o||m)(V(ue),V(w),V(T))},m.\u0275cmp=E({type:m,selectors:[["app-grid-solicitudes"]],standalone:!0,features:[oe([P,j]),A],decls:22,vars:7,consts:[["tabGroup",""],[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],["mat-flat-button","",1,"ml-4","bg-crediblue-50",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:overflow-y-auto","bg-gray-100"],["mat-stretch-tabs","false",1,"sm:px-2",3,"selectedTabChange","animationDuration"],["label","Aprobadas"],["matTabContent",""],["label","Rechazadas"],["label","Pendientes"],[4,"ngIf"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(o,t){if(o&1){let c=F();e(0,"div",1)(1,"div",2)(2,"div",3),r(3,"Solicitud de cr\xE9ditos"),i(),e(4,"div",4)(5,"mat-form-field",5),u(6,"mat-icon",6)(7,"input",7),i(),e(8,"button",8),C("click",function(){return S(c),x(t.onNew())}),u(9,"mat-icon",9),e(10,"span",10),r(11,"Crear solicitud"),i()()()(),e(12,"div",11)(13,"div",12)(14,"mat-tab-group",13,0),C("selectedTabChange",function(G){return S(c),x(t.tabChanged(G))}),e(16,"mat-tab",14),b(17,ze,1,1,"ng-template",15),i(),e(18,"mat-tab",16),b(19,We,1,1,"ng-template",15),i(),e(20,"mat-tab",17),b(21,Le,1,1,"ng-template",15),i()()()()()}o&2&&(n(5),d("subscriptSizing","dynamic"),n(),d("svgIcon","heroicons_solid:magnifying-glass"),n(),d("autocomplete","off")("placeholder","Buscar"),n(),d("color","primary"),n(),d("svgIcon","heroicons_outline:plus"),n(5),d("animationDuration","500"))},dependencies:[De,I,q,O,B,Ge,Ne,Te,k]});let l=m;return l})();var Kt=[{path:"",component:je},{path:"estados/:id",component:X}];export{Kt as default};
