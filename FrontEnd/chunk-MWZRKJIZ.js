import{a as ie,b as ne,c as oe}from"./chunk-E7PUDPFG.js";import{a as O}from"./chunk-NIINY4Z3.js";import{a as ee}from"./chunk-LBLJGZM7.js";import{a as k,c as G,d as te}from"./chunk-JM6PAC2Q.js";import"./chunk-55LFJ2HF.js";import"./chunk-CHOSRW5W.js";import{k as X}from"./chunk-GIPKHLVS.js";import{h as q}from"./chunk-7U4JZNVG.js";import{I as Y,i as J}from"./chunk-CURMXRYA.js";import{ea as K,fa as Q,ja as V}from"./chunk-DARKUWJB.js";import"./chunk-EENLYY7H.js";import"./chunk-EJW5UVWF.js";import{b as L,d as T,e as U}from"./chunk-DJAHQBBJ.js";import{g as R,j as A,l as E}from"./chunk-NP3GUERB.js";import{Cb as n,Db as o,Eb as x,Fb as g,Gb as h,Ib as D,Ob as S,Qb as d,Yb as l,Za as s,Zb as C,ac as j,bc as H,cc as W,dc as z,ec as P,fa as p,fc as Z,ka as w,mc as M,nc as N,oc as $,pb as f,q as B,rb as m,ua as v,va as _}from"./chunk-32HXX3OB.js";import{a as F}from"./chunk-NEB6MB4Y.js";var u=function(e){return e.EN_REVISION="EnRevision",e.APROBADA="Aprobados",e.PAGADO="Pagados",e.RECHAZADA="Rechazados",e}(u||{}),I=function(e){return e.EN_REVISION="e626ea69-e995-4462-be7a-905326784782",e.APROBADA="e626ea69-e995-4462-be7a-901321784782",e.PAGADO="e626ea69-e995-4462-be7a-905326734782",e.RECHAZADA="e626ea69-e995-4462-be7a-805326734783",e.EN_MORA="e626ea69-e995-6462-be8a-905326714780",e}(I||{});function me(e,r){if(e&1&&(g(0),x(1,"app-custom-table",17),h()),e&2){let t=d(2);s(),m("columns",t.columns)("displayedColumns",t.columns)("columnPropertyMap",t.columnPropertyMap)("data",t.data)("buttons",t.buttons)}}function ce(e,r){if(e&1&&f(0,me,2,5,"ng-container",16),e&2){let t=d();m("ngIf",t.data.length)}}function de(e,r){if(e&1&&(g(0),x(1,"app-custom-table",17),h()),e&2){let t=d(2);s(),m("columns",t.columns)("displayedColumns",t.columns)("columnPropertyMap",t.columnPropertyMap)("data",t.data)("buttons",t.buttons)}}function pe(e,r){if(e&1&&f(0,de,2,5,"ng-container",16),e&2){let t=d();m("ngIf",t.data.length)}}function ue(e,r){if(e&1&&(g(0),x(1,"app-custom-table",17),h()),e&2){let t=d(2);s(),m("columns",t.columns)("displayedColumns",t.columns)("columnPropertyMap",t.columnPropertyMap)("data",t.data)("buttons",t.buttons)}}function fe(e,r){if(e&1&&f(0,ue,2,5,"ng-container",16),e&2){let t=d();m("ngIf",t.data.length)}}function xe(e,r){if(e&1&&(g(0),x(1,"app-custom-table",17),h()),e&2){let t=d(2);s(),m("columns",t.columns)("displayedColumns",t.columns)("columnPropertyMap",t.columnPropertyMap)("data",t.data)("buttons",t.buttons)}}function be(e,r){if(e&1&&f(0,xe,2,5,"ng-container",16),e&2){let t=d();m("ngIf",t.data.length)}}var ae=(()=>{let r=class r{constructor(){this.datePipe=p(A),this.currencyPipe=p(E),this.router=p(T),this.estadoService=p(G),this.consumoService=p(O),this.selectedTab=u.APROBADA,this.data=[],this.columns=["Fecha","N\xFAmero de factura","Detalle compra","Valor factura","Valor cuotas","Cantidad cuotas","Estado"],this.columnPropertyMap={Fecha:"fechaCreacion","N\xFAmero de factura":"numeroFactura","Detalle compra":"detalleCompra","Valor factura":"montoConsumo","Valor cuotas":"montoCuotas","Cantidad cuotas":"cantidadCuotas",Estado:"nombreEstadoCredito"},this.buttons=[{label:"View",icon:"visibility",action:a=>{console.log("Approve",a),this.selectedData=a,this.router.navigate(["pages/gestion-creditos/consumos/detalle",this.selectedData.id])}}],this.tabChanged=a=>{console.log("tabChangeEvent => ",a),console.log("index => ",a.index),this.tabIndex=a.index,console.log(this.tabIndex),this.selectedTab=a.index==0?u.EN_REVISION:a.index==1?u.APROBADA:a.index==2?u.PAGADO:a.index==3?u.RECHAZADA:u.EN_REVISION,this.getDetalle(this.selectedTab)}}listenGrid(){this.estadoService.stateGridSolicitudes.asObservable().subscribe(i=>{i.state&&(console.log("Si entro"),console.log(i),this.selectedTab=i.tab==0?u.EN_REVISION:i.tab==1?u.APROBADA:i.tab==2?u.PAGADO:i.tab==3?u.RECHAZADA:u.EN_REVISION,this.tabIndex=i.tab,console.log(this.tabIndex),this.getDetalle(this.selectedTab))})}getDetalle(a){this.subcription$=this.consumoService.getDetalle(a).pipe(B(i=>(i.data.forEach(c=>{c.fechaCreacion=this.datePipe.transform(c.fechaCreacion,"dd/MM/yyyy"),c.montoConsumo=this.currencyPipe.transform(c.montoConsumo,"USD","symbol","1.2-2"),c.montoCuotas=this.currencyPipe.transform(c.montoCuotas,"USD","symbol","1.2-2")}),i))).subscribe(i=>{i?this.data=i.data:this.data=[]},i=>{this.data=[]})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getDetalle(this.selectedTab),this.listenGrid()}};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=w({type:r,selectors:[["app-grid-consumos"]],standalone:!0,features:[z([A,E]),P],decls:20,vars:6,consts:[["tabGroup",""],[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:overflow-y-auto","bg-gray-100"],["mat-stretch-tabs","false",1,"sm:px-2",3,"selectedIndexChange","selectedTabChange","animationDuration","selectedIndex"],["label","En revisi\xF3n"],["matTabContent",""],["label","Aprobados"],["label","Pagados"],["label","Rechazados"],[4,"ngIf"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(i,c){if(i&1){let b=D();n(0,"div",1)(1,"div",2)(2,"div",3),l(3,"Detalle Consumos"),o(),n(4,"div",4)(5,"mat-form-field",5),x(6,"mat-icon",6)(7,"input",7),o()()(),n(8,"div",8)(9,"div",9)(10,"mat-tab-group",10,0),W("selectedIndexChange",function(y){return v(b),H(c.tabIndex,y)||(c.tabIndex=y),_(y)}),S("selectedTabChange",function(y){return v(b),_(c.tabChanged(y))}),n(12,"mat-tab",11),f(13,ce,1,1,"ng-template",12),o(),n(14,"mat-tab",13),f(15,pe,1,1,"ng-template",12),o(),n(16,"mat-tab",14),f(17,fe,1,1,"ng-template",12),o(),n(18,"mat-tab",15),f(19,be,1,1,"ng-template",12),o()()()()()}i&2&&(s(5),m("subscriptSizing","dynamic"),s(),m("svgIcon","heroicons_solid:magnifying-glass"),s(),m("autocomplete","off")("placeholder","Buscar"),s(3),m("animationDuration","500"),j("selectedIndex",c.tabIndex))},dependencies:[ee,J,V,Y,ne,ie,oe,R]});let e=r;return e})();var ge=()=>["/pages/gestion-creditos/consumos"];function he(e,r){if(e&1&&(n(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16)(4,"div")(5,"h3",17),l(6,"Fecha de compra"),o()(),n(7,"p",18),l(8),M(9,"date"),o()(),n(10,"div",16)(11,"div")(12,"h3",17),l(13,"N\xFAmero de factura"),o()(),n(14,"p",18),l(15),o()(),n(16,"div",16)(17,"div")(18,"h3",17),l(19,"Valor factura"),o(),n(20,"p",19),l(21,"Indica el valor en COP"),o()(),n(22,"p",18),l(23),M(24,"currency"),o()(),n(25,"div",20)(26,"p",17),l(27,"Valor cuota"),o(),n(28,"p",18),l(29),M(30,"currency"),o()(),n(31,"div",21)(32,"p",17),l(33,"Cantidad cuotas"),o(),n(34,"p",18),l(35),o()(),n(36,"div",22)(37,"p",17),l(38,"Detalle compra"),o(),n(39,"p",18),l(40),o()()()()()),e&2){let t=d(2);s(8),C($(9,6,t.detalle.fechaCreacion,"dd/MM/yyyy")),s(7),C(t.detalle.numeroFactura),s(8),C(N(24,9,t.detalle.montoConsumo)),s(6),C(N(30,11,t.detalle.montoCuotas)),s(6),C(t.detalle.cantidadCuotas),s(5),C(t.detalle.detalleCompra)}}function Ce(e,r){if(e&1){let t=D();n(0,"div",8),f(1,he,41,13,"div",9),g(2),n(3,"div",10)(4,"button",11),S("click",function(){v(t);let i=d();return _(i.onSave())}),l(5," Aprobar "),o(),n(6,"button",12),S("click",function(){v(t);let i=d();return _(i.onReject())}),l(7," Rechazar "),o()(),h(),o()}if(e&2){let t=d();s(),m("ngIf",t.detalle)}}var re=(()=>{let r=class r{constructor(){this.toasService=p(te),this.fuseService=p(X),this.estadosDatosService=p(G),this.detalleConsumoService=p(O),this.activatedRoute=p(L),this.router=p(T),this.idCredito="",this.CodigosDetalleConsumo=I}ngOnInit(){this.idCredito=this.activatedRoute.snapshot.paramMap.get("id"),this.getDetalle(this.idCredito)}getDetalle(a){this.subcription$=this.detalleConsumoService.getConsumo(a).subscribe(i=>{console.log(i),this.detalle=i.data})}onSave(){let a={idEstado:I.APROBADA,id:this.detalle.id};this.fuseService.open(F({},k)).afterClosed().subscribe(c=>{c==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(a).subscribe(b=>{this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/consumos"]),this.estadosDatosService.stateGridSolicitudes.next({state:!0,tab:0})},b=>{this.toasService.toasAlertWarn({message:"Ha ocurrido un error!!!!",actionMessage:"Cerrar",duration:3e3})}))})}onReject(){let a={idEstado:I.RECHAZADA,id:this.detalle.id};this.fuseService.open(F({},k)).afterClosed().subscribe(c=>{c==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(a).subscribe(b=>{b.isExitoso&&(this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/consumos"]),this.estadosDatosService.stateGridSolicitudes.next({state:!0,tab:0}))},b=>{this.toasService.toasAlertWarn({message:"Ha ocurrido un error!!!!",actionMessage:"Cerrar",duration:3e3})}))})}};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=w({type:r,selectors:[["app-form-consumos"]],standalone:!0,features:[P],decls:10,vars:4,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","print:p-0","w-full"],[1,"bg-card","shadow","print:bg-transparent","print:p-0","print:shadow-none","rounded-2xl","max-w-xl","mx-auto","overflow-hidden"],[1,"bg-crediblue-50","px-6","py-4","flex","items-center","justify-between"],["mat-button","",1,"flex","items-center",3,"routerLink"],[1,"text-white",3,"svgIcon"],[1,"text-xl","font-bold","text-white"],["class","p-6",4,"ngIf"],[1,"p-6"],["class","w-full h-full px-4",4,"ngIf"],[1,"flex","justify-between","items-center","mt-8","p-4"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediblue-50","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediorange-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],[1,"w-full","h-full","px-4"],[1,"max-w-2xl","mx-auto","p-4","bg-white","shadow-lg","rounded-lg"],[1,"space-y-4"],[1,"flex","justify-between","items-center","border-b","pb-2"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"flex","justify-between","items-center"],[1,"flex","justify-between","items-center","pt-4","border-t"],[1,"flex","justify-between","items-center","border-t","pt-4"]],template:function(i,c){i&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),x(6,"mat-icon",5),o()(),n(7,"h2",6),l(8,"Detalle consumo"),o()(),f(9,Ce,8,1,"div",7),o()()()),i&2&&(s(5),m("routerLink",Z(3,ge)),s(),m("svgIcon","heroicons_outline:arrow-long-left"),s(3),m("ngIf",c.detalle))},dependencies:[q,E,A,Q,K,V,R,U]});let e=r;return e})();var Xe=[{path:"",component:ae},{path:"detalle/:id",component:re}];export{Xe as default};
