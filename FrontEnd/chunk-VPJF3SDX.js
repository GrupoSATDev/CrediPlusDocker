import{a as oe,b as ne,c as ae}from"./chunk-PY6MPHVW.js";import{a as f,b as F}from"./chunk-PEZYCTDT.js";import{a as N}from"./chunk-NZK3BYOF.js";import{a as te}from"./chunk-AVIANEB4.js";import{a as ie}from"./chunk-CQJY43M3.js";import{a as V}from"./chunk-OFEOPKCC.js";import"./chunk-CHOSRW5W.js";import{a as ee}from"./chunk-ACIMG2KZ.js";import{a as O}from"./chunk-H7DTTKLU.js";import"./chunk-33XTDNRI.js";import{g as X}from"./chunk-QS2WZY2K.js";import"./chunk-JND367CQ.js";import{h as q}from"./chunk-7U4JZNVG.js";import{G as Y,i as J}from"./chunk-JLNARVDU.js";import{ea as K,fa as Q,ja as R}from"./chunk-DARKUWJB.js";import"./chunk-EENLYY7H.js";import"./chunk-HHDBYFMG.js";import{b as Z,d as P,e as U}from"./chunk-DJAHQBBJ.js";import{g as M,j as I,l as E}from"./chunk-NP3GUERB.js";import{Cb as o,Db as n,Eb as g,Fb as v,Gb as _,Ib as D,Ob as y,Qb as p,Yb as l,Za as s,Zb as b,ac as B,bc as z,cc as H,dc as W,ec as T,fa as d,fc as $,ka as w,mc as A,nc as k,oc as L,pb as u,q as j,rb as c,ua as h,va as C}from"./chunk-32HXX3OB.js";import{a as G}from"./chunk-NEB6MB4Y.js";function ce(t,r){if(t&1&&(v(0),g(1,"app-custom-table",16),_()),t&2){let e=p(2);s(),c("columns",e.columns)("displayedColumns",e.columns)("columnPropertyMap",e.columnPropertyMap)("data",e.data)("buttons",e.buttons)}}function de(t,r){if(t&1&&u(0,ce,2,5,"ng-container",15),t&2){let e=p();c("ngIf",e.data.length)}}function pe(t,r){if(t&1&&(v(0),g(1,"app-custom-table",16),_()),t&2){let e=p(2);s(),c("columns",e.columns)("displayedColumns",e.columns)("columnPropertyMap",e.columnPropertyMap)("data",e.data)("buttons",e.buttons)}}function ue(t,r){if(t&1&&u(0,pe,2,5,"ng-container",15),t&2){let e=p();c("ngIf",e.data.length)}}function fe(t,r){if(t&1&&(v(0),g(1,"app-custom-table",16),_()),t&2){let e=p(2);s(),c("columns",e.columns)("displayedColumns",e.columns)("columnPropertyMap",e.columnPropertyMap)("data",e.data)("buttons",e.buttons)}}function xe(t,r){if(t&1&&u(0,fe,2,5,"ng-container",15),t&2){let e=p();c("ngIf",e.data.length)}}var re=(()=>{let r=class r{constructor(){this.datePipe=d(I),this.currencyPipe=d(E),this.router=d(P),this.estadoService=d(V),this.consumoService=d(N),this.selectedTab=f.EN_REVISION,this.data=[],this.columns=["Fecha","N\xFAmero de factura","Detalle compra","Valor factura","Valor cuotas","Cantidad cuotas","Estado"],this.columnPropertyMap={Fecha:"fechaCreacion","N\xFAmero de factura":"numeroFactura","Detalle compra":"detalleCompra","Valor factura":"montoConsumo","Valor cuotas":"montoCuotas","Cantidad cuotas":"cantidadCuotas",Estado:"nombreEstadoCredito"},this.buttons=[{label:"View",icon:"visibility",action:a=>{console.log("Approve",a),this.selectedData=a,this.router.navigate(["pages/gestion-creditos/consumos/detalle",this.selectedData.id])}}],this.tabChanged=a=>{console.log("tabChangeEvent => ",a),console.log("index => ",a.index),this.tabIndex=a.index,console.log(this.tabIndex),this.selectedTab=a.index==0?f.EN_REVISION:a.index==1?f.APROBADA:a.index==2?f.RECHAZADA:f.EN_REVISION,this.getDetalle(this.selectedTab)}}listenGrid(){this.estadoService.stateGridSolicitudes.asObservable().subscribe(i=>{i.state&&(console.log("Si entro"),console.log(i),this.selectedTab=i.tab==0?f.EN_REVISION:i.tab==1?f.APROBADA:i.tab==2?f.RECHAZADA:f.EN_REVISION,this.tabIndex=i.tab,console.log(this.tabIndex),this.getDetalle(this.selectedTab))})}getDetalle(a){this.subcription$=this.consumoService.getDetalle(a).pipe(j(i=>(i.data.forEach(m=>{m.fechaCreacion=this.datePipe.transform(m.fechaCreacion,"dd/MM/yyyy"),m.montoConsumo=this.currencyPipe.transform(m.montoConsumo,"USD","symbol","1.2-2"),m.montoCuotas=this.currencyPipe.transform(m.montoCuotas,"USD","symbol","1.2-2")}),i))).subscribe(i=>{i?this.data=i.data:this.data=[]},i=>{this.data=[]})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getDetalle(this.selectedTab),this.listenGrid()}};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=w({type:r,selectors:[["app-grid-consumos"]],standalone:!0,features:[W([I,E]),T],decls:18,vars:6,consts:[["tabGroup",""],[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","rounded-lg","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:overflow-y-auto","bg-gray-100"],["mat-stretch-tabs","false",1,"sm:px-2",3,"selectedIndexChange","selectedTabChange","animationDuration","selectedIndex"],["label","En revisi\xF3n"],["matTabContent",""],["label","Aprobados"],["label","Rechazados"],[4,"ngIf"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(i,m){if(i&1){let x=D();o(0,"div",1)(1,"div",2)(2,"div",3),l(3,"Detalle Consumo"),n(),o(4,"div",4)(5,"mat-form-field",5),g(6,"mat-icon",6)(7,"input",7),n()()(),o(8,"div",8)(9,"div",9)(10,"mat-tab-group",10,0),H("selectedIndexChange",function(S){return h(x),z(m.tabIndex,S)||(m.tabIndex=S),C(S)}),y("selectedTabChange",function(S){return h(x),C(m.tabChanged(S))}),o(12,"mat-tab",11),u(13,de,1,1,"ng-template",12),n(),o(14,"mat-tab",13),u(15,ue,1,1,"ng-template",12),n(),o(16,"mat-tab",14),u(17,xe,1,1,"ng-template",12),n()()()()()}i&2&&(s(5),c("subscriptSizing","dynamic"),s(),c("svgIcon","heroicons_solid:magnifying-glass"),s(),c("autocomplete","off")("placeholder","Buscar"),s(3),c("animationDuration","500"),B("selectedIndex",m.tabIndex))},dependencies:[te,J,R,Y,ne,oe,ae,M]});let t=r;return t})();var ge=()=>["/pages/gestion-creditos/consumos"];function be(t,r){if(t&1&&(o(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"div")(5,"h3",15),l(6,"Fecha de compra"),n()(),o(7,"p",16),l(8),A(9,"date"),n()(),o(10,"div",14)(11,"div")(12,"h3",15),l(13,"N\xFAmero de factura"),n()(),o(14,"p",16),l(15),n()(),o(16,"div",14)(17,"div")(18,"h3",15),l(19,"Valor factura"),n(),o(20,"p",17),l(21,"Indica el valor en COP"),n()(),o(22,"p",16),l(23),A(24,"currency"),n()(),o(25,"div",18)(26,"p",15),l(27,"Valor cuota"),n(),o(28,"p",16),l(29),A(30,"currency"),n()(),o(31,"div",19)(32,"p",15),l(33,"Cantidad cuotas"),n(),o(34,"p",16),l(35),n()(),o(36,"div",20)(37,"p",15),l(38,"Detalle compra"),n(),o(39,"p",16),l(40),n()()()()()),t&2){let e=p(2);s(8),b(L(9,6,e.detalle.fechaCreacion,"dd/MM/yyyy")),s(7),b(e.detalle.numeroFactura),s(8),b(k(24,9,e.detalle.montoConsumo)),s(6),b(k(30,11,e.detalle.montoCuotas)),s(6),b(e.detalle.cantidadCuotas),s(5),b(e.detalle.detalleCompra)}}function he(t,r){if(t&1){let e=D();v(0),o(1,"div",21)(2,"button",22),y("click",function(){h(e);let i=p(2);return C(i.onReject())}),l(3," Rechazar "),n(),o(4,"button",23),y("click",function(){h(e);let i=p(2);return C(i.onSave())}),l(5," Aprobar "),n()(),_()}}function Ce(t,r){if(t&1&&(o(0,"div",8),u(1,be,41,13,"div",9)(2,he,6,0,"ng-container",10),n()),t&2){let e=p();s(),c("ngIf",e.detalle),s(),c("ngIf",e.detalle.idEstadoCredito==e.CodigosDetalleConsumo.EN_REVISION)}}var se=(()=>{let r=class r{constructor(){this.toasService=d(ie),this.fuseService=d(X),this.estadosDatosService=d(V),this.detalleConsumoService=d(N),this.activatedRoute=d(Z),this.router=d(P),this.swalService=d(ee),this.idCredito="",this.CodigosDetalleConsumo=F}ngOnInit(){this.idCredito=this.activatedRoute.snapshot.paramMap.get("id"),this.getDetalle(this.idCredito)}getDetalle(a){this.subcription$=this.detalleConsumoService.getConsumo(a).subscribe(i=>{console.log(i),this.detalle=i.data})}onSave(){let a={idEstado:F.APROBADA,id:this.detalle.id};this.fuseService.open(G({},O)).afterClosed().subscribe(m=>{m==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(a).subscribe(x=>{x.isExitoso&&(this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.router.navigate(["/pages/gestion-creditos/consumos"]),this.estadosDatosService.stateGridSolicitudes.next({state:!0,tab:0}))},x=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}))})}onReject(){let a={idEstado:F.RECHAZADA,id:this.detalle.id};this.fuseService.open(G({},O)).afterClosed().subscribe(m=>{m==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(a).subscribe(x=>{x.isExitoso&&(this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/consumos"]),this.estadosDatosService.stateGridSolicitudes.next({state:!0,tab:0}))},x=>{this.toasService.toasAlertWarn({message:"Ha ocurrido un error!!!!",actionMessage:"Cerrar",duration:3e3})}))})}};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=w({type:r,selectors:[["app-form-consumos"]],standalone:!0,features:[T],decls:10,vars:4,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","print:p-0","w-full"],[1,"bg-card","shadow","print:bg-transparent","print:p-0","print:shadow-none","rounded-2xl","max-w-xl","mx-auto","overflow-hidden"],[1,"bg-crediblue-50","px-6","py-4","flex","items-center","justify-between"],["mat-button","",1,"flex","items-center",3,"routerLink"],[1,"text-white",3,"svgIcon"],[1,"text-xl","font-bold","text-white"],["class","p-6",4,"ngIf"],[1,"p-6"],["class","w-full h-full px-4",4,"ngIf"],[4,"ngIf"],[1,"w-full","h-full","px-4"],[1,"max-w-2xl","mx-auto","p-4","bg-white","shadow-lg","rounded-lg"],[1,"space-y-4"],[1,"flex","justify-between","items-center","border-b","pb-2"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"flex","justify-between","items-center"],[1,"flex","justify-between","items-center","pt-4","border-t"],[1,"flex","justify-between","items-center","border-t","pt-4"],[1,"flex","justify-end","items-center","mt-8","p-4","gap-2.5"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediorange-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediblue-50","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"]],template:function(i,m){i&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),g(6,"mat-icon",5),n()(),o(7,"h2",6),l(8,"Detalle consumo"),n()(),u(9,Ce,3,2,"div",7),n()()()),i&2&&(s(5),c("routerLink",$(3,ge)),s(),c("svgIcon","heroicons_outline:arrow-long-left"),s(3),c("ngIf",m.detalle))},dependencies:[q,E,I,Q,K,R,M,U]});let t=r;return t})();var Xe=[{path:"",component:re},{path:"detalle/:id",component:se}];export{Xe as default};
