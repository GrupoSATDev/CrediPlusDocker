import{a as De}from"./chunk-BYA7JPSE.js";import{a as w}from"./chunk-FAEUQIFQ.js";import{a as ke,b as _}from"./chunk-P4PAYY2C.js";import{a as Fe,b as Ie,c as Te}from"./chunk-LZ3ZEVTF.js";import{a as Ee}from"./chunk-DTORAJAR.js";import{a as we}from"./chunk-3R6HD5RM.js";import{a as _e}from"./chunk-CJO6YW5P.js";import"./chunk-7YBFULQ5.js";import{g as se,h as be}from"./chunk-QVE5MGEQ.js";import{C as Ce,F as ge,J as ve,b as ie,e as re,i as ae,l as me,n as x,p as de,q as fe,s as ue,u as he,x as Se,y as ye}from"./chunk-4PVPKBBG.js";import{e as pe}from"./chunk-KAEQCOKJ.js";import"./chunk-YKJB7XET.js";import{h as oe}from"./chunk-FUOI65R5.js";import{a as xe}from"./chunk-73F67TFK.js";import"./chunk-XTYNXB3F.js";import{b as ce}from"./chunk-6XM3XPZZ.js";import{$a as g,Ad as ee,Eb as T,Ec as Y,Fb as f,Gb as O,Ka as a,Md as te,Ob as B,Pb as $,Sb as q,Xb as z,Yb as U,Z as j,aa as V,bb as l,fa as I,fe as ne,ga as u,ib as G,ka as R,ke as le,mb as c,nb as s,ob as v,pb as N,pc as H,q as P,qb as A,qc as J,rc as K,sb as L,ua as y,uc as Q,va as C,vb as b,vc as E,xb as X,xc as W,yc as k,zd as Z}from"./chunk-ODJKW74N.js";import{a as F,d as M}from"./chunk-NEB6MB4Y.js";var Me=(()=>{let o=class o{constructor(n,r){this._http=n,this.appSettings=r}getEstados(){return this._http.get(this.appSettings.estadoSolicitudes.url.base)}};o.\u0275fac=function(r){return new(r||o)(I(Y),I(ce))},o.\u0275prov=V({token:o,factory:o.\u0275fac,providedIn:"root"});let t=o;return t})();var Ve=(t,o)=>({"bg-green-700":t,"bg-credigray-100":o});function Re(t,o){if(t&1&&(c(0,"mat-option",21),f(1),s()),t&2){let d=o.$implicit;l("value",d.id),a(),O(d.nombre)}}function Ge(t,o){if(t&1&&(N(0),g(1,Re,2,2,"mat-option",20),A()),t&2){let d=o.ngIf;a(),l("ngForOf",d.data)}}function Ne(t,o){if(t&1&&(c(0,"div",19)(1,"div",22),v(2,"app-custom-table",23),s()()),t&2){let d=X();a(2),l("columns",d.columns)("displayedColumns",d.columns)("columnPropertyMap",d.columnPropertyMap)("data",d.data)("searchTerm",d.searchTerm)}}function Ae(t,o){t&1&&(c(0,"div",24)(1,"div",25)(2,"fuse-alert",26)(3,"span",27),f(4,"Informaci\xF3n"),s(),f(5," No hay informaci\xF3n hasta el momento. "),s()()()),t&2&&(a(2),l("type","info")("appearance","outline"))}function Le(t,o){t&1&&g(0,Ae,6,2,"ng-template")}var Pe=(()=>{let o=class o{constructor(){this.searchTerm="",this.fb=u(Ce),this.reportesService=u(De),this.datePipe=u(E),this.estados=new ue([""]),this.data=[],this.aesEncriptService=u(pe),this.estadoSolicitudesService=u(Me),this.currencyPipe=u(k),this.exportData=[],this.fuseService=u(se),this.solicitudes$=this.estadoSolicitudesService.getEstados().pipe(j(n=>{let r=n.data;r&&this.form.get("idTipoSolicitud").setValue(r[0].id)}))}onSearch(n){let r=n.target;this.searchTerm=r.value.trim().toLowerCase()}onSelect(n){let r=n.value}ngOnInit(){this.createForm()}onConsultar(){if(this.form.valid){let n=this.form.getRawValue(),{fechaInicio:r,fechaFinal:e}=n,p=M(n,["fechaInicio","fechaFinal"]),m=this.datePipe.transform(r,"yyyy-MM-dd"),S=this.datePipe.transform(e,"yyyy-MM-dd"),D=F({fechaInicio:m,fechaFinal:S},p);console.log(D),this.reportesService.getReporteSolicitudes(D).pipe(P(h=>(h.data.forEach(i=>{i.fechaCobro=this.datePipe.transform(i.fechaCobro,"dd/MM/yyyy"),i.fechaInicioContratoTrabajador=this.datePipe.transform(i.fechaInicioContratoTrabajador,"dd/MM/yyyy"),i.fechaFinContratoTrabajador=this.datePipe.transform(i.fechaFinContratoTrabajador,"dd/MM/yyyy"),i.montoCuota&&(i.montoCuota=this.aesEncriptService.decrypt(i.montoCuota)),i.montoCuotaSinIntereses&&(i.montoCuotaSinIntereses=this.aesEncriptService.decrypt(i.montoCuotaSinIntereses)),i.interesesGanados&&(i.interesesGanados=this.aesEncriptService.decrypt(i.interesesGanados)),i.montoCuota=this.currencyPipe.transform(i.montoCuota,"USD","symbol","1.2-2"),i.montoCuotaSinIntereses=this.currencyPipe.transform(i.montoCuotaSinIntereses,"USD","symbol","1.2-2"),i.interesesGanados=parseFloat(i.interesesGanados.replace(",",".")),i.interesesGanados=this.currencyPipe.transform(i.interesesGanados,"USD","symbol","1.2-2")}),h))).subscribe(h=>{h.data?(this.data=h.data,this.convertDataExportFijos(h.data)):this.data=[]})}}convertDataExportFijos(n){let r=n.map(e=>({Trabajador:e.nombreTrabajador,Identificaci\u00F3n:e.documetoTrabajador,TipodeContrato:e.tipoContratoTrabajador,Empresa:e.nombreSubEmpresa,Iniciodecontrato:e.fechaInicioContratoTrabajador,Findecontrato:e.fechaFinContratoTrabajador,CantidaddeCuotas:e.numCuota,FechaCobro:e.fechaCobro,ValorCuota:w(e.montoCuota),ValorSinIntereses:w(e.montoCuotaSinIntereses),InteresesGanados:w(e.interesesGanados)}));this.exportData=r}exportToExcel(n){this.fuseService.open(F({},be)).afterClosed().subscribe(e=>{if(e==="confirmed"){let p=_.json_to_sheet(n),m=_.book_new();_.book_append_sheet(m,p,"Sheet1"),ke(m,`Reporte cobros trabajadores${this.datePipe.transform(new Date,"dd/MM/yyyy")}.xlsx`)}})}createForm(){this.form=this.fb.group({idTipoSolicitud:["",x.required],fechaInicio:["",x.required],fechaFinal:["",x.required]})}};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=R({type:o,selectors:[["app-reporte-solicitudes"]],standalone:!0,features:[B([{provide:ee,useClass:Ee},{provide:Z,useValue:"en-GB"},E,k,W]),$],decls:38,vars:23,consts:[["inicioPicker",""],["finalPicker",""],["cdkScrollable","",1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],[1,"px-6","border-b","mt-6","w-full","shrink-0","sm:mt-0","sm:space-x-2","lg:w-full"],[1,"flex","flex-col","sm:flex-row","gap-2.5",3,"formGroup"],[1,"w-full","sm:w-1/2"],[3,"selectionChange","formControlName"],[4,"ngIf"],["floatLabel","always",1,"w-full","sm:w-1/2"],["matInput","","placeholder","dd/mm/yyyy",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],["mat-flat-button","",1,"sm:w-1/6","w-full","sm:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:sm:w-1/6","w-full","sm:mt-6","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color","ngClass","disabled"],[1,"flex","flex-auto","overflow-hidden"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","searchTerm"],[1,"inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-4","sm:p-2","print:p-0","w-full"],[3,"type","appearance"],["fuseAlertTitle",""]],template:function(r,e){if(r&1){let p=L();c(0,"div",2)(1,"div",3)(2,"div",4),f(3,"Reporte de Solicitudes"),s(),c(4,"div",5)(5,"mat-form-field",6),v(6,"mat-icon",7),c(7,"input",8),b("input",function(S){return y(p),C(e.onSearch(S))}),s()()()(),c(8,"div",9)(9,"form",10)(10,"mat-form-field",11)(11,"mat-label"),f(12,"Estados"),s(),c(13,"mat-select",12),b("selectionChange",function(S){return y(p),C(e.onSelect(S))}),g(14,Ge,2,1,"ng-container",13),z(15,"async"),s()(),c(16,"mat-form-field",14)(17,"mat-label"),f(18,"Fecha de inicio"),s(),v(19,"input",15)(20,"mat-datepicker-toggle",16)(21,"mat-datepicker",null,0),s(),c(23,"mat-form-field",14)(24,"mat-label"),f(25,"Fecha fin"),s(),v(26,"input",15)(27,"mat-datepicker-toggle",16)(28,"mat-datepicker",null,1),s(),c(30,"button",17),b("click",function(){return y(p),C(e.onConsultar())}),c(31,"span"),f(32," Consultar "),s()(),c(33,"button",18),b("click",function(){return y(p),C(e.exportToExcel(e.exportData))}),c(34,"span"),f(35," Exportar "),s()()()(),g(36,Ne,3,5,"div",19)(37,Le,1,0),s()}if(r&2){let p=T(22),m=T(29);a(5),l("subscriptSizing","dynamic"),a(),l("svgIcon","heroicons_solid:magnifying-glass"),a(),l("autocomplete","off")("placeholder","Buscar"),a(2),l("formGroup",e.form),a(4),l("formControlName","idTipoSolicitud"),a(),l("ngIf",U(15,18,e.solicitudes$)),a(5),l("matDatepicker",p)("formControlName","fechaInicio"),a(),l("for",p),a(6),l("matDatepicker",m)("formControlName","fechaFinal"),a(),l("for",m),a(3),l("color","primary"),a(3),l("color","primary")("ngClass",q(20,Ve,e.exportData.length,!e.exportData.length))("disabled",!e.exportData.length),a(3),G(e.data.length>0?36:37)}},dependencies:[Q,oe,we,xe,ne,Fe,Ie,Te,ae,le,ve,ie,te,_e,re,J,K,ge,he,me,de,fe,Se,ye,H]});let t=o;return t})();var St=[{path:"",component:Pe}];export{St as default};
