import{a as Ae}from"./chunk-6QWBF6CM.js";import{a as Oe}from"./chunk-YUIDPSZ5.js";import{a as V}from"./chunk-L2EUJHKC.js";import{a as ze}from"./chunk-W35ES4XE.js";import{a as we}from"./chunk-GXUVHWV6.js";import{a as Te,b as Ne,c as Me}from"./chunk-VMONEH2L.js";import{a as ke}from"./chunk-3L6CDPYN.js";import{a as Ve,b as $e}from"./chunk-5E3BI53K.js";import{a as Fe}from"./chunk-B3262OVV.js";import{a as L}from"./chunk-6IEWE3OU.js";import{a as Be}from"./chunk-24W6POED.js";import{a as Ie}from"./chunk-UFLWJOQO.js";import{a as De}from"./chunk-HKOJEADL.js";import{a as H}from"./chunk-4WJQLHI3.js";import{a as A}from"./chunk-HDKW2ETT.js";import{a as xe}from"./chunk-YRFWKKCQ.js";import{a as ye}from"./chunk-W4ZGSDEU.js";import"./chunk-ZVTEZKTX.js";import{g as fe}from"./chunk-WPQBWK4Z.js";import{a as re,b as me,c as le}from"./chunk-4EGREALI.js";import"./chunk-D266PZ43.js";import{C as Ee,G as k,b as se,e as pe,i as N,j as ce,l as ge,p as ve,q as he,u as Ce,w as Se,x as _e,z as be}from"./chunk-BFUN2CON.js";import{$ as ne,Q as oe,R as ae,ea as M,ja as de}from"./chunk-PKP5UGVL.js";import"./chunk-NSFGWBZH.js";import{a as ue}from"./chunk-X4MAXHGU.js";import{f as Y,g as ee,i as te,j as R,s as ie}from"./chunk-D7SIZTGA.js";import{$b as s,Fb as r,Gb as e,Hb as f,Ib as C,Jb as S,Lb as W,Rb as _,Y as h,_b as P,aa as U,ab as t,ac as b,bb as I,bc as j,fa as G,ga as d,hc as X,ic as T,la as w,q as Q,qc as E,rc as y,sb as u,ub as a,wa as D,xa as F}from"./chunk-KIIQGHZ6.js";import{a as x,d as z}from"./chunk-NEB6MB4Y.js";var Pe=(()=>{let n=class n{constructor(l,o){this._http=l,this.appSettings=o}getTiposEmpresas(){return this._http.get(this.appSettings.tiposEmpresas.url.base)}};n.\u0275fac=function(o){return new(o||n)(G(ie),G(ue))},n.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function Re(i,n){if(i&1&&(r(0,"mat-option",36),s(1),e()),i&2){let p=n.$implicit;a("value",p.id),t(),b(p.nombre)}}function He(i,n){if(i&1&&(C(0),u(1,Re,2,2,"mat-option",35),S()),i&2){let p=n.ngIf;t(),a("ngForOf",p.data)}}function Le(i,n){if(i&1&&(r(0,"mat-option",36),s(1),e()),i&2){let p=n.$implicit;a("value",p.id),t(),b(p.nombre)}}function Ze(i,n){if(i&1&&(C(0),u(1,Le,2,2,"mat-option",35),S()),i&2){let p=n.ngIf;t(),a("ngForOf",p.data)}}function Je(i,n){if(i&1&&(r(0,"mat-option",36),s(1),e()),i&2){let p=n.$implicit;a("value",p.id),t(),b(p.nombre)}}function qe(i,n){if(i&1&&(C(0),u(1,Je,2,2,"mat-option",35),S()),i&2){let p=n.ngIf;t(),a("ngForOf",p.data)}}function Ke(i,n){if(i&1&&(r(0,"mat-option",36),s(1),e()),i&2){let p=n.$implicit;a("value",p.id),t(),b(p.nombre)}}function Qe(i,n){if(i&1&&(C(0),u(1,Ke,2,2,"mat-option",35),S()),i&2){let p=n.ngIf;t(),a("ngForOf",p.data)}}function Ue(i,n){if(i&1&&(r(0,"mat-option",36),s(1),e()),i&2){let p=n.$implicit;a("value",p.id),t(),b(p.nombre)}}function We(i,n){if(i&1&&(C(0),u(1,Ue,2,2,"mat-option",35),S()),i&2){let p=n.ngIf;t(),a("ngForOf",p.data)}}function Xe(i,n){if(i&1&&(r(0,"mat-option",36),s(1),e()),i&2){let p=n.$implicit;a("value",p.id),t(),b(p.nombre)}}function Ye(i,n){if(i&1&&(C(0),u(1,Xe,2,2,"mat-option",35),S()),i&2){let p=n.ngIf;t(),a("ngForOf",p.data)}}var et={validation:!1},Z=(()=>{let n=class n{constructor(){this.fb=d(be),this._locacionService=d(Fe),this.empresasService=d(we),this.dialogRef=d(re),this.fuseService=d(fe),this.estadosDatosService=d(A),this.toasService=d(Ie),this.tiposEmpresaService=d(Pe),this.empresaClienteService=d(V),this.subcripciones=d(Ae),this.bancosServices=d(Oe),this.tipoCuentasService=d(ze),this.bancos$=this.bancosServices.getBancos().pipe(h(l=>{let o=l.data,m=this._matData;o&&!m.edit&&this.form.get("idBanco").setValue(o[0].id)})),this.tipoCuentas$=this.tipoCuentasService.getTipoCuentas().pipe(h(l=>{let o=l.data,m=this._matData;o&&!m.edit&&this.form.get("idTipoCuenta").setValue(o[0].id)})),this.departamentos$=this._locacionService.getDepartamentos().pipe(h(l=>{let o=l.data,m=this._matData;if(o&&!m.edit){this.form.get("idDepartamento").setValue(o[0].id);let c=this.form.get("idDepartamento").value;this.getMunicipios(c)}})),this.empresas$=this.empresasService.getEmpresas(),this.tiposEmpresas$=this.tiposEmpresaService.getTiposEmpresas().pipe(h(l=>{let o=l.data,m=this._matData;o&&!m.edit&&this.form.get("idTipoEmpresa").setValue(o[0].id)})),this.subcripciones$=this.subcripciones.getSubcripciones().pipe(h(l=>{let o=l.data,m=this._matData;o&&!m.edit&&this.form.get("idSubscripcion").setValue(o[0].id)})),this._matData=d(me),this.datePipe=d(R),this.swalService=d(Be)}onSelected(l){let o=l.value;this.getMunicipios(o)}getMunicipios(l){this.municipios$=this._locacionService.getMunicipio(l).pipe(h(o=>{let m=o.data,c=this._matData;m&&!c.edit&&this.form.get("idMunicipio").setValue(m[0].id)}))}ngOnInit(){this.createForm();let l=this._matData;if(l.edit){let o=l.data;this.form.patchValue(o);let{idDepartamento:m,fechaCorte:c,estado:v}=o,g=new Date(c);this.form.patchValue({estado:v=="Activo",fechaCorte:g}),this.municipios$=this._locacionService.getMunicipio(m)}}onSave(){if(this.form.valid)if(this._matData.edit){let o=this.form.getRawValue(),{idDepartamento:c,fechaCobro:v}=o,g=z(o,["idDepartamento","fechaCobro"]),$=this.datePipe.transform(v,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),B=x({fechaCobro:$},g);this.fuseService.open(x({},H)).afterClosed().subscribe(q=>{q==="confirmed"?this.empresaClienteService.putEmpresaCliente(B).subscribe(O=>{this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro actualizado con exito!",timer:4e3}),this.closeDialog()},O=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al actualizar el registro!",timer:4e3})}):this.closeDialog()})}else{let l=this.form.getRawValue(),{idDepartamento:c,idEmpresa:v,fechaCobro:g}=l,$=z(l,["idDepartamento","idEmpresa","fechaCobro"]),B=this.datePipe.transform(g,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),J=x({fechaCobro:B},$);this.fuseService.open(x({},H)).afterClosed().subscribe(O=>{O==="confirmed"?this.empresaClienteService.postEmpresaCliente(J).subscribe(K=>{console.log(K),this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro Creado o Actualizado con Exito.",timer:4e3}),this.closeDialog()},K=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}):this.closeDialog()})}}createForm(){this.form=this.fb.group({id:[null],nit:[""],razonSocial:[""],correo:[""],telefono:[""],direccion:[""],idDepartamento:[""],idTipoEmpresa:[""],idMunicipio:[""],fechaCorte:[""],idSubscripcion:[""],valorSuscripcion:[""],porcCobro:[""],fechaCobro:[""],idTipoCuenta:[""],idBanco:[""],numCuentaBancaria:[""],estado:[!0]})}closeDialog(){this.dialogRef.close()}};n.\u0275fac=function(o){return new(o||n)},n.\u0275cmp=w({type:n,selectors:[["app-form-empresas-clientes"]],standalone:!0,features:[X([{provide:ae,useClass:ke},{provide:oe,useValue:"en-GB"},R,Ve(et)]),T],decls:112,vars:42,consts:[["twoStepToggle",""],["data",""],["picker",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[1,""],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8",3,"formGroup"],[1,"font-bold","mb-4","text-2xl"],[1,"flex","flex-col","sm:flex-row","mb-4"],[1,"fcursor-pointer",3,"click"],[1,"font-medium","leading-6"],[1,"ml-4",3,"color","formControlName"],[1,"flex","flex-col","sm:flex-row","mb-4","gap-2"],["floatLabel","always",1,"w-full"],["matInput","","placeholder","Nit",3,"formControlName"],["matInput","","placeholder","Raz\xF3n social",3,"formControlName"],["matInput","","placeholder","Correo electronico",3,"formControlName"],["matInput","","placeholder","Tel\xE9fono",3,"formControlName"],["placeholder","Departamento",3,"selectionChange","formControlName"],[4,"ngIf"],["placeholder","Ciudad",3,"formControlName"],["matInput","","placeholder","Direcci\xF3n",3,"formControlName"],["placeholder","Tipo de empresa",3,"formControlName"],["placeholder","Subscripci\xF3n",3,"formControlName"],["matInput","","mask","separator.0","thousandSeparator",".","placeholder","Valor subcripci\xF3n",3,"formControlName"],["matInput","","placeholder","Porcentaje %",3,"formControlName"],["matInput","","placeholder","Fecha de cobro",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],[1,"flex","flex-col","sm:flex-row","gap-2.5"],["placeholder","Tipo de cuenta",3,"formControlName"],["placeholder","Bancos",3,"formControlName"],["matInput","","placeholder","N\xFAmero de cuenta",3,"formControlName"],[1,"flex","flex-wrap","justify-end","gap-2.5"],["mat-flat-button","",1,"sm:w-auto","w-full","lg:mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:w-auto","w-full","lg:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(o,m){if(o&1){let c=W();r(0,"div",3)(1,"div",4)(2,"div",5),s(3),e(),r(4,"form",6)(5,"div")(6,"p",7),s(7,"Informaci\xF3n general"),e(),r(8,"div",8)(9,"div",9),_("click",function(){D(c);let g=P(13);return F(g.toggle())}),r(10,"div",10),s(11),e()(),f(12,"mat-slide-toggle",11,0),e(),r(14,"div",12)(15,"mat-form-field",13)(16,"mat-label"),s(17,"Nit"),e(),f(18,"input",14),e(),r(19,"mat-form-field",13)(20,"mat-label"),s(21,"Raz\xF3n social"),e(),f(22,"input",15),e()(),r(23,"div",12)(24,"mat-form-field",13)(25,"mat-label"),s(26,"Correo"),e(),f(27,"input",16),e(),r(28,"mat-form-field",13)(29,"mat-label"),s(30,"Tel\xE9fono"),e(),f(31,"input",17),e()(),r(32,"div",12)(33,"mat-form-field",13)(34,"mat-label"),s(35,"Departamento"),e(),r(36,"mat-select",18,1),_("selectionChange",function(g){return D(c),F(m.onSelected(g))}),u(38,He,2,1,"ng-container",19),E(39,"async"),e()(),r(40,"mat-form-field",13)(41,"mat-label"),s(42,"Ciudad"),e(),r(43,"mat-select",20),u(44,Ze,2,1,"ng-container",19),E(45,"async"),e()()(),r(46,"div",8)(47,"mat-form-field",13)(48,"mat-label"),s(49,"Direcci\xF3n"),e(),f(50,"input",21),e()()(),r(51,"div")(52,"p",7),s(53,"Informaci\xF3n de contrato"),e(),r(54,"div",12)(55,"mat-form-field",13)(56,"mat-label"),s(57,"Tipo de empresa"),e(),r(58,"mat-select",22),u(59,qe,2,1,"ng-container",19),E(60,"async"),e()(),r(61,"mat-form-field",13)(62,"mat-label"),s(63,"Subscripci\xF3n"),e(),r(64,"mat-select",23),u(65,Qe,2,1,"ng-container",19),E(66,"async"),e()()(),r(67,"div",12)(68,"mat-form-field",13)(69,"mat-label"),s(70,"Valor subscripci\xF3n"),e(),f(71,"input",24),e(),r(72,"mat-form-field",13)(73,"mat-label"),s(74,"Porcentaje cobro"),e(),f(75,"input",25),e()(),r(76,"div",8)(77,"mat-form-field",13)(78,"mat-label"),s(79,"Fecha de cobro"),e(),f(80,"input",26)(81,"mat-datepicker-toggle",27)(82,"mat-datepicker",null,2),e()(),r(84,"div")(85,"p",7),s(86,"Informaci\xF3n bancaria"),e(),r(87,"div",28)(88,"mat-form-field",13)(89,"mat-label"),s(90,"Tipo de cuenta"),e(),r(91,"mat-select",29),u(92,We,2,1,"ng-container",19),E(93,"async"),e()(),r(94,"mat-form-field",13)(95,"mat-label"),s(96,"Bancos"),e(),r(97,"mat-select",30),u(98,Ye,2,1,"ng-container",19),E(99,"async"),e()()(),r(100,"div",28)(101,"mat-form-field",13)(102,"mat-label"),s(103,"N\xFAmero de cuenta bancaria"),e(),f(104,"input",31),e()()()(),r(105,"div",32)(106,"button",33),_("click",function(){return D(c),F(m.closeDialog())}),r(107,"span"),s(108," Cancelar "),e()(),r(109,"button",34),_("click",function(){return D(c),F(m.onSave())}),r(110,"span"),s(111," Guardar "),e()()()()()()}if(o&2){let c=P(83);t(3),j(" ",m._matData.edit?"Actualizar empresa":"Agregar empresa"," "),t(),a("formGroup",m.form),t(7),j(" Estado ",m.form.get("estado").value?"Activo":"Inactivo"," "),t(),a("color","primary")("formControlName","estado"),t(6),a("formControlName","nit"),t(4),a("formControlName","razonSocial"),t(5),a("formControlName","correo"),t(4),a("formControlName","telefono"),t(5),a("formControlName","idDepartamento"),t(2),a("ngIf",y(39,30,m.departamentos$)),t(5),a("formControlName","idMunicipio"),t(),a("ngIf",y(45,32,m.municipios$)),t(6),a("formControlName","direccion"),t(8),a("formControlName","idTipoEmpresa"),t(),a("ngIf",y(60,34,m.tiposEmpresas$)),t(5),a("formControlName","idSubscripcion"),t(),a("ngIf",y(66,36,m.subcripciones$)),t(6),a("formControlName","valorSuscripcion"),t(4),a("formControlName","porcCobro"),t(5),a("matDatepicker",c)("formControlName","fechaCobro"),t(),a("for",c),t(10),a("formControlName","idTipoCuenta"),t(),a("ngIf",y(93,38,m.tipoCuentas$)),t(5),a("formControlName","idBanco"),t(),a("ngIf",y(99,40,m.bancos$)),t(6),a("formControlName","numCuentaBancaria"),t(2),a("color","primary"),t(3),a("color","primary")}},dependencies:[M,N,k,se,Ee,Ce,ge,ve,he,Se,_e,te,ne,xe,Y,ee,Ne,Me,Te,ce,pe,$e,ye],styles:[".custom-dialog-container{width:100%}@media (min-width: 1280px){  .custom-dialog-container{width:50%}}"]});let i=n;return i})();var je=(()=>{let n=class n{constructor(l,o,m){this._matDialog=l,this.empresaClienteService=o,this.estadoDatosService=m,this.data=[],this.columns=["Nit","Razon social","Correo","Telefono","Direccion","Estado"],this.columnPropertyMap={Nit:"nit","Razon social":"razonSocial",Correo:"correo",Telefono:"telefono",Direccion:"direccion",Estado:"estado"},this.buttons=[{label:"Edit",icon:"edit",action:c=>{console.log("Editing",c),this.selectedData=c,this.onEdit()}}]}onNew(){this._matDialog.open(Z,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",disableClose:!0,panelClass:"custom-dialog-container"})}onEdit(){this._matDialog.open(Z,{autoFocus:!1,data:{edit:!0,data:this.selectedData},maxHeight:"90vh",disableClose:!0,panelClass:"custom-dialog-container"})}getEmpresas(){this.subcription$=this.empresaClienteService.getEmpresas().pipe(Q(l=>(l.data.forEach(o=>{o.estado?o.estado=L.ACTIVO:o.estado=L.INACTIVO}),l))).subscribe(l=>{this.data=l.data})}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(o=>{o&&this.getEmpresas()})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getEmpresas(),this.listenGrid()}};n.\u0275fac=function(o){return new(o||n)(I(le),I(V),I(A))},n.\u0275cmp=w({type:n,selectors:[["app-grid-empresas-clientes"]],standalone:!0,features:[T],decls:15,vars:11,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],["mat-flat-button","",1,"mt-2","w-full","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold","sm:ml-4","sm:mt-0","sm:w-auto",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(o,m){o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),s(3,"Clientes - Aliados"),e(),r(4,"div",3)(5,"mat-form-field",4),f(6,"mat-icon",5)(7,"input",6),e(),r(8,"button",7),_("click",function(){return m.onNew()}),f(9,"mat-icon",8),r(10,"span",9),s(11,"Agregar"),e()()()(),r(12,"div",10)(13,"div",11),f(14,"app-custom-table",12),e()()()),o&2&&(t(5),a("subscriptSizing","dynamic"),t(),a("svgIcon","heroicons_solid:magnifying-glass"),t(),a("autocomplete","off")("placeholder","Buscar"),t(),a("color","primary"),t(),a("svgIcon","heroicons_outline:plus"),t(5),a("columns",m.columns)("displayedColumns",m.columns)("columnPropertyMap",m.columnPropertyMap)("data",m.data)("buttons",m.buttons))},dependencies:[M,N,de,k,De]});let i=n;return i})();var Qt=[{path:"",component:je}];export{Qt as default};
