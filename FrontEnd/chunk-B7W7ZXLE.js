import{a as Ee}from"./chunk-IM3AUN4N.js";import{a as Ie}from"./chunk-E2UHK2JZ.js";import{a as w}from"./chunk-FAEUQIFQ.js";import{a as Fe,b as T}from"./chunk-P4PAYY2C.js";import{a as _e,b as xe,c as Te}from"./chunk-LZ3ZEVTF.js";import{a as we}from"./chunk-DTORAJAR.js";import{a as Se}from"./chunk-3R6HD5RM.js";import{a as ge}from"./chunk-CJO6YW5P.js";import"./chunk-7YBFULQ5.js";import{g as ie,h as ye}from"./chunk-QVE5MGEQ.js";import{C as ue,E as Ce,F as he,J as be,b as ee,e as te,i as oe,l as se,n as x,p as le,q as ce,s as me,u as de,x as pe,y as fe}from"./chunk-4PVPKBBG.js";import{e as ne}from"./chunk-KAEQCOKJ.js";import"./chunk-YKJB7XET.js";import{h as Z}from"./chunk-FUOI65R5.js";import{a as ve}from"./chunk-73F67TFK.js";import"./chunk-XTYNXB3F.js";import"./chunk-PA2SJPJO.js";import{$a as g,Ad as W,Eb as I,Fb as f,Gb as L,Ka as a,Md as Y,Ob as X,Pb as O,Sb as B,Xb as $,Yb as q,Z as D,bb as r,fe as ae,ga as u,ib as V,ka as P,ke as re,mb as l,nb as n,ob as S,pb as R,pc as z,q as M,qb as G,qc as U,rc as H,sb as N,ua as y,uc as J,va as v,vb as _,vc as E,xb as A,xc as K,yc as j,zd as Q}from"./chunk-ODJKW74N.js";import{a as F,d as k}from"./chunk-NEB6MB4Y.js";var ke=(o,s)=>({"bg-green-700":o,"bg-credigray-100":s});function Me(o,s){if(o&1&&(l(0,"mat-option",21),f(1),n()),o&2){let p=s.$implicit;r("value",p.id),a(),L(p.nombre)}}function De(o,s){if(o&1&&(R(0),g(1,Me,2,2,"mat-option",20),G()),o&2){let p=s.ngIf;a(),r("ngForOf",p.data)}}function Pe(o,s){if(o&1&&(l(0,"div",19)(1,"div",22),S(2,"app-custom-table",23),n()()),o&2){let p=A();a(2),r("columns",p.columns)("displayedColumns",p.columns)("columnPropertyMap",p.columnPropertyMap)("data",p.data)("searchTerm",p.searchTerm)}}function Ve(o,s){o&1&&(l(0,"div",24)(1,"div",25)(2,"fuse-alert",26)(3,"span",27),f(4,"Informaci\xF3n"),n(),f(5," No hay informaci\xF3n hasta el momento. "),n()()()),o&2&&(a(2),r("type","info")("appearance","outline"))}function Re(o,s){o&1&&g(0,Ve,6,2,"ng-template")}var je=(()=>{let s=class s{constructor(){this.searchTerm="",this.fb=u(ue),this.reportesService=u(Ee),this.datePipe=u(E),this.estados=new me([""]),this.detalleConsumoService=u(Ie),this.detalleConsumo$=this.detalleConsumoService.getEstadoCobros().pipe(D(c=>{let i=c.data;i&&(i.unshift({id:"0",nombre:"Todos"}),this.form.get("idEstadoCredito").setValue(i[0].id))})),this.data=[],this.columns=["Trabajador","Identificaci\xF3n","Tipo de contrato","Empresa","Inicio de contrato","Fin de contrato","Cantidad de cuotas","Fecha de cobro","Valor cuota","Valor sin intereses","Intereses ganados"],this.columnPropertyMap={Trabajador:"nombreTrabajador",Identificaci\u00F3n:"documetoTrabajador","Tipo de contrato":"tipoContratoTrabajador",Empresa:"nombreSubEmpresa","Inicio de contrato":"fechaInicioContratoTrabajador","Fin de contrato":"fechaFinContratoTrabajador","Cantidad de cuotas":"numCuota","Fecha de cobro":"fechaCobro","Valor cuota":"montoCuota","Valor sin intereses":"montoCuotaSinIntereses","Intereses ganados":"interesesGanados"},this.aesEncriptService=u(ne),this.currencyPipe=u(j),this.exportData=[],this.fuseService=u(ie)}onSearch(c){let i=c.target;this.searchTerm=i.value.trim().toLowerCase()}onSelect(c){let i=c.value}createForm(){this.form=this.fb.group({idEstadoCredito:["",x.required],fechaInicio:["",x.required],fechaFinal:["",x.required]})}ngOnInit(){this.createForm()}onConsultar(){if(this.form.valid){let c=this.form.getRawValue(),{fechaInicio:i,fechaFinal:e}=c,m=k(c,["fechaInicio","fechaFinal"]),d=this.datePipe.transform(i,"yyyy-MM-dd"),b=this.datePipe.transform(e,"yyyy-MM-dd"),C=F({fechaInicio:d,fechaFinal:b},m);C.idEstadoCredito=="0"&&(C={fechaInicio:C.fechaInicio,fechaFinal:C.fechaFinal,idEstadoCredito:""}),console.log(C),this.reportesService.getReporteCobros(C).pipe(M(h=>(h.data.forEach(t=>{t.fechaCobro=this.datePipe.transform(t.fechaCobro,"dd/MM/yyyy"),t.fechaInicioContratoTrabajador=this.datePipe.transform(t.fechaInicioContratoTrabajador,"dd/MM/yyyy"),t.fechaFinContratoTrabajador=this.datePipe.transform(t.fechaFinContratoTrabajador,"dd/MM/yyyy"),t.montoCuota&&(t.montoCuota=this.aesEncriptService.decrypt(t.montoCuota)),t.montoCuotaSinIntereses&&(t.montoCuotaSinIntereses=this.aesEncriptService.decrypt(t.montoCuotaSinIntereses)),t.interesesGanados&&(t.interesesGanados=this.aesEncriptService.decrypt(t.interesesGanados)),t.montoCuota=this.currencyPipe.transform(t.montoCuota,"USD","symbol","1.2-2"),t.montoCuotaSinIntereses=this.currencyPipe.transform(t.montoCuotaSinIntereses,"USD","symbol","1.2-2"),t.interesesGanados=parseFloat(t.interesesGanados.replace(",",".")),t.interesesGanados=this.currencyPipe.transform(t.interesesGanados,"USD","symbol","1.2-2")}),h))).subscribe(h=>{h.data?(this.data=h.data,this.convertDataExportFijos(h.data)):this.data=[]})}}convertDataExportFijos(c){let i=c.map(e=>({Trabajador:e.nombreTrabajador,Identificaci\u00F3n:e.documetoTrabajador,TipodeContrato:e.tipoContratoTrabajador,Empresa:e.nombreSubEmpresa,Iniciodecontrato:e.fechaInicioContratoTrabajador,Findecontrato:e.fechaFinContratoTrabajador,CantidaddeCuotas:e.numCuota,FechaCobro:e.fechaCobro,ValorCuota:w(e.montoCuota),ValorSinIntereses:w(e.montoCuotaSinIntereses),InteresesGanados:w(e.interesesGanados)}));this.exportData=i}exportToExcel(c){this.fuseService.open(F({},ye)).afterClosed().subscribe(e=>{if(e==="confirmed"){let m=T.json_to_sheet(c),d=T.book_new();T.book_append_sheet(d,m,"Sheet1"),Fe(d,`Reporte cobros trabajadores${this.datePipe.transform(new Date,"dd/MM/yyyy")}.xlsx`)}})}};s.\u0275fac=function(i){return new(i||s)},s.\u0275cmp=P({type:s,selectors:[["app-reporte-cobro-trabajadores"]],standalone:!0,features:[X([{provide:W,useClass:we},{provide:Q,useValue:"en-GB"},E,j,K]),O],decls:38,vars:23,consts:[["inicioPicker",""],["finalPicker",""],["cdkScrollable","",1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],[1,"px-6","border-b","mt-6","w-full","shrink-0","sm:mt-0","sm:space-x-2","lg:w-full"],[1,"flex","flex-col","sm:flex-row","gap-2.5",3,"formGroup"],[1,"w-full","sm:w-1/2"],[3,"selectionChange","formControlName"],[4,"ngIf"],["floatLabel","always",1,"w-full","sm:w-1/2"],["matInput","","placeholder","dd/mm/yyyy",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],["mat-flat-button","",1,"sm:w-1/6","w-full","sm:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:sm:w-1/6","w-full","sm:mt-6","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color","ngClass","disabled"],[1,"flex","flex-auto","overflow-hidden"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","searchTerm"],[1,"inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-4","sm:p-2","print:p-0","w-full"],[3,"type","appearance"],["fuseAlertTitle",""]],template:function(i,e){if(i&1){let m=N();l(0,"div",2)(1,"div",3)(2,"div",4),f(3,"Reporte de Cobros Trabajadores"),n(),l(4,"div",5)(5,"mat-form-field",6),S(6,"mat-icon",7),l(7,"input",8),_("input",function(b){return y(m),v(e.onSearch(b))}),n()()()(),l(8,"div",9)(9,"form",10)(10,"mat-form-field",11)(11,"mat-label"),f(12,"Estados"),n(),l(13,"mat-select",12),_("selectionChange",function(b){return y(m),v(e.onSelect(b))}),g(14,De,2,1,"ng-container",13),$(15,"async"),n()(),l(16,"mat-form-field",14)(17,"mat-label"),f(18,"Fecha de inicio"),n(),S(19,"input",15)(20,"mat-datepicker-toggle",16)(21,"mat-datepicker",null,0),n(),l(23,"mat-form-field",14)(24,"mat-label"),f(25,"Fecha fin"),n(),S(26,"input",15)(27,"mat-datepicker-toggle",16)(28,"mat-datepicker",null,1),n(),l(30,"button",17),_("click",function(){return y(m),v(e.onConsultar())}),l(31,"span"),f(32," Consultar "),n()(),l(33,"button",18),_("click",function(){return y(m),v(e.exportToExcel(e.exportData))}),l(34,"span"),f(35," Exportar "),n()()()(),g(36,Pe,3,5,"div",19)(37,Re,1,0),n()}if(i&2){let m=I(22),d=I(29);a(5),r("subscriptSizing","dynamic"),a(),r("svgIcon","heroicons_solid:magnifying-glass"),a(),r("autocomplete","off")("placeholder","Buscar"),a(2),r("formGroup",e.form),a(4),r("formControlName","idEstadoCredito"),a(),r("ngIf",q(15,18,e.detalleConsumo$)),a(5),r("matDatepicker",m)("formControlName","fechaInicio"),a(),r("for",m),a(6),r("matDatepicker",d)("formControlName","fechaFinal"),a(),r("for",d),a(3),r("color","primary"),a(3),r("color","primary")("ngClass",B(20,ke,e.exportData.length,!e.exportData.length))("disabled",!e.exportData.length),a(3),V(e.data.length>0?36:37)}},dependencies:[J,Z,Se,Ce,de,se,le,ce,ve,ae,_e,xe,Te,oe,re,be,ee,Y,ge,te,U,H,he,pe,fe,z]});let o=s;return o})();var mt=[{path:"",component:je}];export{mt as default};
