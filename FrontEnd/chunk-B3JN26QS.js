import{a as Oe}from"./chunk-7AUBK6U6.js";import{a as j}from"./chunk-XOYVXEWN.js";import{a as je}from"./chunk-BH5CHIMT.js";import{a as Ae}from"./chunk-GFRFA6UA.js";import{a as we}from"./chunk-KH6A7Z26.js";import{a as Ne,b as Me,c as ke}from"./chunk-QODY67HI.js";import{a as Ve,b as $e}from"./chunk-SY7XYXPC.js";import{a as Ie}from"./chunk-NWZCBZI3.js";import{a as q}from"./chunk-6IEWE3OU.js";import{a as Be}from"./chunk-TKUQ2GK7.js";import{a as Fe}from"./chunk-3CZSUSTM.js";import{a as Te}from"./chunk-BP3ZUNQJ.js";import{a as J}from"./chunk-4WJQLHI3.js";import{a as O}from"./chunk-LDCTOPX4.js";import{a as De}from"./chunk-PVGNXBQP.js";import{a as xe}from"./chunk-TNSR37VG.js";import"./chunk-NWLCDP4D.js";import{g as ge}from"./chunk-ZHUIBFOH.js";import{a as se,b as le,c as pe}from"./chunk-J6ZY6K5Q.js";import"./chunk-VY5HLTY4.js";import{C as ye,G as B,b as ce,e as de,i as A,j as fe,l as ve,p as he,q as Ce,u as Se,w as be,x as _e,z as Ee}from"./chunk-SXAYB37M.js";import{$ as me,Q as ne,R as re,ea as V,ja as ue}from"./chunk-4L5SMXVA.js";import"./chunk-X53G34JD.js";import{a as $}from"./chunk-DGQEWR53.js";import{f as ie,g as oe,i as ae,j as Z,s as k}from"./chunk-X7QBE67O.js";import{$a as N,$b as L,Db as r,Eb as o,Fb as f,Gb as C,Hb as S,Jb as ee,Pb as b,Y as h,Yb as H,Zb as l,_a as a,_b as _,aa as w,fa as x,fc as te,ga as d,gc as M,la as T,oc as E,pc as y,q as Y,qb as u,sb as n,va as F,wa as I}from"./chunk-UANZ7CBN.js";import{a as D,d as R}from"./chunk-NEB6MB4Y.js";var ze=(()=>{let e=class e{constructor(m,i){this._http=m,this.appSettings=i}getTiposEmpresas(){return this._http.get(this.appSettings.tiposEmpresas.url.base)}};e.\u0275fac=function(i){return new(i||e)(x(k),x($))},e.\u0275prov=w({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ge=(()=>{let e=class e{constructor(m,i){this._http=m,this.appSettingService=i}getSubcripciones(){return this._http.get(this.appSettingService.subcripciones.url.base)}getSubcripcion(m){return this._http.get(`${this.appSettingService.subcripciones.url.base}`)}};e.\u0275fac=function(i){return new(i||e)(x(k),x($))},e.\u0275prov=w({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Le(t,e){if(t&1&&(r(0,"mat-option",36),l(1),o()),t&2){let p=e.$implicit;n("value",p.id),a(),_(p.nombre)}}function Ze(t,e){if(t&1&&(C(0),u(1,Le,2,2,"mat-option",35),S()),t&2){let p=e.ngIf;a(),n("ngForOf",p.data)}}function Je(t,e){if(t&1&&(r(0,"mat-option",36),l(1),o()),t&2){let p=e.$implicit;n("value",p.id),a(),_(p.nombre)}}function qe(t,e){if(t&1&&(C(0),u(1,Je,2,2,"mat-option",35),S()),t&2){let p=e.ngIf;a(),n("ngForOf",p.data)}}function Ke(t,e){if(t&1&&(r(0,"mat-option",36),l(1),o()),t&2){let p=e.$implicit;n("value",p.id),a(),_(p.nombre)}}function Qe(t,e){if(t&1&&(C(0),u(1,Ke,2,2,"mat-option",35),S()),t&2){let p=e.ngIf;a(),n("ngForOf",p.data)}}function Ue(t,e){if(t&1&&(r(0,"mat-option",36),l(1),o()),t&2){let p=e.$implicit;n("value",p.id),a(),_(p.nombre)}}function We(t,e){if(t&1&&(C(0),u(1,Ue,2,2,"mat-option",35),S()),t&2){let p=e.ngIf;a(),n("ngForOf",p.data)}}function Xe(t,e){if(t&1&&(r(0,"mat-option",36),l(1),o()),t&2){let p=e.$implicit;n("value",p.id),a(),_(p.nombre)}}function Ye(t,e){if(t&1&&(C(0),u(1,Xe,2,2,"mat-option",35),S()),t&2){let p=e.ngIf;a(),n("ngForOf",p.data)}}function et(t,e){if(t&1&&(r(0,"mat-option",36),l(1),o()),t&2){let p=e.$implicit;n("value",p.id),a(),_(p.nombre)}}function tt(t,e){if(t&1&&(C(0),u(1,et,2,2,"mat-option",35),S()),t&2){let p=e.ngIf;a(),n("ngForOf",p.data)}}var it={validation:!1},Q=(()=>{let e=class e{constructor(){this.fb=d(Ee),this._locacionService=d(Ie),this.empresasService=d(we),this.dialogRef=d(se),this.fuseService=d(ge),this.estadosDatosService=d(O),this.toasService=d(Te),this.tiposEmpresaService=d(ze),this.empresaClienteService=d(j),this.subcripciones=d(Ge),this.bancosServices=d(Oe),this.tipoCuentasService=d(je),this.bancos$=this.bancosServices.getBancos().pipe(h(m=>{let i=m.data,s=this._matData;i&&!s.edit&&this.form.get("idBanco").setValue(i[0].id)})),this.tipoCuentas$=this.tipoCuentasService.getTipoCuentas().pipe(h(m=>{let i=m.data,s=this._matData;i&&!s.edit&&this.form.get("idTipoCuenta").setValue(i[0].id)})),this.departamentos$=this._locacionService.getDepartamentos().pipe(h(m=>{let i=m.data,s=this._matData;if(i&&!s.edit){this.form.get("idDepartamento").setValue(i[0].id);let c=this.form.get("idDepartamento").value;this.getMunicipios(c)}})),this.empresas$=this.empresasService.getEmpresas(),this.tiposEmpresas$=this.tiposEmpresaService.getTiposEmpresas().pipe(h(m=>{let i=m.data,s=this._matData;i&&!s.edit&&this.form.get("idTipoEmpresa").setValue(i[0].id)})),this.subcripciones$=this.subcripciones.getSubcripciones().pipe(h(m=>{let i=m.data,s=this._matData;i&&!s.edit&&this.form.get("idSubscripcion").setValue(i[0].id)})),this._matData=d(le),this.datePipe=d(Z),this.swalService=d(Be)}onSelected(m){let i=m.value;this.getMunicipios(i)}getMunicipios(m){this.municipios$=this._locacionService.getMunicipio(m).pipe(h(i=>{let s=i.data,c=this._matData;s&&!c.edit&&this.form.get("idMunicipio").setValue(s[0].id)}))}ngOnInit(){this.createForm();let m=this._matData;if(m.edit){let i=m.data;this.form.patchValue(i);let{idDepartamento:s,fechaCorte:c,estado:v}=i,g=new Date(c);this.form.patchValue({estado:v=="Activo",fechaCorte:g}),this.municipios$=this._locacionService.getMunicipio(s)}}onSave(){if(this.form.valid)if(this._matData.edit){let i=this.form.getRawValue(),{idDepartamento:c,fechaCobro:v}=i,g=R(i,["idDepartamento","fechaCobro"]),z=this.datePipe.transform(v,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),G=D({fechaCobro:z},g);this.fuseService.open(D({},J)).afterClosed().subscribe(W=>{W==="confirmed"?this.empresaClienteService.putEmpresaCliente(G).subscribe(P=>{this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro actualizado con exito!",timer:4e3}),this.closeDialog()},P=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al actualizar el registro!",timer:4e3})}):this.closeDialog()})}else{let m=this.form.getRawValue(),{idDepartamento:c,idEmpresa:v,fechaCobro:g}=m,z=R(m,["idDepartamento","idEmpresa","fechaCobro"]),G=this.datePipe.transform(g,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),U=D({fechaCobro:G},z);this.fuseService.open(D({},J)).afterClosed().subscribe(P=>{P==="confirmed"?this.empresaClienteService.postEmpresaCliente(U).subscribe(X=>{console.log(X),this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro Creado o Actualizado con Exito.",timer:4e3}),this.closeDialog()},X=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}):this.closeDialog()})}}createForm(){this.form=this.fb.group({id:[null],nit:[""],razonSocial:[""],correo:[""],telefono:[""],direccion:[""],idDepartamento:[""],idTipoEmpresa:[""],idMunicipio:[""],fechaCorte:[""],idSubscripcion:[""],valorSuscripcion:[""],porcCobro:[""],fechaCobro:[""],idTipoCuenta:[""],idBanco:[""],numCuentaBancaria:[""],estado:[!0]})}closeDialog(){this.dialogRef.close()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=T({type:e,selectors:[["app-form-empresas-clientes"]],standalone:!0,features:[te([{provide:re,useClass:Ae},{provide:ne,useValue:"en-GB"},Z,Ve(it)]),M],decls:112,vars:42,consts:[["twoStepToggle",""],["data",""],["picker",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[1,""],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8",3,"formGroup"],[1,"font-bold","mb-4","text-2xl"],[1,"flex","flex-col","sm:flex-row","mb-4"],[1,"fcursor-pointer",3,"click"],[1,"font-medium","leading-6"],[1,"ml-4",3,"color","formControlName"],[1,"flex","flex-col","sm:flex-row","mb-4","gap-2"],["floatLabel","always",1,"w-full"],["matInput","","placeholder","Nit",3,"formControlName"],["matInput","","placeholder","Raz\xF3n social",3,"formControlName"],["matInput","","placeholder","Correo electronico",3,"formControlName"],["matInput","","placeholder","Tel\xE9fono",3,"formControlName"],["placeholder","Departamento",3,"selectionChange","formControlName"],[4,"ngIf"],["placeholder","Ciudad",3,"formControlName"],["matInput","","placeholder","Direcci\xF3n",3,"formControlName"],["placeholder","Tipo de empresa",3,"formControlName"],["placeholder","Subscripci\xF3n",3,"formControlName"],["matInput","","mask","separator.0","thousandSeparator",".","placeholder","Valor subcripci\xF3n",3,"formControlName"],["matInput","","placeholder","Porcentaje %",3,"formControlName"],["matInput","","placeholder","Fecha de cobro",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],[1,"flex","flex-col","sm:flex-row","gap-2.5"],["placeholder","Tipo de cuenta",3,"formControlName"],["placeholder","Bancos",3,"formControlName"],["matInput","","placeholder","N\xFAmero de cuenta",3,"formControlName"],[1,"flex","flex-wrap","justify-end","gap-2.5"],["mat-flat-button","",1,"sm:w-auto","w-full","lg:mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:w-auto","w-full","lg:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,s){if(i&1){let c=ee();r(0,"div",3)(1,"div",4)(2,"div",5),l(3),o(),r(4,"form",6)(5,"div")(6,"p",7),l(7,"Informaci\xF3n general"),o(),r(8,"div",8)(9,"div",9),b("click",function(){F(c);let g=H(13);return I(g.toggle())}),r(10,"div",10),l(11),o()(),f(12,"mat-slide-toggle",11,0),o(),r(14,"div",12)(15,"mat-form-field",13)(16,"mat-label"),l(17,"Nit"),o(),f(18,"input",14),o(),r(19,"mat-form-field",13)(20,"mat-label"),l(21,"Raz\xF3n social"),o(),f(22,"input",15),o()(),r(23,"div",12)(24,"mat-form-field",13)(25,"mat-label"),l(26,"Correo"),o(),f(27,"input",16),o(),r(28,"mat-form-field",13)(29,"mat-label"),l(30,"Tel\xE9fono"),o(),f(31,"input",17),o()(),r(32,"div",12)(33,"mat-form-field",13)(34,"mat-label"),l(35,"Departamento"),o(),r(36,"mat-select",18,1),b("selectionChange",function(g){return F(c),I(s.onSelected(g))}),u(38,Ze,2,1,"ng-container",19),E(39,"async"),o()(),r(40,"mat-form-field",13)(41,"mat-label"),l(42,"Ciudad"),o(),r(43,"mat-select",20),u(44,qe,2,1,"ng-container",19),E(45,"async"),o()()(),r(46,"div",8)(47,"mat-form-field",13)(48,"mat-label"),l(49,"Direcci\xF3n"),o(),f(50,"input",21),o()()(),r(51,"div")(52,"p",7),l(53,"Informaci\xF3n de contrato"),o(),r(54,"div",12)(55,"mat-form-field",13)(56,"mat-label"),l(57,"Tipo de empresa"),o(),r(58,"mat-select",22),u(59,Qe,2,1,"ng-container",19),E(60,"async"),o()(),r(61,"mat-form-field",13)(62,"mat-label"),l(63,"Subscripci\xF3n"),o(),r(64,"mat-select",23),u(65,We,2,1,"ng-container",19),E(66,"async"),o()()(),r(67,"div",12)(68,"mat-form-field",13)(69,"mat-label"),l(70,"Valor subscripci\xF3n"),o(),f(71,"input",24),o(),r(72,"mat-form-field",13)(73,"mat-label"),l(74,"Porcentaje cobro"),o(),f(75,"input",25),o()(),r(76,"div",8)(77,"mat-form-field",13)(78,"mat-label"),l(79,"Fecha de cobro"),o(),f(80,"input",26)(81,"mat-datepicker-toggle",27)(82,"mat-datepicker",null,2),o()(),r(84,"div")(85,"p",7),l(86,"Informaci\xF3n bancaria"),o(),r(87,"div",28)(88,"mat-form-field",13)(89,"mat-label"),l(90,"Tipo de cuenta"),o(),r(91,"mat-select",29),u(92,Ye,2,1,"ng-container",19),E(93,"async"),o()(),r(94,"mat-form-field",13)(95,"mat-label"),l(96,"Bancos"),o(),r(97,"mat-select",30),u(98,tt,2,1,"ng-container",19),E(99,"async"),o()()(),r(100,"div",28)(101,"mat-form-field",13)(102,"mat-label"),l(103,"N\xFAmero de cuenta bancaria"),o(),f(104,"input",31),o()()()(),r(105,"div",32)(106,"button",33),b("click",function(){return F(c),I(s.closeDialog())}),r(107,"span"),l(108," Cancelar "),o()(),r(109,"button",34),b("click",function(){return F(c),I(s.onSave())}),r(110,"span"),l(111," Guardar "),o()()()()()()}if(i&2){let c=H(83);a(3),L(" ",s._matData.edit?"Actualizar empresa":"Agregar empresa"," "),a(),n("formGroup",s.form),a(7),L(" Estado ",s.form.get("estado").value?"Activo":"Inactivo"," "),a(),n("color","primary")("formControlName","estado"),a(6),n("formControlName","nit"),a(4),n("formControlName","razonSocial"),a(5),n("formControlName","correo"),a(4),n("formControlName","telefono"),a(5),n("formControlName","idDepartamento"),a(2),n("ngIf",y(39,30,s.departamentos$)),a(5),n("formControlName","idMunicipio"),a(),n("ngIf",y(45,32,s.municipios$)),a(6),n("formControlName","direccion"),a(8),n("formControlName","idTipoEmpresa"),a(),n("ngIf",y(60,34,s.tiposEmpresas$)),a(5),n("formControlName","idSubscripcion"),a(),n("ngIf",y(66,36,s.subcripciones$)),a(6),n("formControlName","valorSuscripcion"),a(4),n("formControlName","porcCobro"),a(5),n("matDatepicker",c)("formControlName","fechaCobro"),a(),n("for",c),a(10),n("formControlName","idTipoCuenta"),a(),n("ngIf",y(93,38,s.tipoCuentas$)),a(5),n("formControlName","idBanco"),a(),n("ngIf",y(99,40,s.bancos$)),a(6),n("formControlName","numCuentaBancaria"),a(2),n("color","primary"),a(3),n("color","primary")}},dependencies:[V,A,B,ce,ye,Se,ve,he,Ce,be,_e,ae,me,De,ie,oe,Me,ke,Ne,fe,de,$e,xe],styles:[".custom-dialog-container{width:100%}@media (min-width: 1280px){  .custom-dialog-container{width:50%}}"]});let t=e;return t})();var Pe=(()=>{let e=class e{constructor(m,i,s){this._matDialog=m,this.empresaClienteService=i,this.estadoDatosService=s,this.data=[],this.columns=["Nit","Razon social","Correo","Telefono","Direccion","Estado"],this.columnPropertyMap={Nit:"nit","Razon social":"razonSocial",Correo:"correo",Telefono:"telefono",Direccion:"direccion",Estado:"estado"},this.buttons=[{label:"Edit",icon:"edit",action:c=>{console.log("Editing",c),this.selectedData=c,this.onEdit()}}]}onNew(){this._matDialog.open(Q,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",disableClose:!0,panelClass:"custom-dialog-container"})}onEdit(){this._matDialog.open(Q,{autoFocus:!1,data:{edit:!0,data:this.selectedData},maxHeight:"90vh",disableClose:!0,panelClass:"custom-dialog-container"})}getEmpresas(){this.subcription$=this.empresaClienteService.getEmpresas().pipe(Y(m=>(m.data.forEach(i=>{i.estado?i.estado=q.ACTIVO:i.estado=q.INACTIVO}),m))).subscribe(m=>{this.data=m.data})}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(i=>{i&&this.getEmpresas()})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getEmpresas(),this.listenGrid()}};e.\u0275fac=function(i){return new(i||e)(N(pe),N(j),N(O))},e.\u0275cmp=T({type:e,selectors:[["app-grid-empresas-clientes"]],standalone:!0,features:[M],decls:15,vars:11,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],["mat-flat-button","",1,"mt-2","w-full","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold","sm:ml-4","sm:mt-0","sm:w-auto",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(i,s){i&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),l(3,"Clientes - Aliados"),o(),r(4,"div",3)(5,"mat-form-field",4),f(6,"mat-icon",5)(7,"input",6),o(),r(8,"button",7),b("click",function(){return s.onNew()}),f(9,"mat-icon",8),r(10,"span",9),l(11,"Agregar"),o()()()(),r(12,"div",10)(13,"div",11),f(14,"app-custom-table",12),o()()()),i&2&&(a(5),n("subscriptSizing","dynamic"),a(),n("svgIcon","heroicons_solid:magnifying-glass"),a(),n("autocomplete","off")("placeholder","Buscar"),a(),n("color","primary"),a(),n("svgIcon","heroicons_outline:plus"),a(5),n("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("buttons",s.buttons))},dependencies:[V,A,ue,B,Fe]});let t=e;return t})();var Ut=[{path:"",component:Pe}];export{Ut as default};
