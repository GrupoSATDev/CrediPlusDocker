import{a as g,b as L,c as Pe,d as Re,e as je}from"./chunk-LZSQI2LX.js";import{a as Me,b as Te,c as Ge,d as Ne}from"./chunk-Y4MQD3WA.js";import{a as H}from"./chunk-PWHPCRCN.js";import{a as Q}from"./chunk-6IEWE3OU.js";import{a as Fe}from"./chunk-LBLJGZM7.js";import{a as j,b as we,c as T,d as W}from"./chunk-JM6PAC2Q.js";import"./chunk-55LFJ2HF.js";import"./chunk-CHOSRW5W.js";import{a as fe,b as be,c as ge,k as B}from"./chunk-GIPKHLVS.js";import{h as ue}from"./chunk-7U4JZNVG.js";import{B as Ie,E as Ae,I as z,b as he,i as $,l as xe,n as _,p as Ce,q as ye,t as Ee,w as _e,x as De}from"./chunk-CURMXRYA.js";import{ea as M,fa as ve,ja as q}from"./chunk-DARKUWJB.js";import"./chunk-EENLYY7H.js";import{a as Se}from"./chunk-EJW5UVWF.js";import{b as me,d as O,e as pe}from"./chunk-DJAHQBBJ.js";import{g as k,j as P,l as R,r as ce}from"./chunk-NP3GUERB.js";import{$ as te,$b as ie,Cb as i,Db as o,Eb as u,Fb as I,Gb as A,Ib as F,Ob as E,Qb as f,Yb as r,Za as n,Zb as C,_a as V,ac as oe,bc as re,cc as ae,dc as ne,ea as J,ec as w,fa as p,fc as se,ka as D,mc as K,nc as le,oc as de,pb as b,q as N,rb as d,ua as S,va as x}from"./chunk-32HXX3OB.js";import{a as y,d as U}from"./chunk-NEB6MB4Y.js";var G=(()=>{let c=class c{constructor(a,e){this._http=a,this.appSettings=e}getSolicitudes(a){return this._http.get(`${this.appSettings.solicitudesCreditos.url.base}/${a}`)}getSolicitud(a){return this._http.get(`${this.appSettings.solicitudesCreditos.url.base}/${a}`)}postSolicitudes(a){return delete a.id,this._http.post(this.appSettings.solicitudesCreditos.url.base,a)}putSolicitudes(a){let e=a.id;return delete a.id,this._http.put(`${this.appSettings.solicitudesCreditos.url.base}/${e}`,a)}patchSolicitud(a){let e=a.id;delete a.id;let{idEstado:t}=a;return this._http.patch(`${this.appSettings.solicitudesCreditos.url.base}/${e}?idEstado=${t}`,{})}};c.\u0275fac=function(e){return new(e||c)(J(ce),J(Se))},c.\u0275prov=te({token:c,factory:c.\u0275fac,providedIn:"root"});let l=c;return l})();var Ve=(()=>{let c=class c{constructor(){this.fb=p(Ie),this.dialogRef=p(fe),this.fuseService=p(B),this.estadosDatosService=p(T),this.toasService=p(W),this.empleadoService=p(H),this._matData=p(be),this.solicitudService=p(G)}ngOnInit(){this.initialInfoForm=this.fb.group({}),this.firstFormGroup=this.fb.group({nombreCompleto:[{value:"",disabled:!0},_.required],numDoc:[{value:"",disabled:!0},_.required],direccion:[{value:"",disabled:!0},_.required],idMunicipio:[{value:"",disabled:!0},_.required],correo:[{value:"",disabled:!0},_.required]}),this.secondFormGroup=this.fb.group({cupo:["",[_.required]],observacion:[""]}),this.createForm();let a=this._matData;if(a.edit){let t=a.data;this.form.patchValue(t)}let e="c6d6b3a7-799f-42eb-8868-e069df989b11";this.subcripstion$=this.empleadoService.getEmpleado(e).pipe(N(t=>(t.data.nombreCompleto=t.data.primerNombre+" "+t.data.segundoNombre+" "+t.data.primerApellido+" "+t.data.segundoApellido,t))).subscribe(t=>{let m=t.data,h={nombreCompleto:t.data.nombreCompleto,numDoc:t.data.numDoc,direccion:t.data.direccion,idMunicipio:t.data.nombreMunicipio,correo:t.data.correo};this.firstFormGroup.patchValue(h)})}onSave(){if(this.secondFormGroup.valid)if(this._matData.edit){let e=this.form.getRawValue(),{cupo:m}=e,h=U(e,["cupo"]),v=y({cupo:Number(m)},h);this.fuseService.open(y({},j)).afterClosed().subscribe(Z=>{Z==="confirmed"?this.solicitudService.putSolicitudes(v).subscribe(ee=>{this.estadosDatosService.stateGridSolicitudes.next({state:!0,tab:2}),console.log("Guardado"),this.toasService.toasAlertWarn({message:"Registro actualizado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}else{let a=this.secondFormGroup.getRawValue(),{cupo:m}=a,h=U(a,["cupo"]),v=y({cupo:Number(m)},h);this.fuseService.open(y({},j)).afterClosed().subscribe(Z=>{Z==="confirmed"?this.solicitudService.postSolicitudes(v).subscribe(ee=>{console.log(ee),console.log("Edicion"),this.estadosDatosService.stateGridSolicitudes.next({state:!0,tab:2}),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}}createForm(){this.form=this.fb.group({id:[null],cupo:[""],observacion:[""]})}closeDialog(){this.dialogRef.close()}};c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=D({type:c,selectors:[["app-form-solicitudes"]],standalone:!0,features:[w],decls:70,vars:19,consts:[["stepper",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[3,"linear"],["label","Terminos y condiciones",3,"stepControl"],[1,"flex","flex-col","items-center","justify-center","w-full","h-full","px-4"],[1,"max-w-lg","text-center",3,"formGroup"],[1,"text-2xl","font-bold","mb-4"],[1,"mb-6","text-left"],["mat-raised-button","","matStepperNext","",1,"bg-blue-500","text-white","px-6","py-2","rounded-md","bg-credigray-100",3,"disabled"],["label","Verifica tu informaci\xF3n",3,"stepControl"],[3,"formGroup"],[1,"w-full"],["matInput","",3,"formControlName"],[1,"flex","flex-wrap","justify-center","gap-2.5"],["mat-raised-button","","matStepperPrevious","",1,"px-6","py-2","rounded-md"],["label","Pasos a seguir"],["label","Solicita tu cupo",3,"stepControl"],["matInput","","placeholder","observacion",3,"formControlName"],["mat-raised-button","",1,"bg-blue-500","text-white","px-6","py-2","rounded-md","bg-credigray-100",3,"click","disabled"]],template:function(e,t){if(e&1){let m=F();i(0,"div",1)(1,"mat-horizontal-stepper",2,0)(3,"mat-step",3)(4,"div",4)(5,"form",5)(6,"h2",6),r(7,"Terminos y condiciones"),o(),i(8,"p",7),r(9," Se presentar\xE1n los t\xE9rminos y condiciones para acceder al cr\xE9dito en la plataforma. En espera de los textos, por ahora se mantiene el lorem ipsu. "),o(),i(10,"button",8),r(11," Siguiente "),o()()()(),i(12,"mat-step",9)(13,"div",4)(14,"form",10)(15,"mat-form-field",11)(16,"mat-label"),r(17,"Nombre de completo"),o(),u(18,"input",12),o(),i(19,"mat-form-field",11)(20,"mat-label"),r(21,"Identificaci\xF3n"),o(),u(22,"input",12),o(),i(23,"mat-form-field",11)(24,"mat-label"),r(25,"Direcci\xF3n"),o(),u(26,"input",12),o(),i(27,"mat-form-field",11)(28,"mat-label"),r(29,"Email"),o(),u(30,"input",12),o(),i(31,"mat-form-field",11)(32,"mat-label"),r(33,"Ciudad"),o(),u(34,"input",12),o(),i(35,"div",13)(36,"button",14),r(37,"Anterior"),o(),i(38,"button",8),r(39,"Siguiente"),o()()()()(),i(40,"mat-step",15)(41,"div",4)(42,"form",5)(43,"h2",6),r(44,"Pasos a seguir"),o(),i(45,"p",7),r(46," 1. Al completar estos pasos nuestro equipo validar\xE1 la informaci\xF3n y aprobar\xE1 o rechazar\xE1 la solicitud, puedes ver el estado en cualquier momento. "),o(),i(47,"p",7),r(48," 2.	Si tu solicitud fue aprobada nuestro equipo se comunicar\xE1 contigo para socializarte el cupo aprobado y los detalles de tu cr\xE9dito. "),o(),i(49,"p",7),r(50," 3.	Si tu solicitud fue rechazada puedes comunicarte con nuestro equipo para obtener m\xE1s informaci\xF3n, podr\xE1s realizar una nueva solicitud dentro de XXX d\xEDas. "),o(),i(51,"button",8),r(52," Siguiente "),o()()()(),i(53,"mat-step",16)(54,"div",4)(55,"form",5)(56,"h2",6),r(57,"Solicita tu cupo"),o(),i(58,"p",7),r(59," Lorem ipsum dolor sit amet, consectetur adipisicing elit. Alias architecto consequuntur eveniet exercitationem expedita facere in, magnam magni molestiae mollitia natus obcaecati odit quibusdam quisquam sit soluta, sunt vel voluptatibus! "),o(),i(60,"mat-form-field",11)(61,"mat-label"),r(62,"Valor solicitado $"),o(),u(63,"input",12),o(),i(64,"mat-form-field",11)(65,"mat-label"),r(66,"Observaci\xF3nes"),o(),u(67,"textarea",17),o(),i(68,"button",18),E("click",function(){return S(m),x(t.onSave())}),r(69,"Finalizar"),o()()()()()()}e&2&&(n(),d("linear",!0),n(2),d("stepControl",t.initialInfoForm),n(2),d("formGroup",t.initialInfoForm),n(5),d("disabled",t.initialInfoForm.invalid),n(2),d("stepControl",t.firstFormGroup),n(2),d("formGroup",t.firstFormGroup),n(4),d("formControlName","nombreCompleto"),n(4),d("formControlName","numDoc"),n(4),d("formControlName","direccion"),n(4),d("formControlName","correo"),n(4),d("formControlName","idMunicipio"),n(4),d("disabled",t.firstFormGroup.invalid),n(4),d("formGroup",t.initialInfoForm),n(9),d("disabled",t.initialInfoForm.invalid),n(2),d("stepControl",t.secondFormGroup),n(2),d("formGroup",t.secondFormGroup),n(8),d("formControlName","cupo"),n(4),d("formControlName","observacion"),n(),d("disabled",t.secondFormGroup.invalid))},dependencies:[M,$,z,he,Ae,Ee,xe,Ce,ye,_e,De,Te,Me,Ne,Ge]});let l=c;return l})();var qe=()=>["/pages/gestion-creditos/solicitudes"];function Be(l,c){if(l&1){let s=F();I(0),i(1,"div",15)(2,"button",16),E("click",function(){S(s);let e=f(2);return x(e.onSave())}),r(3," Aprobar "),o(),i(4,"button",17),E("click",function(){S(s);let e=f(2);return x(e.onReject())}),r(5," Rechazar "),o()(),A()}}function ze(l,c){if(l&1&&(i(0,"div",8)(1,"div",9)(2,"div")(3,"h3",10),r(4),o(),i(5,"p",11),r(6,"Identificaci\xF3n: "),i(7,"span",12),r(8),o()(),i(9,"p",11),r(10,"Empresa: "),i(11,"span",12),r(12),o()(),i(13,"p",13),r(14,"Cargo: "),i(15,"span",12),r(16),o()(),i(17,"p",11),r(18,"Correo: "),i(19,"span",12),r(20),o()(),i(21,"p",11),r(22,"Direcci\xF3n: "),i(23,"span",12),r(24),o()(),i(25,"p",11),r(26,"Tel\xE9fono: "),i(27,"span",12),r(28),o()()(),i(29,"div")(30,"p",11),r(31,"N\xFAmero de solicitud: #12345"),o(),i(32,"p",11),r(33,"Monto solicitado: "),i(34,"span",12),r(35),K(36,"currency"),o()(),i(37,"p",11),r(38,"Fecha de Solicitud: "),i(39,"span",12),r(40),K(41,"date"),o()()()(),b(42,Be,6,0,"ng-container",14),o()),l&2){let s=f();n(4),ie("",s.items.trabajador.primerNombre," ",s.items.trabajador.segundoNombre," ",s.items.trabajador.primerApellido," ",s.items.trabajador.segundoApellido," "),n(4),C(s.items.trabajador.numDoc),n(4),C(s.items.nombreSubEmpresa),n(4),C(s.items.trabajador.cargo),n(4),C(s.items.trabajador.correo),n(4),C(s.items.trabajador.direccion),n(4),C(s.items.trabajador.telefono),n(7),C(le(36,13,s.items.cupo)),n(5),C(de(41,15,s.items.fechaCreacion,"dd/MM/yyyy")),n(2),d("ngIf",s.detalleEmpleado.idEstadoSolicitud==s.CodigosEstadosSolicitudes.PENDIENTE)}}var X=(()=>{let c=class c{constructor(){this.empleadosServices=p(H),this.solicitudService=p(G),this.toasService=p(W),this.fuseService=p(B),this.estadosDatosService=p(T),this.activatedRoute=p(me),this.router=p(O),this.CodigosEstadosSolicitudes=L}ngOnInit(){let a=this.activatedRoute.snapshot.paramMap.get("id");this.getSolicitud(a)}getSolicitud(a){this.subcription$=this.solicitudService.getSolicitud(a).subscribe(e=>{this.items=e.data,this.detalleEmpleado=e.data})}onSave(){let a={idEstado:L.APROBADA,id:this.detalleEmpleado.id};this.fuseService.open(y({},j)).afterClosed().subscribe(t=>{t==="confirmed"&&(this.subcription$=this.solicitudService.patchSolicitud(a).subscribe(m=>{m&&(this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/solicitudes"]))},m=>{this.toasService.toasAlertWarn({message:"Ha ocurrido un error!!!!",actionMessage:"Cerrar",duration:3e3})}))})}onReject(){let a={idEstado:L.RECHAZADA,id:this.detalleEmpleado.id};this.fuseService.open(y({},we)).afterClosed().subscribe(t=>{t==="confirmed"&&(this.subcription$=this.solicitudService.patchSolicitud(a).subscribe(m=>{m&&(this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/solicitudes"]))},m=>{this.toasService.toasAlertWarn({message:"Ha ocurrido un error!!!!",actionMessage:"Cerrar",duration:3e3})}))})}ngOnDestroy(){this.subcription$.unsubscribe()}};c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=D({type:c,selectors:[["app-form-approve"]],standalone:!0,features:[w],decls:10,vars:4,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","print:p-0","w-full"],[1,"bg-card","shadow","print:bg-transparent","print:p-0","print:shadow-none","rounded-2xl","max-w-xl","mx-auto","overflow-hidden"],[1,"bg-crediblue-50","px-6","py-4","flex","items-center","justify-between"],["mat-button","",1,"flex","items-center",3,"routerLink"],[1,"text-white",3,"svgIcon"],[1,"text-xl","font-bold","text-white"],["class","p-6",4,"ngIf"],[1,"p-6"],[1,"mb-4","flex","justify-between"],[1,"text-lg","font-semibold","text-gray-800"],[1,"text-gray-600","font-bold"],[1,"text-gray-800"],[1,"text-gray-600","font-semibold"],[4,"ngIf"],[1,"flex","justify-between","items-center","mt-10"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediblue-50","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediorange-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),u(6,"mat-icon",5),o()(),i(7,"h2",6),r(8,"Detalle de Solicitud"),o()(),b(9,ze,43,18,"div",7),o()()()),e&2&&(n(5),d("routerLink",se(3,qe)),n(),d("svgIcon","heroicons_outline:arrow-long-left"),n(3),d("ngIf",t.items))},dependencies:[M,R,k,ue,P,ve,q,pe]});let l=c;return l})();function We(l,c){if(l&1&&(I(0),u(1,"app-custom-table",19),A()),l&2){let s=f(2);n(),d("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("buttons",s.buttons)}}function He(l,c){if(l&1&&b(0,We,2,5,"ng-container",18),l&2){let s=f();d("ngIf",s.data.length)}}function Le(l,c){if(l&1&&(I(0),u(1,"app-custom-table",19),A()),l&2){let s=f(2);n(),d("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("buttons",s.buttons)}}function Xe(l,c){if(l&1&&b(0,Le,2,5,"ng-container",18),l&2){let s=f();d("ngIf",s.data.length)}}function Ze(l,c){if(l&1&&(I(0),u(1,"app-custom-table",19),A()),l&2){let s=f(2);n(),d("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("buttons",s.buttons)}}function Ue(l,c){if(l&1&&b(0,Ze,2,5,"ng-container",18),l&2){let s=f();d("ngIf",s.data.length)}}var ke=(()=>{let c=class c{constructor(a,e,t){this._matDialog=a,this.estadoDatosService=e,this.solicitudService=t,this.datePipe=p(P),this.currencyPipe=p(R),this.router=p(O),this.selectedTab=g.APROBADA,this.data=[],this.columns=["Empleado","Cupo solicitado","Empresa","Estado","Fecha de solicitud"],this.columnPropertyMap={Empleado:"nombreTrabajador","Cupo solicitado":"cupo",Empresa:"nombreSubEmpresa",Estado:"nombreEstadoSolicitud","Fecha de solicitud":"fechaCreacion"},this.buttons=[{label:"View",icon:"visibility",action:m=>{console.log("Approve",m),this.selectedData=m,this.router.navigate(["pages/gestion-creditos/solicitudes/estados",this.selectedData.id])}}],this.tabChanged=m=>{console.log("tabChangeEvent => ",m),console.log("index => ",m.index),this.tabIndex=m.index,console.log(this.tabIndex),this.selectedTab=m.index==0?g.APROBADA:m.index==1?g.RECHAZADA:m.index==2?g.PENDIENTE:g.APROBADA,this.getSolicitudes(this.selectedTab)}}onNew(){this._matDialog.open(Ve,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",maxWidth:"100%"})}onApprove(){this._matDialog.open(X,{autoFocus:!1,data:{data:this.selectedData},maxHeight:"90vh",width:"50%",maxWidth:"100%"})}getSolicitudes(a){this.subcription$=this.solicitudService.getSolicitudes(a).pipe(N(e=>(e.data.forEach(t=>{t.estado?t.estado=Q.ACTIVO:t.estado=Q.INACTIVO}),e)),N(e=>(e.data.forEach(t=>{t.fechaCreacion=this.datePipe.transform(t.fechaCreacion,"dd/MM/yyyy"),t.cupo=this.currencyPipe.transform(t.cupo,"USD","symbol","1.2-2")}),e))).subscribe(e=>{e?this.data=e.data:this.data=[]},e=>{this.data=[]})}listenGrid(){this.estadoDatosService.stateGridSolicitudes.asObservable().subscribe(e=>{e.state&&(console.log("Si entro"),console.log(e),this.selectedTab=e.tab==0?g.APROBADA:e.tab==1?g.RECHAZADA:e.tab==2?g.PENDIENTE:g.APROBADA,this.tabIndex=e.tab,console.log(this.tabIndex),this.getSolicitudes(this.selectedTab))})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getSolicitudes(this.selectedTab),this.listenGrid()}};c.\u0275fac=function(e){return new(e||c)(V(ge),V(T),V(G))},c.\u0275cmp=D({type:c,selectors:[["app-grid-solicitudes"]],standalone:!0,features:[ne([P,R]),w],decls:22,vars:8,consts:[["tabGroup",""],[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],["mat-flat-button","",1,"ml-4","bg-crediblue-50",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:overflow-y-auto","bg-gray-100"],["mat-stretch-tabs","false",1,"sm:px-2",3,"selectedIndexChange","selectedTabChange","animationDuration","selectedIndex"],["label","Aprobadas"],["matTabContent",""],["label","Rechazadas"],["label","Pendientes"],[4,"ngIf"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(e,t){if(e&1){let m=F();i(0,"div",1)(1,"div",2)(2,"div",3),r(3,"Solicitud de cr\xE9ditos"),o(),i(4,"div",4)(5,"mat-form-field",5),u(6,"mat-icon",6)(7,"input",7),o(),i(8,"button",8),E("click",function(){return S(m),x(t.onNew())}),u(9,"mat-icon",9),i(10,"span",10),r(11,"Crear solicitud"),o()()()(),i(12,"div",11)(13,"div",12)(14,"mat-tab-group",13,0),ae("selectedIndexChange",function(v){return S(m),re(t.tabIndex,v)||(t.tabIndex=v),x(v)}),E("selectedTabChange",function(v){return S(m),x(t.tabChanged(v))}),i(16,"mat-tab",14),b(17,He,1,1,"ng-template",15),o(),i(18,"mat-tab",16),b(19,Xe,1,1,"ng-template",15),o(),i(20,"mat-tab",17),b(21,Ue,1,1,"ng-template",15),o()()()()()}e&2&&(n(5),d("subscriptSizing","dynamic"),n(),d("svgIcon","heroicons_solid:magnifying-glass"),n(),d("autocomplete","off")("placeholder","Buscar"),n(),d("color","primary"),n(),d("svgIcon","heroicons_outline:plus"),n(5),d("animationDuration","500"),oe("selectedIndex",t.tabIndex))},dependencies:[Fe,M,$,q,z,Re,je,Pe,k]});let l=c;return l})();var ei=[{path:"",component:ke},{path:"estados/:id",component:X}];export{ei as default};
