import{a as y}from"./chunk-2SWUCMCI.js";import{a as le}from"./chunk-MNKHKPLZ.js";import{a as ce}from"./chunk-YRESZUIM.js";import{a as se}from"./chunk-72OGA3YA.js";import{a as P}from"./chunk-4WJQLHI3.js";import{a as w}from"./chunk-VOLXTRGQ.js";import{a as me}from"./chunk-54OZA4EP.js";import"./chunk-BGM5RQG6.js";import{g as Y}from"./chunk-B24N63ZV.js";import{a as q,b as K,c as Q}from"./chunk-PG3Z5E5P.js";import"./chunk-P2KBT4CK.js";import{C as re,F as ne,J as E,b as U,i as x,l as Z,p as ee,q as te,u as ie,x as oe,y as ae}from"./chunk-XMPVE5LH.js";import{$ as J,ea as D,ja as X}from"./chunk-AAD5V3QY.js";import"./chunk-AUCKEBH6.js";import"./chunk-K4NG4L4V.js";import{Cb as g,Cc as H,Hc as W,Mb as l,Nb as z,Ob as G,Qa as i,Ra as _,Vb as C,_ as T,bc as k,cc as R,gb as h,ha as f,ib as a,ma as v,tb as r,ub as o,vb as p,wa as b,wb as A,xa as S,xb as V,yc as B,zb as j,zc as L}from"./chunk-YBEOGPR3.js";import{a as I,d as N}from"./chunk-NEB6MB4Y.js";function fe(s,m){if(s&1&&(r(0,"mat-option",21),l(1),o()),s&2){let d=m.$implicit;a("value",d.id),i(),z(d.nombre)}}function ue(s,m){if(s&1&&(A(0),h(1,fe,2,2,"mat-option",20),V()),s&2){let d=m.ngIf;i(),a("ngForOf",d.data)}}function ge(s,m){if(s&1&&(r(0,"mat-option",21),l(1),o()),s&2){let d=m.$implicit;a("value",d.id),i(),z(d.nombre)}}function he(s,m){if(s&1&&(A(0),h(1,ge,2,2,"mat-option",20),V()),s&2){let d=m.ngIf;i(),a("ngForOf",d.data)}}var $=(()=>{let m=class m{constructor(){this.fb=f(re),this._locacionService=f(le),this.empresasService=f(y),this.dialogRef=f(q),this.fuseService=f(Y),this.estadosDatosService=f(w),this.toasService=f(ce),this.departamentos$=this._locacionService.getDepartamentos().pipe(T(n=>{let e=n.data,t=this._matData;if(e&&!t.edit){this.form.get("idDepartamento").setValue(e[0].id);let c=this.form.get("idDepartamento").value;this.getMunicipios(c)}})),this._matData=f(K)}onSelected(n){let e=n.value;this.getMunicipios(e)}getMunicipios(n){this.municipios$=this._locacionService.getMunicipio(n).pipe(T(e=>{let t=e.data,c=this._matData;t&&!c.edit&&this.form.get("idMunicipio").setValue(t[0].id)}))}ngOnInit(){this.createForm();let n=this._matData;if(n.edit){let e=n.data;this.form.patchValue(e);let{idDepartamento:t}=e;this.municipios$=this._locacionService.getMunicipio(t)}}createForm(){this.form=this.fb.group({id:[null],nit:[""],razonSocial:[""],correo:[""],telefono:[""],direccion:[""],idDepartamento:[""],idMunicipio:[""],procMaxPrestamo:[""]})}onSave(){if(this.form.valid)if(this._matData.edit){let e=this.form.getRawValue(),{idDepartamento:c}=e,u=N(e,["idDepartamento"]);this.fuseService.open(I({},P)).afterClosed().subscribe(F=>{F==="confirmed"?this.empresasService.putEmpresa(u).subscribe(O=>{this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro actualizado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}else{let n=this.form.getRawValue(),{idDepartamento:c}=n,u=N(n,["idDepartamento"]);this.fuseService.open(I({},P)).afterClosed().subscribe(F=>{F==="confirmed"?this.empresasService.postEmpresa(u).subscribe(O=>{console.log(O),this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro Creado o Actualizado con Exito.",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}}closeDialog(){this.dialogRef.close()}};m.\u0275fac=function(e){return new(e||m)},m.\u0275cmp=v({type:m,selectors:[["app-form-empresas"]],standalone:!0,features:[C],decls:54,vars:19,consts:[["data",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[1,""],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8",3,"formGroup"],[1,"flex","flex-col","lg:flex-row","mb-4","gap-2"],["floatLabel","always",1,"w-full"],["id","nit","matInput","","placeholder","Nit",3,"formControlName"],["matInput","","placeholder","Raz\xF3n social",3,"formControlName"],["matInput","","placeholder","Porcentaje maximo",3,"formControlName"],["matInput","","placeholder","Correo electronico",3,"formControlName"],["matInput","","placeholder","Tel\xE9fono",3,"formControlName"],["placeholder","Departamento",3,"selectionChange","formControlName"],[4,"ngIf"],["placeholder","Ciudad",3,"formControlName"],[1,"flex","flex-col","sm:flex-row","mb-4","gap-2"],["matInput","","placeholder","Direcci\xF3n",3,"formControlName"],[1,"flex","flex-wrap","justify-end","gap-2.5"],["mat-flat-button","",1,"lg:w-auto","w-full","lg:mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"lg:w-auto","w-full","lg:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(e&1){let c=j();r(0,"div",1)(1,"div",2)(2,"div",3),l(3),o(),r(4,"form",4)(5,"div",5)(6,"mat-form-field",6)(7,"mat-label"),l(8,"Nit"),o(),p(9,"input",7),o(),r(10,"mat-form-field",6)(11,"mat-label"),l(12,"Raz\xF3n social"),o(),p(13,"input",8),o()(),r(14,"div",5)(15,"mat-form-field",6)(16,"mat-label"),l(17,"Porcentaje maximo prestamo"),o(),p(18,"input",9),o()(),r(19,"div",5)(20,"mat-form-field",6)(21,"mat-label"),l(22,"Correo"),o(),p(23,"input",10),o(),r(24,"mat-form-field",6)(25,"mat-label"),l(26,"Tel\xE9fono"),o(),p(27,"input",11),o()(),r(28,"div",5)(29,"mat-form-field",6)(30,"mat-label"),l(31,"Departamento"),o(),r(32,"mat-select",12,0),g("selectionChange",function(M){return b(c),S(t.onSelected(M))}),h(34,ue,2,1,"ng-container",13),k(35,"async"),o()(),r(36,"mat-form-field",6)(37,"mat-label"),l(38,"Ciudad"),o(),r(39,"mat-select",14),h(40,he,2,1,"ng-container",13),k(41,"async"),o()()(),r(42,"div",15)(43,"mat-form-field",6)(44,"mat-label"),l(45,"Direcci\xF3n"),o(),p(46,"input",16),o()(),r(47,"div",17)(48,"button",18),g("click",function(){return b(c),S(t.closeDialog())}),r(49,"span"),l(50," Cancelar "),o()(),r(51,"button",19),g("click",function(){return b(c),S(t.onSave())}),r(52,"span"),l(53),o()()()()()()}e&2&&(i(3),G(" ",t._matData.edit?"Actualizar empresa":"Agregar empresa"," "),i(),a("formGroup",t.form),i(5),a("formControlName","nit"),i(4),a("formControlName","razonSocial"),i(5),a("formControlName","procMaxPrestamo"),i(5),a("formControlName","correo"),i(4),a("formControlName","telefono"),i(5),a("formControlName","idDepartamento"),i(2),a("ngIf",R(35,15,t.departamentos$)),i(5),a("formControlName","idMunicipio"),i(),a("ngIf",R(41,17,t.municipios$)),i(6),a("formControlName","direccion"),i(2),a("color","primary"),i(3),a("color","primary"),i(2),G(" ",t._matData.edit?"Actualizar":"Guardar"," "))},dependencies:[x,E,D,U,me,J,L,H,B,ne,ie,Z,ee,te,oe,ae],styles:[".custom-dialog-container{width:100%}@media (min-width: 600px){  .custom-dialog-container{width:60%}}@media (min-width: 1280px){  .custom-dialog-container{width:50%}}"]});let s=m;return s})();var pe=(()=>{let m=class m{constructor(n,e,t){this._matDialog=n,this.empresasService=e,this.estadoDatosService=t,this.searchTerm="",this.data=[],this.columns=["Nit","Razon social","Correo","Telefono","Direccion"],this.columnPropertyMap={Nit:"nit","Razon social":"razonSocial",Correo:"correo",Telefono:"telefono",Direccion:"direccion"},this.buttons=[{label:"Edit",icon:"edit",action:c=>{console.log("Editing",c),this.selectedData=c,this.onEdit()}}]}onNew(){this._matDialog.open($,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",width:"50%",disableClose:!0,panelClass:"custom-dialog-container"})}onEdit(){this._matDialog.open($,{autoFocus:!1,data:{edit:!0,data:this.selectedData},maxHeight:"90vh",width:"50%",disableClose:!0,panelClass:"custom-dialog-container"})}getEmpresas(){this.subcription$=this.empresasService.getEmpresas().subscribe(n=>{this.data=n.data})}ngOnInit(){this.getEmpresas(),this.listenGrid()}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(e=>{e&&this.getEmpresas()})}onSearch(n){let e=n.target;this.searchTerm=e.value.trim().toLowerCase()}ngOnDestroy(){this.subcription$.unsubscribe()}ngAfterViewInit(){}};m.\u0275fac=function(e){return new(e||m)(_(Q),_(y),_(w))},m.\u0275cmp=v({type:m,selectors:[["app-grid-empresas"]],standalone:!0,features:[C],decls:15,vars:12,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],["mat-flat-button","",1,"mt-2","w-full","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold","sm:ml-4","sm:mt-0","sm:w-auto",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons","searchTerm"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),l(3,"Empresas Maestras"),o(),r(4,"div",3)(5,"mat-form-field",4),p(6,"mat-icon",5),r(7,"input",6),g("input",function(u){return t.onSearch(u)}),o()(),r(8,"button",7),g("click",function(){return t.onNew()}),p(9,"mat-icon",8),r(10,"span",9),l(11,"Agregar"),o()()()(),r(12,"div",10)(13,"div",11),p(14,"app-custom-table",12),o()()()),e&2&&(i(5),a("subscriptSizing","dynamic"),i(),a("svgIcon","heroicons_solid:magnifying-glass"),i(),a("autocomplete","off")("placeholder","Buscar"),i(),a("color","primary"),i(),a("svgIcon","heroicons_outline:plus"),i(5),a("columns",t.columns)("displayedColumns",t.columns)("columnPropertyMap",t.columnPropertyMap)("data",t.data)("buttons",t.buttons)("searchTerm",t.searchTerm))},dependencies:[W,x,X,D,E,se]});let s=m;return s})();var Ue=[{path:"",component:pe}];export{Ue as default};
