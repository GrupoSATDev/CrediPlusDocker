import{a as Pe}from"./chunk-2IWLOUWP.js";import{a as je,b as ke}from"./chunk-6QQIGFYJ.js";import{a as Re}from"./chunk-IMYAJ2GD.js";import{a as Ie,b as Ae,c as Ve,d as qe}from"./chunk-H5NJ4I62.js";import{a as Me}from"./chunk-V6RS7PIT.js";import{a as Be}from"./chunk-CUPNIQKB.js";import{a as we}from"./chunk-3XMKQ74T.js";import{a as Te}from"./chunk-HWCPZW2A.js";import{a as _e,b as Ne}from"./chunk-FIT6CNEK.js";import{a as xe}from"./chunk-5ORYEC2V.js";import{a as Ge}from"./chunk-TRVR57AA.js";import{a as De}from"./chunk-ARYACW5V.js";import{a as Fe}from"./chunk-5ZCUS56W.js";import{a as Ee}from"./chunk-MO2NC6JB.js";import{a as ye}from"./chunk-H5OWTWVS.js";import{g as le}from"./chunk-45VFWK2F.js";import"./chunk-3F72AFMB.js";import{h as ie}from"./chunk-T4J43FBS.js";import{a as Se}from"./chunk-T6KI2TP3.js";import"./chunk-C2OGGKTO.js";import{B as he,C as be,G as ge,b as re,c as ne,i as ae,l as de,n as u,p as pe,q as ue,u as ce,w as fe,x as ve,z as Ce}from"./chunk-JBQZ6BPD.js";import{$ as oe,Q as ee,R as te,ea as me}from"./chunk-SUQ5NR2B.js";import"./chunk-7ZG6LO6Q.js";import"./chunk-TO3CLTNT.js";import{a as se}from"./chunk-CLM77PYI.js";import{d as Z}from"./chunk-FVVJ54UE.js";import{e as z,f as K,g as U,i as X,j as S,s as Y}from"./chunk-SQ7M4XTP.js";import{$b as _,Db as i,Eb as e,Fb as c,Gb as j,Hb as k,Jb as R,Pb as D,Rb as w,Vb as P,Wb as O,Xb as $,Y as q,Zb as n,_a as o,_b as v,aa as M,ec as L,fa as x,fc as Q,ga as p,ic as H,l as g,la as B,nc as N,oc as J,pc as W,qb as f,sb as m,va as F,wa as E}from"./chunk-RICNMTJI.js";import{a as y,d as V}from"./chunk-NEB6MB4Y.js";var Oe=(()=>{let l=class l{constructor(s,r){this._http=s,this.AppSettings=r}postDesembolso(s){return this._http.post(this.AppSettings.detalleConsumos.url.desembolsoBase,s)}};l.\u0275fac=function(r){return new(r||l)(x(Y),x(se))},l.\u0275prov=M({token:l,factory:l.\u0275fac,providedIn:"root"});let a=l;return a})();var Qe=["stepper"],He=(a,l)=>({"bg-crediblue-50":a,"bg-credigray-100":l});function Je(a,l){if(a&1&&(i(0,"mat-option",34),n(1),e()),a&2){let d=l.$implicit;m("value",d.id),o(),v(d.nombre)}}function We(a,l){if(a&1&&(j(0),f(1,Je,2,2,"mat-option",29),k()),a&2){let d=l.ngIf;o(),m("ngForOf",d.data)}}function ze(a,l){a&1&&(i(0,"mat-error"),n(1," El n\xFAmero de identificaci\xF3n es requerido!. "),e())}function Ke(a,l){if(a&1&&(i(0,"fuse-alert",35),n(1),e()),a&2){let d=w();m("appearance","outline")("showIcon",!1)("type",d.alert.type)("@shake",d.alert.type==="error"),o(),_(" ",d.alert.message," ")}}function Ue(a,l){a&1&&(i(0,"mat-error"),n(1,"El campo es requerido!"),e())}function Xe(a,l){a&1&&(i(0,"mat-error"),n(1,"El valor es requerido!"),e())}function Ye(a,l){a&1&&(i(0,"mat-error"),n(1,"El valor ingresado no puede superar el cupo disponible!"),e())}function Ze(a,l){if(a&1&&(i(0,"mat-option",34),n(1),e()),a&2){let d=l.$implicit;m("value",d.idTipoCuenta),o(),v(d.nombreBanco)}}function et(a,l){a&1&&(i(0,"mat-error"),n(1,"El campo es requerido!"),e())}function tt(a,l){if(a&1&&(i(0,"div",36)(1,"div",37)(2,"div",38)(3,"h2",39),n(4,"Resumen de desembolso"),e(),i(5,"p",40),n(6,"Revise los detalles"),e()(),i(7,"div",41)(8,"div",42)(9,"div")(10,"h3",43),n(11,"Fecha"),e()(),i(12,"p",44),n(13),N(14,"date"),e()(),i(15,"div",42)(16,"div")(17,"h3",43),n(18,"N\xFAmero de comprobante"),e()(),i(19,"p",44),n(20),e()(),i(21,"div",42)(22,"div")(23,"h3",43),n(24,"Valor"),e()(),i(25,"p",44),n(26),e()(),i(27,"div",42)(28,"div")(29,"h3",43),n(30,"Cuenta de origen"),e()(),i(31,"p",44),n(32),e()(),i(33,"div",45)(34,"div")(35,"h3",43),n(36,"Cuenta destino"),e()(),i(37,"p",44),n(38),e()()()()()),a&2){let d=w();o(13),v(W(14,5,d.detaleConsumo.fechaCreacion,"dd/MM/yyyy")),o(7),v(d.detaleConsumo.numeroFactura),o(6),v(d.detaleConsumo.montoConsumo),o(6),v(d.detaleConsumo.cuentaOrigen),o(6),v(d.detaleConsumo.cuentaDestino)}}var ot={validation:!1},$e=(()=>{let l=class l{constructor(){this.tiposDocumentosService=p(Te),this.fuseService=p(le),this.estadosDatosService=p(Ee),this.toasService=p(De),this.empleadosServices=p(Me),this.tipoConsumosService=p(ke),this.cuentasServices=p(Re),this.tipoCuentaService=p(Pe),this.datePipe=p(S),this.router=p(Z),this.fb=p(Ce),this._locacionService=p(xe),this.detalleConsumo=p(Be),this.cuentas=[],this.tipoCuentas$=this.tipoCuentaService.getTipoCuentas(),this.desembolsoService=p(Oe),this.swalService=p(Ge),this.showAlert=!1,this.alert={type:"success",message:""},this.tiposDocumentos$=this.tiposDocumentosService.getTiposDocumentos().pipe(q(s=>{let r=s.data[3];r&&this.firstFormGroup.get("idTipoDoc").setValue(r.id)})),this.creditos=[],this.focus=focus,this.FormatoOptionsPipe=je}ngOnDestroy(){}ngOnInit(){this.createForm(),this.getCuentas()}getCuentas(){this.subscription$=this.cuentasServices.getCuentas().subscribe(s=>{this.cuentas=s.data})}selected(s){let r=s.value;this.compareValor=r.cupoDisponible,this.thirdFormGroup.get("montoConsumo").setValidators(it(this.compareValor)),this.thirdFormGroup.get("montoConsumo").updateValueAndValidity()}compareWithConstants(s){let r=s.value,t=this.secondFormGroup.get("idCredito")?.value;return!t||!t.montoConsumo?(console.error("No se encontr\xF3 el objeto idCredito o montoConsumo"),g(null)):(console.log(r),console.log(t.montoConsumo),r>t.montoConsumo?g({notEqual:!0}):g(null))}get montoConsumo(){return this.thirdFormGroup.get("montoConsumo")}get comprobante(){return this.thirdFormGroup.get("numeroFactura")}get cuentaDestino(){return this.thirdFormGroup.get("cuentaDestino")}onSearch(){let s=this.firstFormGroup.getRawValue();this.empleadosServices.getEmpleadoParams(s).subscribe(r=>{if(console.log(r),r){this.showAlert=!1;let t={numDoc:r.data.numDoc,primerNombre:r.data.primerNombre,segundoNombre:r.data.segundoNombre,primerApellido:r.data.primerApellido,segundoApellido:r.data.segundoApellido,idTrabajador:r.data.id,correo:r.data.correo,credito:r.data.creditos[0].numCredito+" - "+r.data.creditos[0].cupoDisponible,idCredito:r.data.creditos[0].id,numCuentaBancaria:r.data.numCuentaBancaria,idTipoCuenta:r.data.idTipoCuenta};this.secondFormGroup.patchValue(t),console.log(t),console.log(this.thirdFormGroup.getRawValue()),this.thirdFormGroup.patchValue({idCuentaBancaria:t.idTipoCuenta,cuentaDestino:t.numCuentaBancaria}),this.creditos=r.data.creditos,setTimeout(()=>{this.stepper.next()},1200)}},r=>{this.alert={type:"error",message:"El trabajador no existe!"},this.showAlert=!0})}onSave(){if(this.thirdFormGroup.valid){let s=this.thirdFormGroup.getRawValue(),{montoConsumo:r,idCuentaBancaria:t}=s,C=V(s,["montoConsumo","idCuentaBancaria"]),{idCredito:h,idTrabajador:G}=this.secondFormGroup.getRawValue();console.log(h);let T=this.cuentas.filter(b=>{if(b.idTipoCuenta==t)return b.id});console.log(T[0].id);let I=y({idCredito:h,idTrabajador:G,montoConsumo:Number(r),idCuentaBancaria:T[0].id},C);console.log(I),this.fuseService.open(y({},Fe)).afterClosed().subscribe(b=>{b==="confirmed"&&this.desembolsoService.postDesembolso(I).subscribe(A=>{console.log(A),this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.getResumenCompra(G)},A=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})})})}}getResumenCompra(s){this.subscription$=this.detalleConsumo.getResumen(s).subscribe(r=>{r&&(console.log(r),this.detaleConsumo=r.data,this.stepper.next())})}createForm(){this.firstFormGroup=this.fb.group({idTipoDoc:[""],numDocumento:["",u.required]}),this.secondFormGroup=this.fb.group({numDoc:["",u.required],primerNombre:["",u.required],segundoNombre:["",u.required],primerApellido:["",u.required],segundoApellido:["",u.required],idTrabajador:[""],correo:["",u.required],credito:["",u.required],idCredito:["",u.required],numCuentaBancaria:[""],idTipoCuenta:[""]}),this.thirdFormGroup=this.fb.group({montoConsumo:["",[u.required]],numeroFactura:["",u.required],idCuentaBancaria:["",u.required],cuentaDestino:["",u.required],idCuenta:[""]})}};l.\u0275fac=function(r){return new(r||l)},l.\u0275cmp=B({type:l,selectors:[["app-form-desembolso"]],viewQuery:function(r,t){if(r&1&&P(Qe,5),r&2){let C;O(C=$())&&(t.stepper=C.first)}},standalone:!0,features:[L([{provide:te,useClass:we},{provide:ee,useValue:"en-GB"},S,_e(ot)]),Q],decls:96,vars:42,consts:[["stepper",""],["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","items-center","overflow-y-auto","bg-gray-100","p-6","sm:p-8"],[1,"relative","w-full","flex-0","max-w-4xl","sm:rounded-lg","overflow-hidden"],[1,"p-2","text-3xl","font-semibold","text-center","text-gray-800"],[1,"w-full","px-6","py-4",3,"orientation","linear","animationDuration"],["label","Consultar trabajador",3,"stepControl"],[1,"flex","flex-col","items-center","w-full"],[1,"space-y-4","w-full","max-w-sm",3,"formGroup"],[1,"w-full"],[3,"formControlName"],[4,"ngIf"],["floatLabel","always",1,"w-full"],["matInput","","placeholder","Ingrese identificaci\xF3n",3,"formControlName"],["class","mb-4",3,"appearance","showIcon","type",4,"ngIf"],["mat-raised-button","",1,"w-full","py-2","text-white","rounded-lg","transition","hover:bg-opacity-80",3,"click","disabled","ngClass"],["label","Verificar informaci\xF3n",3,"stepControl"],[1,"space-y-4","w-full","max-w-lg","mx-auto",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","gap-4"],["matInput","","readonly","",3,"formControlName"],[1,"flex","flex-col"],[1,"flex","flex-wrap","justify-center","sm:justify-center","gap-4","mt-2"],["mat-button","","matStepperPrevious","",1,"sm:w-auto","w-full","py-2","px-4","text-white","bg-gray-500","rounded-lg","hover:bg-gray-600"],["mat-button","","matStepperNext","",1,"sm:w-auto","w-full","py-2","px-4","text-white","bg-crediblue-50","rounded-lg","hover:bg-opacity-80",3,"disabled"],["label","Confirmar desembolso",3,"stepControl"],[1,"w-full","h-full","p-4","sm:p-8"],[1,"flex","flex-col","sm:flex-row","items-baseline","gap-4"],["matInput","","placeholder","N\xFAmero de comprobante",3,"formControlName"],["matInput","","thousandSeparator",".","placeholder","Valor",3,"formControlName","mask"],["placeholder","Cuenta de origen",3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Cuenta destino",3,"formControlName"],["mat-button","",1,"sm:w-auto","w-full","py-2","px-4","text-white","bg-crediblue-50","rounded-lg","hover:bg-opacity-80",3,"click","disabled"],["label","Resumen de desembolso"],["class","w-full px-4 sm:px-8",4,"ngIf"],[3,"value"],[1,"mb-4",3,"appearance","showIcon","type"],[1,"w-full","px-4","sm:px-8"],[1,"max-w-2xl","mx-auto","p-6","bg-white","shadow-lg","rounded-lg"],[1,"border-b","pb-4","mb-4","text-center"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"space-y-4"],[1,"flex","justify-between","items-center","border-b","pb-2"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","justify-between","items-center"]],template:function(r,t){if(r&1){let C=R();i(0,"div",1)(1,"div",2)(2,"div",3),n(3),e(),i(4,"mat-stepper",4,0)(6,"mat-step",5)(7,"div",6)(8,"form",7)(9,"mat-form-field",8)(10,"mat-label"),n(11,"Tipo de documento"),e(),i(12,"mat-select",9),f(13,We,2,1,"ng-container",10),N(14,"async"),e()(),i(15,"mat-form-field",11)(16,"mat-label"),n(17,"N\xFAmero de identificaci\xF3n"),e(),c(18,"input",12),f(19,ze,2,0,"mat-error",10),e(),f(20,Ke,2,5,"fuse-alert",13),i(21,"button",14),D("click",function(){return F(C),E(t.onSearch())}),n(22," Consultar "),e()()()(),i(23,"mat-step",15)(24,"div",8)(25,"form",16)(26,"div",17)(27,"mat-form-field",8)(28,"mat-label"),n(29,"Primer nombre"),e(),c(30,"input",18),e(),i(31,"mat-form-field",8)(32,"mat-label"),n(33,"Segundo nombre"),e(),c(34,"input",18),e()(),i(35,"div",17)(36,"mat-form-field",8)(37,"mat-label"),n(38,"Primer apellido"),e(),c(39,"input",18),e(),i(40,"mat-form-field",8)(41,"mat-label"),n(42,"Segundo apellido"),e(),c(43,"input",18),e()(),i(44,"div",17)(45,"mat-form-field",8)(46,"mat-label"),n(47,"Identificaci\xF3n"),e(),c(48,"input",18),e(),i(49,"mat-form-field",8)(50,"mat-label"),n(51,"Email"),e(),c(52,"input",18),e()(),i(53,"div",19)(54,"mat-form-field",8)(55,"mat-label"),n(56,"Cr\xE9dito"),e(),c(57,"input",18),e()()(),i(58,"div",20)(59,"button",21),n(60,"Anterior"),e(),i(61,"button",22),n(62,"Siguiente"),e()()()(),i(63,"mat-step",23)(64,"div",24)(65,"form",16)(66,"div",25)(67,"mat-form-field",11)(68,"mat-label"),n(69,"N\xFAmero de comprobante"),e(),c(70,"input",26),f(71,Ue,2,0,"mat-error",10),e(),i(72,"mat-form-field",11)(73,"mat-label"),n(74,"Valor de la transferencia"),e(),c(75,"input",27),f(76,Xe,2,0,"mat-error",10)(77,Ye,2,0,"mat-error",10),e()(),i(78,"div",17)(79,"mat-form-field",11)(80,"mat-label"),n(81,"Cuenta de origen"),e(),i(82,"mat-select",28),f(83,Ze,2,2,"mat-option",29),e()(),i(84,"mat-form-field",11)(85,"mat-label"),n(86,"Cuenta destino"),e(),c(87,"input",30),f(88,et,2,0,"mat-error",10),e()()(),i(89,"div",20)(90,"button",21),n(91,"Anterior"),e(),i(92,"button",31),D("click",function(){return F(C),E(t.onSave())}),n(93,"Confirmar"),e()()()(),i(94,"mat-step",32),f(95,tt,39,8,"div",33),e()()()()}r&2&&(o(3),_(" ","Desembolso"," "),o(),m("orientation","vertical")("linear",!0)("animationDuration","1500"),o(2),m("stepControl",t.firstFormGroup),o(2),m("formGroup",t.firstFormGroup),o(4),m("formControlName","idTipoDoc"),o(),m("ngIf",J(14,37,t.tiposDocumentos$)),o(5),m("formControlName","numDocumento"),o(),m("ngIf",t.firstFormGroup.get("numDocumento").dirty||t.firstFormGroup.get("numDocumento").touched&&t.firstFormGroup.get("numDocumento").errors.required),o(),m("ngIf",t.showAlert),o(),m("disabled",t.firstFormGroup.invalid)("ngClass",H(39,He,t.firstFormGroup.valid,t.firstFormGroup.invalid)),o(2),m("stepControl",t.secondFormGroup),o(2),m("formGroup",t.secondFormGroup),o(5),m("formControlName","primerNombre"),o(4),m("formControlName","segundoNombre"),o(5),m("formControlName","primerApellido"),o(4),m("formControlName","segundoApellido"),o(5),m("formControlName","numDoc"),o(4),m("formControlName","correo"),o(5),m("formControlName","credito"),o(4),m("disabled",t.secondFormGroup.invalid),o(2),m("stepControl",t.thirdFormGroup),o(2),m("formGroup",t.thirdFormGroup),o(5),m("formControlName","numeroFactura"),o(),m("ngIf",(t.comprobante.touched||t.comprobante.dirty)&&t.comprobante.hasError("required")),o(4),m("formControlName","montoConsumo")("mask","separator.0"),o(),m("ngIf",(t.montoConsumo.touched||t.montoConsumo.dirty)&&t.montoConsumo.hasError("required")),o(),m("ngIf",(t.montoConsumo.touched||t.montoConsumo.dirty)&&t.montoConsumo.hasError("notEqual")),o(5),m("formControlName","idCuentaBancaria"),o(),m("ngForOf",t.cuentas),o(4),m("formControlName","cuentaDestino"),o(),m("ngIf",(t.cuentaDestino.touched||t.cuentaDestino.dirty)&&t.cuentaDestino.hasError("required")),o(4),m("disabled",t.thirdFormGroup.invalid),o(3),m("ngIf",t.detaleConsumo))},dependencies:[X,ie,S,he,ce,de,pe,ue,Se,me,ne,ae,ge,re,oe,ye,Ie,Ae,Ve,qe,K,U,Ne,be,fe,ve,z]});let a=l;return a})();function it(a){return l=>{let d=l.value;return console.log(a),d>a?{notEqual:!0}:null}}var Jt=[{path:"",component:$e}];export{Jt as default};
