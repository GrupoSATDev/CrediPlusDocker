import{a as E}from"./chunk-3UDRACIS.js";import{a as ce}from"./chunk-Z2MQWE4K.js";import{a as ne,b as me,c as le}from"./chunk-B7LJFNKT.js";import{a as G}from"./chunk-6IEWE3OU.js";import{a as de}from"./chunk-ACIMG2KZ.js";import{a as re}from"./chunk-AWPER4JR.js";import{a as V,b as se}from"./chunk-2RSQTUPN.js";import{a as M}from"./chunk-OFEOPKCC.js";import"./chunk-33XTDNRI.js";import{a as ae}from"./chunk-JPRW2DCB.js";import"./chunk-CHOSRW5W.js";import{g as K}from"./chunk-QS2WZY2K.js";import{a as L,b as $,c as W}from"./chunk-JND367CQ.js";import"./chunk-7U4JZNVG.js";import{C as oe,G as _,b as Z,e as q,i as w,l as Q,p as U,q as X,u as Y,w as ee,x as te,z as ie}from"./chunk-JLNARVDU.js";import{Q as z,R as B,ea as C,ja as J}from"./chunk-DARKUWJB.js";import"./chunk-EENLYY7H.js";import"./chunk-PDEGUYSW.js";import{j}from"./chunk-NP3GUERB.js";import{Cb as o,Db as a,Eb as d,Ib as O,Ob as g,Xb as F,Yb as l,Za as s,_a as y,_b as N,dc as R,ec as T,fa as c,ka as S,q as H,rb as m,ua as D,va as x}from"./chunk-32HXX3OB.js";import{a as u,d as b}from"./chunk-NEB6MB4Y.js";var P=(()=>{let n=class n{constructor(){this.fb=c(ie),this.dialogRef=c(L),this.fuseService=c(K),this.estadosDatosService=c(M),this.toasService=c(se),this._matData=c($),this.datePipe=c(j),this.tasasService=c(E),this.swalService=c(de)}ngOnInit(){this.createForm();let t=this._matData;if(t.edit){let e=t.data,{estado:r}=e,p=b(e,["estado"]);this.form.patchValue(u({estado:r=="Activo"},p))}}onSave(){if(this.form.valid)if(this._matData.edit){let e=this.form.getRawValue(),{porcentaje:r,vigencia:p}=e,v=b(e,["porcentaje","vigencia"]),I=this.datePipe.transform(p,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),k=u({vigencia:I,porcentaje:Number(r)},v);this.fuseService.open(u({},V)).afterClosed().subscribe(A=>{A==="confirmed"?this.tasasService.putTasas(k).subscribe(h=>{this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro actualizado con exito!",timer:4e3}),this.closeDialog()},h=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al actualizar el registro!",timer:4e3})}):this.closeDialog()})}else{let t=this.form.getRawValue(),{porcentaje:r,vigencia:p}=t,v=b(t,["porcentaje","vigencia"]),I=this.datePipe.transform(p,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),k=u({vigencia:I,porcentaje:Number(r)},v);this.fuseService.open(u({},V)).afterClosed().subscribe(A=>{A==="confirmed"?this.tasasService.postTasas(k).subscribe(h=>{console.log(h),this.estadosDatosService.stateGrid.next(!0),this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.closeDialog()},h=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})}):this.closeDialog()})}}createForm(){this.form=this.fb.group({id:[null],porcentaje:[""],vigencia:[""],nombre:[""],estado:["true"]})}closeDialog(){this.dialogRef.close()}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=S({type:n,selectors:[["app-form-tasas"]],standalone:!0,features:[R([{provide:B,useClass:ce},{provide:z,useValue:"en-GB"},j]),T],decls:33,vars:10,consts:[["twoStepToggle",""],["picker",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:w-96","max-w-96","sm:mx-0","mx-auto"],[1,""],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8",3,"formGroup"],[1,"flex","mb-4"],[1,"fcursor-pointer",3,"click"],[1,"font-medium","leading-6"],[1,"ml-4",3,"color","formControlName"],[1,"w-full"],["matInput","","placeholder","Nombre",3,"formControlName"],["matInput","","placeholder","Porcentaje %",3,"formControlName"],["matInput","",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],[1,"flex","flex-wrap","justify-end","gap-2.5"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click"]],template:function(e,i){if(e&1){let r=O();o(0,"div",2)(1,"div",3)(2,"div",4),l(3),a(),o(4,"form",5)(5,"div",6)(6,"div",7),g("click",function(){D(r);let v=F(10);return x(v.toggle())}),o(7,"div",8),l(8),a()(),d(9,"mat-slide-toggle",9,0),a(),o(11,"mat-form-field",10)(12,"mat-label"),l(13,"Nombre"),a(),d(14,"input",11),a(),o(15,"mat-form-field",10)(16,"mat-label"),l(17,"Porcentaje %"),a(),d(18,"input",12),a(),o(19,"mat-form-field",10)(20,"mat-label"),l(21,"Vigencia"),a(),d(22,"input",13)(23,"mat-datepicker-toggle",14)(24,"mat-datepicker",null,1),a(),o(26,"div",15)(27,"button",16),g("click",function(){return D(r),x(i.closeDialog())}),o(28,"span"),l(29," Cancelar "),a()(),o(30,"button",17),g("click",function(){return D(r),x(i.onSave())}),o(31,"span"),l(32," Guardar "),a()()()()()()}if(e&2){let r=F(25);s(3),N(" ",i._matData.edit?"Actualizar tasa":"Agregar tasa"," "),s(),m("formGroup",i.form),s(4),N(" Estado ",i.form.get("estado").value?"Activo":"Inactivo"," "),s(),m("color","primary")("formControlName","estado"),s(5),m("formControlName","nombre"),s(4),m("formControlName","porcentaje"),s(4),m("matDatepicker",r)("formControlName","vigencia"),s(),m("for",r)}},dependencies:[C,w,_,Z,oe,Y,Q,U,X,ee,te,ne,me,le,q,ae]});let f=n;return f})();var pe=(()=>{let n=class n{constructor(t,e,i){this._matDialog=t,this.estadoDatosService=e,this.tasasService=i,this.data=[],this.columns=["Estado","Nombre","Porcentaje %"],this.columnPropertyMap={Estado:"estado",Nombre:"nombre","Porcentaje %":"porcentaje"},this.buttons=[{label:"Edit",icon:"edit",action:r=>{console.log("Editing",r),this.selectedData=r,this.onEdit()}}]}onNew(){this._matDialog.open(P,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",maxWidth:"100%",disableClose:!0})}onEdit(){this._matDialog.open(P,{autoFocus:!1,data:{edit:!0,data:this.selectedData},maxHeight:"90vh",maxWidth:"100%",disableClose:!0})}getTasas(){this.subcription$=this.tasasService.getTass().pipe(H(t=>(t.data.forEach(e=>{e.estado?e.estado=G.ACTIVO:e.estado=G.INACTIVO}),t))).subscribe(t=>{this.data=t.data})}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(e=>{e&&this.getTasas()})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getTasas(),this.listenGrid()}};n.\u0275fac=function(e){return new(e||n)(y(W),y(M),y(E))},n.\u0275cmp=S({type:n,selectors:[["app-grid-tasas"]],standalone:!0,features:[T],decls:15,vars:10,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","rounded-lg","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],["mat-flat-button","",1,"ml-4","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),l(3,"Tasas de interes"),a(),o(4,"div",3)(5,"mat-form-field",4),d(6,"mat-icon",5)(7,"input",6),a(),o(8,"button",7),g("click",function(){return i.onNew()}),d(9,"mat-icon",8),o(10,"span",9),l(11,"Agregar"),a()()()(),o(12,"div",10)(13,"div",11),d(14,"app-custom-table",12),a()()()),e&2&&(s(5),m("subscriptSizing","dynamic"),s(),m("svgIcon","heroicons_solid:magnifying-glass"),s(),m("autocomplete","off")("placeholder","Buscar"),s(2),m("svgIcon","heroicons_outline:plus"),s(5),m("columns",i.columns)("displayedColumns",i.columns)("columnPropertyMap",i.columnPropertyMap)("data",i.data)("buttons",i.buttons))},dependencies:[re,C,w,J,_]});let f=n;return f})();var Ke=[{path:"",component:pe}];export{Ke as default};
