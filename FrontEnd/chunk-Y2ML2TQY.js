import{a as w}from"./chunk-HJATFB5E.js";import{a as le}from"./chunk-HLQ77KX7.js";import{a as me}from"./chunk-FMZRTJU7.js";import{a as $,b as ce}from"./chunk-2RSQTUPN.js";import{a as y}from"./chunk-OFEOPKCC.js";import{a as se}from"./chunk-33XTDNRI.js";import"./chunk-CHOSRW5W.js";import{g as Y}from"./chunk-QS2WZY2K.js";import{a as q,b as K,c as Q}from"./chunk-JND367CQ.js";import"./chunk-7U4JZNVG.js";import{C as ne,G as E,b as U,i as D,l as Z,p as ee,q as te,u as ie,w as oe,x as ae,z as re}from"./chunk-JLNARVDU.js";import{$ as J,ea as x,ja as X}from"./chunk-DARKUWJB.js";import"./chunk-EENLYY7H.js";import"./chunk-DDPHQILY.js";import{f as j,g as L,i as H,m as W}from"./chunk-NP3GUERB.js";import{Cb as r,Db as o,Eb as p,Fb as V,Gb as A,Ib as P,Ob as g,X as T,Yb as l,Za as i,Zb as G,_a as _,_b as k,ec as C,fa as u,ka as v,mc as z,nc as R,pb as h,rb as a,ua as b,va as S}from"./chunk-32HXX3OB.js";import{a as I,d as N}from"./chunk-NEB6MB4Y.js";function ue(m,s){if(m&1&&(r(0,"mat-option",20),l(1),o()),m&2){let d=s.$implicit;a("value",d.id),i(),G(d.nombre)}}function fe(m,s){if(m&1&&(V(0),h(1,ue,2,2,"mat-option",19),A()),m&2){let d=s.ngIf;i(),a("ngForOf",d.data)}}function ge(m,s){if(m&1&&(r(0,"mat-option",20),l(1),o()),m&2){let d=s.$implicit;a("value",d.id),i(),G(d.nombre)}}function he(m,s){if(m&1&&(V(0),h(1,ge,2,2,"mat-option",19),A()),m&2){let d=s.ngIf;i(),a("ngForOf",d.data)}}var O=(()=>{let s=class s{constructor(){this.fb=u(re),this._locacionService=u(le),this.empresasService=u(w),this.dialogRef=u(q),this.fuseService=u(Y),this.estadosDatosService=u(y),this.toasService=u(ce),this.departamentos$=this._locacionService.getDepartamentos().pipe(T(n=>{let e=n.data,t=this._matData;if(e&&!t.edit){this.form.get("idDepartamento").setValue(e[0].id);let c=this.form.get("idDepartamento").value;this.getMunicipios(c)}})),this._matData=u(K)}onSelected(n){let e=n.value;this.getMunicipios(e)}getMunicipios(n){this.municipios$=this._locacionService.getMunicipio(n).pipe(T(e=>{let t=e.data,c=this._matData;t&&!c.edit&&this.form.get("idMunicipio").setValue(t[0].id)}))}ngOnInit(){this.createForm();let n=this._matData;if(n.edit){let e=n.data;this.form.patchValue(e);let{idDepartamento:t}=e;this.municipios$=this._locacionService.getMunicipio(t)}}createForm(){this.form=this.fb.group({id:[null],nit:[""],razonSocial:[""],correo:[""],telefono:[""],direccion:[""],idDepartamento:[""],idMunicipio:[""]})}onSave(){if(this.form.valid)if(this._matData.edit){let e=this.form.getRawValue(),{idDepartamento:c}=e,f=N(e,["idDepartamento"]);this.fuseService.open(I({},$)).afterClosed().subscribe(F=>{F==="confirmed"?this.empresasService.putEmpresa(f).subscribe(B=>{this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro actualizado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}else{let n=this.form.getRawValue(),{idDepartamento:c}=n,f=N(n,["idDepartamento"]);this.fuseService.open(I({},$)).afterClosed().subscribe(F=>{F==="confirmed"?this.empresasService.postEmpresa(f).subscribe(B=>{console.log(B),this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}}closeDialog(){this.dialogRef.close()}};s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=v({type:s,selectors:[["app-form-empresas"]],standalone:!0,features:[C],decls:49,vars:18,consts:[["data",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[1,""],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8",3,"formGroup"],[1,"flex","flex-col","lg:flex-row","mb-4","gap-2"],["floatLabel","always",1,"w-full"],["id","nit","matInput","","placeholder","Nit",3,"formControlName"],["matInput","","placeholder","Raz\xF3n social",3,"formControlName"],["matInput","","placeholder","Correo electronico",3,"formControlName"],["matInput","","placeholder","Tel\xE9fono",3,"formControlName"],["placeholder","Departamento",3,"selectionChange","formControlName"],[4,"ngIf"],["placeholder","Ciudad",3,"formControlName"],[1,"flex","flex-col","sm:flex-row","mb-4","gap-2"],["matInput","","placeholder","Direcci\xF3n",3,"formControlName"],[1,"flex","flex-wrap","justify-end","gap-2.5"],["mat-flat-button","",1,"lg:w-auto","w-full","lg:mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"lg:w-auto","w-full","lg:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(e&1){let c=P();r(0,"div",1)(1,"div",2)(2,"div",3),l(3),o(),r(4,"form",4)(5,"div",5)(6,"mat-form-field",6)(7,"mat-label"),l(8,"Nit"),o(),p(9,"input",7),o(),r(10,"mat-form-field",6)(11,"mat-label"),l(12,"Raz\xF3n social"),o(),p(13,"input",8),o()(),r(14,"div",5)(15,"mat-form-field",6)(16,"mat-label"),l(17,"Correo"),o(),p(18,"input",9),o(),r(19,"mat-form-field",6)(20,"mat-label"),l(21,"Tel\xE9fono"),o(),p(22,"input",10),o()(),r(23,"div",5)(24,"mat-form-field",6)(25,"mat-label"),l(26,"Departamento"),o(),r(27,"mat-select",11,0),g("selectionChange",function(M){return b(c),S(t.onSelected(M))}),h(29,fe,2,1,"ng-container",12),z(30,"async"),o()(),r(31,"mat-form-field",6)(32,"mat-label"),l(33,"Ciudad"),o(),r(34,"mat-select",13),h(35,he,2,1,"ng-container",12),z(36,"async"),o()()(),r(37,"div",14)(38,"mat-form-field",6)(39,"mat-label"),l(40,"Direcci\xF3n"),o(),p(41,"input",15),o()(),r(42,"div",16)(43,"button",17),g("click",function(){return b(c),S(t.closeDialog())}),r(44,"span"),l(45," Cancelar "),o()(),r(46,"button",18),g("click",function(){return b(c),S(t.onSave())}),r(47,"span"),l(48),o()()()()()()}e&2&&(i(3),k(" ",t._matData.edit?"Actualizar empresa":"Agregar empresa"," "),i(),a("formGroup",t.form),i(5),a("formControlName","nit"),i(4),a("formControlName","razonSocial"),i(5),a("formControlName","correo"),i(4),a("formControlName","telefono"),i(5),a("formControlName","idDepartamento"),i(2),a("ngIf",R(30,14,t.departamentos$)),i(5),a("formControlName","idMunicipio"),i(),a("ngIf",R(36,16,t.municipios$)),i(6),a("formControlName","direccion"),i(2),a("color","primary"),i(3),a("color","primary"),i(2),k(" ",t._matData.edit?"Actualizar":"Guardar"," "))},dependencies:[D,E,x,U,se,J,L,H,j,ne,ie,Z,ee,te,oe,ae],styles:[".custom-dialog-container{width:100%}@media (min-width: 600px){  .custom-dialog-container{width:60%}}@media (min-width: 1280px){  .custom-dialog-container{width:50%}}"]});let m=s;return m})();var pe=(()=>{let s=class s{constructor(n,e,t){this._matDialog=n,this.empresasService=e,this.estadoDatosService=t,this.searchTerm="",this.data=[],this.columns=["Nit","Razon social","Correo","Telefono","Direccion"],this.columnPropertyMap={Nit:"nit","Razon social":"razonSocial",Correo:"correo",Telefono:"telefono",Direccion:"direccion"},this.buttons=[{label:"Edit",icon:"edit",action:c=>{console.log("Editing",c),this.selectedData=c,this.onEdit()}}]}onNew(){this._matDialog.open(O,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",width:"50%",disableClose:!0,panelClass:"custom-dialog-container"})}onEdit(){this._matDialog.open(O,{autoFocus:!1,data:{edit:!0,data:this.selectedData},maxHeight:"90vh",width:"50%",disableClose:!0,panelClass:"custom-dialog-container"})}getEmpresas(){this.subcription$=this.empresasService.getEmpresas().subscribe(n=>{this.data=n.data})}ngOnInit(){this.getEmpresas(),this.listenGrid()}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(e=>{e&&this.getEmpresas()})}onSearch(n){let e=n.target;this.searchTerm=e.value.trim().toLowerCase()}ngOnDestroy(){this.subcription$.unsubscribe()}ngAfterViewInit(){}};s.\u0275fac=function(e){return new(e||s)(_(Q),_(w),_(y))},s.\u0275cmp=v({type:s,selectors:[["app-grid-empresas"]],standalone:!0,features:[C],decls:15,vars:12,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],["mat-flat-button","",1,"mt-2","w-full","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold","sm:ml-4","sm:mt-0","sm:w-auto",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons","searchTerm"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),l(3,"Empresas Maestras"),o(),r(4,"div",3)(5,"mat-form-field",4),p(6,"mat-icon",5),r(7,"input",6),g("input",function(f){return t.onSearch(f)}),o()(),r(8,"button",7),g("click",function(){return t.onNew()}),p(9,"mat-icon",8),r(10,"span",9),l(11,"Agregar"),o()()()(),r(12,"div",10)(13,"div",11),p(14,"app-custom-table",12),o()()()),e&2&&(i(5),a("subscriptSizing","dynamic"),i(),a("svgIcon","heroicons_solid:magnifying-glass"),i(),a("autocomplete","off")("placeholder","Buscar"),i(),a("color","primary"),i(),a("svgIcon","heroicons_outline:plus"),i(5),a("columns",t.columns)("displayedColumns",t.columns)("columnPropertyMap",t.columnPropertyMap)("data",t.data)("buttons",t.buttons)("searchTerm",t.searchTerm))},dependencies:[W,D,X,x,E,me]});let m=s;return m})();var Ue=[{path:"",component:pe}];export{Ue as default};
