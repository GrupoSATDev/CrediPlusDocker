import{a as De}from"./chunk-IM3AUN4N.js";import{a as we}from"./chunk-TDF4EJJB.js";import{a as k}from"./chunk-FAEUQIFQ.js";import{a as Fe,b as x}from"./chunk-P4PAYY2C.js";import{a as Ce,b as _e,c as xe}from"./chunk-LZ3ZEVTF.js";import{a as Te}from"./chunk-DTORAJAR.js";import{a as ve}from"./chunk-3R6HD5RM.js";import{a as ge}from"./chunk-CJO6YW5P.js";import"./chunk-7YBFULQ5.js";import{g as re,h as be}from"./chunk-QVE5MGEQ.js";import{C as fe,F as he,J as Se,b as ee,e as te,i as oe,l as le,n as _,p as ce,q as me,s as pe,u as se,x as de,y as ue}from"./chunk-4PVPKBBG.js";import{e as ne}from"./chunk-KAEQCOKJ.js";import"./chunk-YKJB7XET.js";import{h as Z}from"./chunk-FUOI65R5.js";import{a as ye}from"./chunk-73F67TFK.js";import"./chunk-XTYNXB3F.js";import"./chunk-PA2SJPJO.js";import{$a as g,Ad as W,Eb as w,Fb as u,Gb as X,Ka as o,Md as Y,Ob as O,Pb as B,Sb as G,Xb as $,Yb as q,Z as j,bb as i,fe as ie,ga as f,ib as N,ka as P,ke as ae,mb as l,nb as r,ob as v,pb as R,pc as z,q as I,qb as V,qc as U,rc as H,sb as A,ua as b,uc as J,va as y,vb as C,vc as F,xb as L,xc as K,yc as D,zd as Q}from"./chunk-ODJKW74N.js";import{a as T,d as M}from"./chunk-NEB6MB4Y.js";var Ee=(t,n)=>({"bg-green-700":t,"bg-credigray-100":n});function Me(t,n){if(t&1&&(l(0,"mat-option",21),u(1),r()),t&2){let s=n.$implicit;i("value",s.id),o(),X(s.nombre)}}function Ie(t,n){if(t&1&&(R(0),g(1,Me,2,2,"mat-option",20),V()),t&2){let s=n.ngIf;o(),i("ngForOf",s.data)}}function je(t,n){if(t&1&&(l(0,"div",19)(1,"div",22),v(2,"app-custom-table",23),r()()),t&2){let s=L();o(2),i("columns",s.columns)("displayedColumns",s.columns)("columnPropertyMap",s.columnPropertyMap)("data",s.data)("searchTerm",s.searchTerm)}}function Pe(t,n){t&1&&(l(0,"div",24)(1,"div",25)(2,"fuse-alert",26)(3,"span",27),u(4,"Informaci\xF3n"),r(),u(5," No hay informaci\xF3n hasta el momento. "),r()()()),t&2&&(o(2),i("type","info")("appearance","outline"))}function Ne(t,n){t&1&&g(0,Pe,6,2,"ng-template")}var ke=(()=>{let n=class n{constructor(){this.searchTerm="",this.fb=f(fe),this.reportesService=f(De),this.datePipe=f(F),this.estados=new pe([""]),this.data=[],this.aesEncriptService=f(ne),this.tipoSolicitudesService=f(we),this.currencyPipe=f(D),this.exportData=[],this.fuseService=f(re),this.columns=["N\xFAmero de solicitud","Fecha de solicitud","Cupo","Trabajador","Identificaci\xF3n","Salario devengado","Inicio de contrato","Fin de contrato","Empresa","Tipo de solicitud"],this.columnPropertyMap={"N\xFAmero de solicitud":"numSolicitud","Fecha de solicitud":"fechaCreacion",Cupo:"cupo",Trabajador:"nombreTrabajador",Identificaci\u00F3n:"documetoTrabajador","Salario devengado":"salarioDevengadoTrabajador","Inicio de contrato":"fechaInicioContratoTrabajador","Fin de contrato":"fechaFinContratoTrabajador",Empresa:"nombreSubEmpresa","Tipo de solicitud":"nombreTipoSolicitud"},this.solicitudes$=this.tipoSolicitudesService.getTipos().pipe(j(c=>{let a=c.data;a&&(a.unshift({id:"null",nombre:"Todos"}),this.form.get("idTipoSolicitud").setValue(a[0].id))}))}onSearch(c){let a=c.target;this.searchTerm=a.value.trim().toLowerCase()}onSelect(c){let a=c.value}ngOnInit(){this.createForm()}onConsultar(){if(this.form.valid){let c=this.form.getRawValue(),{fechaInicio:a,fechaFinal:e}=c,m=M(c,["fechaInicio","fechaFinal"]),p=this.datePipe.transform(a,"yyyy-MM-dd"),S=this.datePipe.transform(e,"yyyy-MM-dd"),E=T({fechaInicio:p,fechaFinal:S},m);console.log(E),this.reportesService.getReporteSolicitudes(E).pipe(I(h=>(h.data.forEach(d=>{d.fechaCreacion=this.datePipe.transform(d.fechaCreacion,"dd/MM/yyyy"),d.fechaInicioContratoTrabajador=this.datePipe.transform(d.fechaInicioContratoTrabajador,"dd/MM/yyyy"),d.fechaFinContratoTrabajador=this.datePipe.transform(d.fechaFinContratoTrabajador,"dd/MM/yyyy"),d.cupo=this.currencyPipe.transform(d.cupo,"USD","symbol","1.2-2"),d.salarioDevengadoTrabajador=this.currencyPipe.transform(d.salarioDevengadoTrabajador,"USD","symbol","1.2-2")}),h))).subscribe(h=>{h.data?(this.data=h.data,this.convertDataExportFijos(h.data)):this.data=[]})}}convertDataExportFijos(c){let a=c.map(e=>({NumeroSolicitud:e.numSolicitud,FechaSolicitud:e.fechaCreacion,Cupo:k(e.cupo),Trabajador:e.nombreTrabajador,Identificaci\u00F3n:e.documetoTrabajador,Salariodevengado:k(e.salarioDevengadoTrabajador),Iniciodecontrato:e.fechaInicioContratoTrabajador,Findecontrato:e.fechaFinContratoTrabajador,Empresa:e.nombreSubEmpresa,TipodeSolicitud:e.nombreTipoSolicitud}));this.exportData=a}exportToExcel(c){this.fuseService.open(T({},be)).afterClosed().subscribe(e=>{if(e==="confirmed"){let m=x.json_to_sheet(c),p=x.book_new();x.book_append_sheet(p,m,"Sheet1"),Fe(p,`Reporte de solicitudes${this.datePipe.transform(new Date,"dd/MM/yyyy")}.xlsx`)}})}createForm(){this.form=this.fb.group({idTipoSolicitud:["",_.required],fechaInicio:["",_.required],fechaFinal:["",_.required]})}};n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=P({type:n,selectors:[["app-reporte-solicitudes"]],standalone:!0,features:[O([{provide:W,useClass:Te},{provide:Q,useValue:"en-GB"},F,D,K]),B],decls:38,vars:23,consts:[["inicioPicker",""],["finalPicker",""],["cdkScrollable","",1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],[1,"px-6","border-b","mt-6","w-full","shrink-0","sm:mt-0","sm:space-x-2","lg:w-full"],[1,"flex","flex-col","sm:flex-row","gap-2.5",3,"formGroup"],[1,"w-full","sm:w-1/2"],[3,"selectionChange","formControlName"],[4,"ngIf"],["floatLabel","always",1,"w-full","sm:w-1/2"],["matInput","","placeholder","dd/mm/yyyy",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],["mat-flat-button","",1,"sm:w-1/6","w-full","sm:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:sm:w-1/6","w-full","sm:mt-6","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color","ngClass","disabled"],[1,"flex","flex-auto","overflow-hidden"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","searchTerm"],[1,"inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-4","sm:p-2","print:p-0","w-full"],[3,"type","appearance"],["fuseAlertTitle",""]],template:function(a,e){if(a&1){let m=A();l(0,"div",2)(1,"div",3)(2,"div",4),u(3,"Reporte de Solicitudes"),r(),l(4,"div",5)(5,"mat-form-field",6),v(6,"mat-icon",7),l(7,"input",8),C("input",function(S){return b(m),y(e.onSearch(S))}),r()()()(),l(8,"div",9)(9,"form",10)(10,"mat-form-field",11)(11,"mat-label"),u(12,"Estados"),r(),l(13,"mat-select",12),C("selectionChange",function(S){return b(m),y(e.onSelect(S))}),g(14,Ie,2,1,"ng-container",13),$(15,"async"),r()(),l(16,"mat-form-field",14)(17,"mat-label"),u(18,"Fecha de inicio"),r(),v(19,"input",15)(20,"mat-datepicker-toggle",16)(21,"mat-datepicker",null,0),r(),l(23,"mat-form-field",14)(24,"mat-label"),u(25,"Fecha fin"),r(),v(26,"input",15)(27,"mat-datepicker-toggle",16)(28,"mat-datepicker",null,1),r(),l(30,"button",17),C("click",function(){return b(m),y(e.onConsultar())}),l(31,"span"),u(32," Consultar "),r()(),l(33,"button",18),C("click",function(){return b(m),y(e.exportToExcel(e.exportData))}),l(34,"span"),u(35," Exportar "),r()()()(),g(36,je,3,5,"div",19)(37,Ne,1,0),r()}if(a&2){let m=w(22),p=w(29);o(5),i("subscriptSizing","dynamic"),o(),i("svgIcon","heroicons_solid:magnifying-glass"),o(),i("autocomplete","off")("placeholder","Buscar"),o(2),i("formGroup",e.form),o(4),i("formControlName","idTipoSolicitud"),o(),i("ngIf",q(15,18,e.solicitudes$)),o(5),i("matDatepicker",m)("formControlName","fechaInicio"),o(),i("for",m),o(6),i("matDatepicker",p)("formControlName","fechaFinal"),o(),i("for",p),o(3),i("color","primary"),o(3),i("color","primary")("ngClass",G(20,Ee,e.exportData.length,!e.exportData.length))("disabled",!e.exportData.length),o(3),N(e.data.length>0?36:37)}},dependencies:[J,Z,ve,ye,ie,Ce,_e,xe,oe,ae,Se,ee,Y,ge,te,U,H,he,se,le,ce,me,de,ue,z]});let t=n;return t})();var mt=[{path:"",component:ke}];export{mt as default};
