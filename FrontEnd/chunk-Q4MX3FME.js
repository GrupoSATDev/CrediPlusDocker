import{a as Te,b as Ie}from"./chunk-Y7OFQJGV.js";import{a as Ae}from"./chunk-I6FYLBSO.js";import{a as Ee,b as _e,c as De,d as we}from"./chunk-LVIWDW4T.js";import{a as Ne}from"./chunk-D3LMVGHO.js";import{a as Ge}from"./chunk-DM4QBTWH.js";import{a as be}from"./chunk-E27GYA5F.js";import{a as Fe}from"./chunk-TB655AZI.js";import{a as ye,b as Se}from"./chunk-BAD57Q24.js";import{a as ve}from"./chunk-YEQVMDAS.js";import{a as xe}from"./chunk-ACIMG2KZ.js";import{a as Ce,b as he}from"./chunk-GD676RBR.js";import{a as ge}from"./chunk-OFEOPKCC.js";import{a as fe}from"./chunk-QYSIOB6Y.js";import{g as te}from"./chunk-CUGJBCL5.js";import"./chunk-3P4FUJJD.js";import{h as U}from"./chunk-4CCKGQO6.js";import{a as ce}from"./chunk-WHODWZY4.js";import"./chunk-ZFQVSUZG.js";import{B as pe,C as se,G as ue,b as X,c as Y,i as Z,l as ie,n as u,p as re,q as ne,u as ae,w as me,x as le,z as de}from"./chunk-7YVLRDAA.js";import{$ as K,Q as J,R as W,ea as ee}from"./chunk-T34F2ICN.js";import{a as oe}from"./chunk-WDNNZS2B.js";import"./chunk-XMIUBE2U.js";import"./chunk-PDEGUYSW.js";import{d as H}from"./chunk-HGIHZLIS.js";import{e as $,f as B,g as L,i as Q,j as S,m as z}from"./chunk-YH7HM3TK.js";import{Cb as t,Db as e,Eb as c,Fb as _,Gb as D,Ib as q,Ob as w,Qb as N,Ub as V,Vb as M,Wb as k,Yb as i,Za as o,Zb as v,_b as G,dc as P,ec as R,fa as s,hc as j,ka as A,l as b,mc as g,nc as y,oc as O,pb as f,rb as n,ua as F,va as E}from"./chunk-32HXX3OB.js";import{a as x,d as I}from"./chunk-NEB6MB4Y.js";var ke=["stepper"],Pe=(m,l)=>({"bg-crediblue-50":m,"bg-credigray-100":l});function Re(m,l){if(m&1&&(t(0,"mat-option",34),i(1),e()),m&2){let d=l.$implicit;n("value",d.id),o(),v(d.nombre)}}function je(m,l){if(m&1&&(_(0),f(1,Re,2,2,"mat-option",33),D()),m&2){let d=l.ngIf;o(),n("ngForOf",d.data)}}function Oe(m,l){m&1&&(t(0,"mat-error"),i(1," El tipo de documento es requerido!. "),e())}function $e(m,l){m&1&&(t(0,"mat-error"),i(1," El n\xFAmero de identificaci\xF3n es requerido!. "),e())}function Be(m,l){if(m&1&&(t(0,"fuse-alert",35),i(1),e()),m&2){let d=N();n("appearance","outline")("showIcon",!1)("type",d.alert.type)("@shake",d.alert.type==="error"),o(),G(" ",d.alert.message," ")}}function Le(m,l){if(m&1&&(t(0,"mat-option",34),i(1),e()),m&2){let d=l.$implicit;n("value",d.id),o(),v(d.nombre)}}function Qe(m,l){if(m&1&&(_(0),f(1,Le,2,2,"mat-option",33),D()),m&2){let d=l.ngIf;o(),n("ngForOf",d.data)}}function ze(m,l){m&1&&(t(0,"mat-error"),i(1,"El valor es requerido!"),e())}function He(m,l){m&1&&(t(0,"mat-error"),i(1,"El valor ingresado no puede superar el cupo disponible!"),e())}function Je(m,l){if(m&1&&(t(0,"div",36)(1,"div",37)(2,"div",38)(3,"h2",39),i(4,"Resumen de la Compra"),e(),t(5,"p",40),i(6,"Revise los detalles"),e()(),t(7,"div",41)(8,"div",42)(9,"div")(10,"h3",43),i(11,"Fecha de compra"),e()(),t(12,"p",44),i(13),g(14,"date"),e()(),t(15,"div",42)(16,"div")(17,"h3",43),i(18,"N\xFAmero de factura"),e()(),t(19,"p",44),i(20),e()(),t(21,"div",42)(22,"div")(23,"h3",43),i(24,"Valor $"),e(),t(25,"p",40),i(26,"Indica el valor en COP"),e()(),t(27,"p",44),i(28),g(29,"currency"),e()(),t(30,"div",45)(31,"p",43),i(32,"N\xFAmero de cuotas"),e(),t(33,"p",44),i(34),e()(),t(35,"div",46)(36,"p",43),i(37,"Estado"),e(),t(38,"p",44),i(39),e()(),t(40,"div",47)(41,"p",43),i(42,"Detalle compra"),e(),t(43,"p",44),i(44),e()()(),t(45,"div",48)(46,"button",49),i(47," Recargar "),e()()()()),m&2){let d=N();o(13),v(O(14,6,d.detaleConsumo.fechaCreacion,"dd/MM/yyyy")),o(7),v(d.detaleConsumo.numeroFactura),o(8),v(y(29,9,d.detaleConsumo.montoConsumo)),o(6),v(d.detaleConsumo.cantidadCuotas),o(5),v(d.detaleConsumo.nombreEstadoCredito),o(5),v(d.detaleConsumo.detalleCompra)}}var We={validation:!1},qe=(()=>{let l=class l{constructor(){this.tiposDocumentosService=s(Fe),this.fuseService=s(te),this.estadosDatosService=s(ge),this.toasService=s(he),this.empleadosServices=s(Ne),this.tipoConsumosService=s(Ie),this.cuentasServices=s(Ae),this.datePipe=s(S),this.router=s(H),this.fb=s(de),this._locacionService=s(ve),this.detalleConsumo=s(Ge),this.departamentos$=this._locacionService.getDepartamentos(),this.tipoConsumo$=this.tipoConsumosService.getTipoConsumos(),this.cuentas$=this.cuentasServices.getCuentas(),this.swalService=s(xe),this.showAlert=!1,this.alert={type:"success",message:""},this.tiposDocumentos$=this.tiposDocumentosService.getTiposDocumentos(),this.creditos=[],this.focus=focus,this.FormatoOptionsPipe=Te}ngOnDestroy(){}ngOnInit(){this.createForm()}getMunicipios(p){let a=p.value;this.municipios$=this._locacionService.getMunicipio(a)}selected(p){let a=p.value;this.compareValor=a.cupoDisponible,this.thirdFormGroup.get("montoConsumo").setValidators(Ke(this.compareValor)),this.thirdFormGroup.get("montoConsumo").updateValueAndValidity()}compareWithConstants(p){let a=p.value,r=this.secondFormGroup.get("idCredito")?.value;return!r||!r.montoConsumo?(console.error("No se encontr\xF3 el objeto idCredito o montoConsumo"),b(null)):(console.log(a),console.log(r.montoConsumo),a>r.montoConsumo?b({notEqual:!0}):b(null))}get montoConsumo(){return this.thirdFormGroup.get("montoConsumo")}onSearch(){let p=this.firstFormGroup.getRawValue();this.empleadosServices.getEmpleadoParams(p).subscribe(a=>{if(console.log(a),a){this.showAlert=!1;let r={numDoc:a.data.numDoc,primerNombre:a.data.primerNombre,segundoNombre:a.data.segundoNombre,primerApellido:a.data.primerApellido,segundoApellido:a.data.segundoApellido,idTrabajador:a.data.id,correo:a.data.correo,credito:a.data.creditos[0].numCredito+" - "+a.data.creditos[0].cupoDisponible,idCredito:a.data.creditos[0].id};this.secondFormGroup.patchValue(r),this.creditos=a.data.creditos,setTimeout(()=>{this.stepper.next()},1200)}},a=>{this.alert={type:"error",message:"El empleado no existe!"},this.showAlert=!0})}onSave(){if(this.thirdFormGroup.valid){let p=this.thirdFormGroup.getRawValue(),{montoConsumo:a}=p,r=I(p,["montoConsumo"]),{idCredito:C,idTrabajador:h}=this.secondFormGroup.getRawValue(),Ve=x({idCredito:C,idTrabajador:h,montoConsumo:Number(a)},r);this.fuseService.open(x({},Ce)).afterClosed().subscribe(Me=>{Me==="confirmed"&&this.detalleConsumo.postDetalle(Ve).subscribe(T=>{console.log(T),this.swalService.ToastAler({icon:"success",title:"Registro creado con exito!",timer:4e3}),this.getResumenCompra(h)},T=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})})})}}getResumenCompra(p){this.subscription$=this.detalleConsumo.getResumen(p).subscribe(a=>{a&&(console.log(a),this.detaleConsumo=a.data,this.stepper.next())})}createForm(){this.firstFormGroup=this.fb.group({idTipoDoc:["",u.required],numDocumento:["",u.required]}),this.secondFormGroup=this.fb.group({numDoc:["",u.required],primerNombre:["",u.required],segundoNombre:["",u.required],primerApellido:["",u.required],segundoApellido:["",u.required],idTrabajador:[""],correo:["",u.required],credito:["",u.required],idCredito:["",u.required]}),this.thirdFormGroup=this.fb.group({montoConsumo:["",[u.required]],numeroFactura:["",u.required],idTipoConsumo:["",u.required]})}};l.\u0275fac=function(a){return new(a||l)},l.\u0275cmp=A({type:l,selectors:[["app-form-detalle-consumo"]],viewQuery:function(a,r){if(a&1&&V(ke,5),a&2){let C;M(C=k())&&(r.stepper=C.first)}},standalone:!0,features:[P([{provide:W,useClass:be},{provide:J,useValue:"en-GB"},S,ye(We)]),R],decls:95,vars:48,consts:[["stepper",""],["data",""],["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","print:p-0","w-full"],[1,"sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto","overflow-hidden"],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[3,"linear"],["label","Consultar empleado",3,"stepControl"],[1,"flex","flex-col","items-center","justify-center","w-full","h-full","px-4"],[3,"formGroup"],[1,"w-full"],[3,"formControlName"],[4,"ngIf"],["matInput","","placeholder","Ingrese identificaci\xF3n",3,"formControlName"],["class","mb-4",3,"appearance","showIcon","type",4,"ngIf"],["mat-raised-button","",1,"text-white","px-6","py-2","rounded-md","w-full",3,"click","disabled","ngClass"],["label","Verificar informaci\xF3n",3,"stepControl"],[1,"w-full","h-full","px-4","shadow-lg"],[1,"flex","flex-row","gap-2.5"],["matInput","",3,"formControlName","readonly"],[1,"flex","flex-row"],[1,"flex","justify-end","gap-2.5","py-3"],["mat-button","","matStepperPrevious","",1,"bg-gray-500","text-white","py-2","px-4","rounded","hover:bg-gray-600"],["mat-button","","matStepperNext","",1,"bg-crediblue-50","text-white","py-2","px-4","rounded",3,"disabled"],["label","Completar compra",3,"stepControl"],[1,"h-full","mx-auto","px-4","w-1/2","shadow-lg"],[1,"flex","flex-row","items-baseline","gap-2.5"],["matInput","",3,"formControlName"],["matInput","","thousandSeparator",".",3,"formControlName","mask"],[1,"flex","justify-end","gap-2.5","py-4"],["mat-button","",1,"bg-crediblue-50","text-white","py-2","px-4","rounded",3,"click","disabled"],["label","Resumen de compra",3,"stepControl"],["class","w-full h-full px-4",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mb-4",3,"appearance","showIcon","type"],[1,"w-full","h-full","px-4"],[1,"max-w-2xl","mx-auto","p-4","bg-white","shadow-lg","rounded-lg"],[1,"border-b","pb-4","mb-4"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"space-y-4"],[1,"flex","justify-between","items-center","border-b","pb-2"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","justify-between","items-center","pt-4","border-t"],[1,"flex","justify-between","items-center"],[1,"flex","justify-between","items-center","border-t","pt-4"],[1,"mt-6"],[1,"w-full","bg-crediblue-50","text-white","py-2","px-4","rounded-lg"]],template:function(a,r){if(a&1){let C=q();t(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),i(4),e(),t(5,"mat-horizontal-stepper",6,0)(7,"mat-step",7)(8,"div",8)(9,"form",9)(10,"mat-form-field",10)(11,"mat-label"),i(12,"Tipo de documento"),e(),t(13,"mat-select",11),f(14,je,2,1,"ng-container",12),g(15,"async"),e(),f(16,Oe,2,0,"mat-error",12),e(),t(17,"mat-form-field",10)(18,"mat-label"),i(19,"N\xFAmero de identificaci\xF3n"),e(),c(20,"input",13),f(21,$e,2,0,"mat-error",12),e(),f(22,Be,2,5,"fuse-alert",14),t(23,"button",15),w("click",function(){return F(C),E(r.onSearch())}),i(24,"Consultar"),e()()()(),t(25,"mat-step",16)(26,"div",17)(27,"form",9)(28,"div",18)(29,"mat-form-field",10)(30,"mat-label"),i(31,"Primer nombre"),e(),c(32,"input",19),e(),t(33,"mat-form-field",10)(34,"mat-label"),i(35,"Segundo nombre"),e(),c(36,"input",19),e()(),t(37,"div",18)(38,"mat-form-field",10)(39,"mat-label"),i(40,"Primer apellido"),e(),c(41,"input",19),e(),t(42,"mat-form-field",10)(43,"mat-label"),i(44,"Segundo apellido"),e(),c(45,"input",19),e()(),t(46,"div",18)(47,"mat-form-field",10)(48,"mat-label"),i(49,"Identificaci\xF3n"),e(),c(50,"input",19),e(),t(51,"mat-form-field",10)(52,"mat-label"),i(53,"Email"),e(),c(54,"input",19),e()(),t(55,"div",20)(56,"mat-form-field",10)(57,"mat-label"),i(58,"Cr\xE9dito"),e(),c(59,"input",19),e()()(),t(60,"div",21)(61,"button",22),i(62,"Anterior"),e(),t(63,"button",23),i(64,"Siguiente"),e()()()(),t(65,"mat-step",24)(66,"div",25)(67,"form",9)(68,"div",26)(69,"mat-form-field",10)(70,"mat-label"),i(71,"N\xFAmero de factura"),e(),c(72,"input",27),e()(),t(73,"div",26)(74,"mat-form-field",10)(75,"mat-label"),i(76,"Tipo consumo"),e(),t(77,"mat-select",11,1),f(79,Qe,2,1,"ng-container",12),g(80,"async"),e()()(),t(81,"div",18)(82,"mat-form-field",10)(83,"mat-label"),i(84,"Valor"),e(),c(85,"input",28),f(86,ze,2,0,"mat-error",12)(87,He,2,0,"mat-error",12),e()()(),t(88,"div",29)(89,"button",22),i(90,"Anterior"),e(),t(91,"button",30),w("click",function(){return F(C),E(r.onSave())}),i(92,"Pagar"),e()()()(),t(93,"mat-step",31),f(94,Je,48,11,"div",32),e()()()()()}a&2&&(o(4),G(" ","Detalle consumo"," "),o(),n("linear",!0),o(2),n("stepControl",r.firstFormGroup),o(2),n("formGroup",r.firstFormGroup),o(4),n("formControlName","idTipoDoc"),o(),n("ngIf",y(15,41,r.tiposDocumentos$)),o(2),n("ngIf",r.firstFormGroup.get("idTipoDoc").dirty||r.firstFormGroup.get("idTipoDoc").touched&&r.firstFormGroup.get("idTipoDoc").errors.required),o(4),n("formControlName","numDocumento"),o(),n("ngIf",r.firstFormGroup.get("numDocumento").dirty||r.firstFormGroup.get("numDocumento").touched&&r.firstFormGroup.get("numDocumento").errors.required),o(),n("ngIf",r.showAlert),o(),n("disabled",r.firstFormGroup.invalid)("ngClass",j(45,Pe,r.firstFormGroup.valid,r.firstFormGroup.invalid)),o(2),n("stepControl",r.secondFormGroup),o(2),n("formGroup",r.secondFormGroup),o(5),n("formControlName","primerNombre")("readonly",!0),o(4),n("formControlName","segundoNombre")("readonly",!0),o(5),n("formControlName","primerApellido")("readonly",!0),o(4),n("formControlName","segundoApellido")("readonly",!0),o(5),n("formControlName","numDoc")("readonly",!0),o(4),n("formControlName","correo")("readonly",!0),o(5),n("formControlName","credito")("readonly",!0),o(4),n("disabled",r.secondFormGroup.invalid),o(2),n("stepControl",r.thirdFormGroup),o(2),n("formGroup",r.thirdFormGroup),o(5),n("formControlName","numeroFactura"),o(5),n("formControlName","idTipoConsumo"),o(2),n("ngIf",y(80,43,r.tipoConsumo$)),o(6),n("formControlName","montoConsumo")("mask","separator.0"),o(),n("ngIf",(r.montoConsumo.touched||r.montoConsumo.dirty)&&r.montoConsumo.hasError("required")),o(),n("ngIf",(r.montoConsumo.touched||r.montoConsumo.dirty)&&r.montoConsumo.hasError("notEqual")),o(4),n("disabled",r.thirdFormGroup.invalid),o(2),n("stepControl",r.thirdFormGroup),o(),n("ngIf",r.detaleConsumo))},dependencies:[_e,Ee,pe,ae,ie,re,ne,Z,ue,X,ee,Y,De,Q,K,fe,B,L,se,me,le,U,we,ce,z,S,$,Se],data:{animation:oe}});let m=l;return m})();function Ke(m){return l=>{let d=l.value;return console.log(m),d>m?{notEqual:!0}:null}}var Vt=[{path:"",component:qe}];export{Vt as default};
