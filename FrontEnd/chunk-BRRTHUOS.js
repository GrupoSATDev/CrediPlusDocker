import{a as Ae}from"./chunk-WJZEFJ2P.js";import{a as Ie}from"./chunk-2MB4UBZE.js";import{a as J}from"./chunk-3XMKQ74T.js";import{a as Me,b as De,c as ke}from"./chunk-YRZHMDGJ.js";import{a as K}from"./chunk-FIT6CNEK.js";import{a as Ne}from"./chunk-TRVR57AA.js";import{a as M}from"./chunk-YMBTTIVN.js";import{b as Ee}from"./chunk-4WJQLHI3.js";import{a as H}from"./chunk-MO2NC6JB.js";import{a as Fe}from"./chunk-H5OWTWVS.js";import"./chunk-3EEAMLKT.js";import{g as R}from"./chunk-45VFWK2F.js";import{c as he}from"./chunk-3F72AFMB.js";import"./chunk-T4J43FBS.js";import{a as _e}from"./chunk-T6KI2TP3.js";import"./chunk-C2OGGKTO.js";import{B as Y,C as q,G as E,b as B,e as ve,i as _,l as Se,n as L,p as Ce,q as U,r as Pe,u as z,w as Te,x as we,z as je}from"./chunk-JBQZ6BPD.js";import{$ as be,Q as O,R as $,ea as F,ja as ye}from"./chunk-SUQ5NR2B.js";import"./chunk-7ZG6LO6Q.js";import"./chunk-TO3CLTNT.js";import{a as xe}from"./chunk-7LIXJ3C3.js";import{b as ge,d as j}from"./chunk-FVVJ54UE.js";import{e as pe,f as de,g as ce,i as fe,j as g,l as w,m as u,s as ue}from"./chunk-SQ7M4XTP.js";import{$b as x,Db as i,Eb as n,Fb as c,Gb as Z,Hb as ee,Jb as le,Pb as b,Rb as y,Y as A,Yb as se,Zb as m,_a as r,_b as I,aa as ne,ec as S,fa as X,fc as C,ga as p,ic as me,la as v,nc as P,oc as T,q as re,qb as h,sb as s,va as V,wa as G,zb as k}from"./chunk-RICNMTJI.js";import{a as W,b as ie}from"./chunk-NEB6MB4Y.js";var D=(()=>{let o=class o{constructor(l,t){this._http=l,this.appSettings=t}getPagosTrabajadores(){return this._http.get(`${this.appSettings.pagoTrabajadores.url.base}/Tabla`)}postPagosTrabajadores(l){return this._http.post(this.appSettings.pagoTrabajadores.url.base,l)}getPagosTrabajador(l){return this._http.get(`${this.appSettings.pagoTrabajadores.url.base}/${l}`)}tipoPagoTrabajadores(){return this._http.get(this.appSettings.pagoTrabajadores.url.baseTipo)}};o.\u0275fac=function(t){return new(t||o)(X(ue),X(xe))},o.\u0275prov=ne({token:o,factory:o.\u0275fac,providedIn:"root"});let a=o;return a})();var Ve=(()=>{let o=class o{constructor(){this.datePipe=p(g),this.currencyPipe=p(u),this.pagoTrabajadorService=p(D),this._matDialog=p(he),this.estadoDatosService=p(H),this.router=p(j),this.data=[],this.columns=["Creaci\xF3n","Empresa","Total"],this.columnPropertyMap={Creaci\u00F3n:"fechaCreacion",Empresa:"nombreSubempresa",Total:"total"},this.buttons=[{label:"Eye",icon:"visibility",action:l=>{console.log("Editing",l),this.router.navigate(["/pages/gestion-cobros/trabajadores/pago/",l.id])}}]}ngOnDestroy(){}ngOnInit(){this.getPagoTrabajadores(),this.listenGrid()}onNew(){this.router.navigate(["/pages/gestion-cobros/trabajadores/pago"])}getPagoTrabajadores(){this.pagoTrabajadorService.getPagosTrabajadores().pipe(A(l=>(l.data.forEach(t=>{t.fechaCreacion=this.datePipe.transform(t.fechaCreacion,"dd/MM/yyyy"),t.total=this.currencyPipe.transform(t.total,"USD","symbol","1.2-2")}),l))).subscribe(l=>{this.data=l.data})}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(t=>{t&&this.getPagoTrabajadores()})}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=v({type:o,selectors:[["app-grid-pago-trabajadores"]],standalone:!0,features:[S([g,u]),C],decls:15,vars:11,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","w-full","shrink-0","flex-col","items-center","sm:ml-4","sm:mt-0","sm:flex-row","sm:space-x-2","sm:w-auto"],[1,"fuse-mat-dense","rounded-lg","w-full","sm:w-auto","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],["mat-flat-button","",1,"mt-2","w-full","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold","sm:ml-4","sm:mt-0","sm:w-auto",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(t,e){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),m(3,"Pago trabajadores"),n(),i(4,"div",3)(5,"mat-form-field",4),c(6,"mat-icon",5)(7,"input",6),n(),i(8,"button",7),b("click",function(){return e.onNew()}),c(9,"mat-icon",8),i(10,"span",9),m(11,"Pagar"),n()()()(),i(12,"div",10)(13,"div",11),c(14,"app-custom-table",12),n()()()),t&2&&(r(5),s("subscriptSizing","dynamic"),r(),s("svgIcon","heroicons_solid:magnifying-glass"),r(),s("autocomplete","off")("placeholder","Buscar"),r(),s("color","primary"),r(),s("svgIcon","heroicons_outline:plus"),r(5),s("columns",e.columns)("displayedColumns",e.columns)("columnPropertyMap",e.columnPropertyMap)("data",e.data)("buttons",e.buttons))},dependencies:[M,F,_,ye,E]});let a=o;return a})();var Be=(a,o)=>({"bg-credigray-100":a,"bg-green-600":o});function Re(a,o){if(a&1&&(i(0,"mat-option",24),m(1),n()),a&2){let d=o.$implicit;s("value",d.id),r(),I(d.nombre)}}function Le(a,o){if(a&1&&(Z(0),h(1,Re,2,2,"mat-option",23),ee()),a&2){let d=o.ngIf;r(),s("ngForOf",d.data)}}function Ue(a,o){if(a&1&&(i(0,"mat-option",24),m(1),n()),a&2){let d=o.$implicit;s("value",d.id),r(),I(d.razonSocial)}}function ze(a,o){if(a&1&&(Z(0),h(1,Ue,2,2,"mat-option",23),ee()),a&2){let d=o.ngIf;r(),s("ngForOf",d.data)}}function Ye(a,o){if(a&1&&(i(0,"div",19)(1,"div",25),c(2,"app-custom-table",26),n()()),a&2){let d=y();r(2),s("columns",d.columns)("displayedColumns",d.columns)("columnPropertyMap",d.columnPropertyMap)("data",d.data)}}function qe(a,o){if(a&1&&(i(0,"div",20)(1,"div",27)(2,"fuse-alert",28)(3,"span",29),m(4,"Informaci\xF3n"),n(),m(5),n()()()),a&2){let d=y();r(2),s("type","info")("appearance","outline"),r(3),x(" ",d.message," ")}}function He(a,o){if(a&1&&(i(0,"span",22),m(1,"Subtotal: "),i(2,"span",30),m(3),P(4,"currency"),n()()),a&2){let d=y();r(3),I(T(4,1,d.subtotal))}}function Je(a,o){if(a&1&&(i(0,"span",22),m(1,"Comisiones: "),i(2,"span",30),m(3),P(4,"currency"),n()()),a&2){let d=y();r(3),I(T(4,1,d.totalComision))}}function Ke(a,o){if(a&1&&(i(0,"span",22),m(1,"Total a pagar: "),i(2,"span",30),m(3),P(4,"currency"),n()()),a&2){let d=y();r(3),x(" ",T(4,1,d.totalPagar)," ")}}var Qe={validation:!1},Ge=(()=>{let o=class o{constructor(){this.fb=p(je),this.empresaClienteService=p(Ie),this.pagoTrabajadorService=p(D),this.cobroTrabajadorService=p(Ae),this.datePipe=p(g),this.swalService=p(Ne),this.estadosDatosService=p(H),this.fuseService=p(R),this.currencyPipe=p(u),this.decimalPipe=p(w),this.router=p(j),this.empresa$=this.empresaClienteService.getEmpresasClientes(),this.tipoPago$=this.pagoTrabajadorService.tipoPagoTrabajadores(),this.data=[],this.columns=["N\xFAmero de identificaci\xF3n","N\xFAmero de cuotas","Valor pendiente","Fecha de cobro"],this.columnPropertyMap={"N\xFAmero de identificaci\xF3n":"documentoTrabajador","N\xFAmero de cuotas":"numCuota","Valor pendiente":"valorPendiente","Fecha de cobro":"fechaCobro"}}createForm(){this.form=this.fb.group({fechaFinal:["",L.required],idSubEmpresa:["",L.required],idTipoPagoTrabajador:["",L.required]})}ngOnInit(){this.createForm()}closeDialog(){this.router.navigate(["/pages/gestion-cobros/trabajadores"])}onGet(){if(this.form.valid){let{fechaFinal:l,idSubEmpresa:t}=this.form.getRawValue();console.log(l);let f={fechaFinallData:this.datePipe.transform(l,"yyyy-MM-dd"),idSubEmpresa:t};this.getAllPagoTrabajador(f)}}onSave(){let{fechaFinal:l,idSubEmpresa:t,idTipoPagoTrabajador:e}=this.form.getRawValue(),N={fechaFinal:this.datePipe.transform(l,"yyyy-MM-dd"),idSubEmpresa:t},ae=[];ae=this.data.map(Q=>({idCobroTrabajador:Q.id}));let oe=ie(W({},N),{idTipoPagoTrabajador:e,detallePagoTrabajador:ae});console.log(oe),this.fuseService.open(W({},Ee)).afterClosed().subscribe(Q=>{Q==="confirmed"&&this.postSave(oe)})}getAllPagoTrabajador(l){this.cobroTrabajadorService.getCobroTrabajador(l).pipe(re(t=>(this.subtotal=0,this.totalComision=0,this.totalPagar=0,t&&Array.isArray(t.data)?t.data.forEach(e=>{e.comision=e.montoConsumo*e.porcentajeSubEmpresa/100,e.pagar=e.montoConsumo-e.comision,e.montoConsumo=this.currencyPipe.transform(e.montoConsumo,"USD","symbol","1.2-2"),e.comision=this.currencyPipe.transform(e.comision,"USD","symbol","1.2-2"),e.pagar=this.currencyPipe.transform(e.pagar,"USD","symbol","1.2-2"),e.valorPendiente=this.currencyPipe.transform(e.valorPendiente,"USD","symbol","1.2-2"),e.fechaCobro=this.datePipe.transform(e.fechaCobro,"dd/MM/yyyy")}):this.data=[],t))).subscribe(t=>{t&&Array.isArray(t.data)?this.data=t.data:(this.data=[],this.message=t.msg)})}postSave(l){this.pagoTrabajadorService.postPagosTrabajadores(l).subscribe(t=>{this.swalService.ToastAler({icon:"success",title:"Registro Creado o Actualizado con Exito.",timer:4e3}),this.estadosDatosService.stateGrid.next(!0),this.closeDialog()},t=>{this.swalService.ToastAler({icon:"error",title:"Ha ocurrido un error al crear el registro!",timer:4e3})})}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=v({type:o,selectors:[["app-form-pago-trabajadores"]],standalone:!0,features:[S([{provide:$,useClass:J},{provide:O,useValue:"en-GB"},g,u,w,K(Qe)]),C],decls:45,vars:24,consts:[["finalPicker",""],[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","sm:flex-row","md:px-8"],[1,"mt-6","w-full","shrink-0","sm:mt-0","sm:space-x-2","lg:w-full"],[1,"mt-8",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","gap-2.5"],["floatLabel","always",1,"w-full","min-w-90"],["matInput","","placeholder","dd/mm/yyyy",3,"matDatepicker","formControlName"],["matIconSuffix","",3,"for"],["placeholder","Tipo de pago trabajador",3,"formControlName"],[4,"ngIf"],["placeholder","Empresa",3,"formControlName"],[1,"relative","p-4","border","border-gray-300","rounded-lg","mt-4"],[1,"absolute","-top-3","left-4","bg-white","px-2","text-gray-500","font-semibold"],[1,"flex","flex-wrap","justify-end","gap-2.5","sm:mb-4"],["mat-flat-button","",1,"sm:w-auto","w-full","sm:mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"sm:w-auto","w-full","sm:mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"lg:w-auto","w-full","sm:mt-6","transition","duration-200","text-white","font-semibold","rounded-lg","md:w-auto",3,"click","ngClass","disabled"],[1,"flex","flex-auto","overflow-hidden"],[1,"inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","gap-4","justify-end","sm:flex-row"],[1,"sm:pr-4","text-gray-600","font-bold","text-right"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:p-4","sm:mb-10","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data"],[1,"inline-block","p-4","sm:p-8","print:p-0","w-full"],[3,"type","appearance"],["fuseAlertTitle",""],[1,"text-gray-800"]],template:function(t,e){if(t&1){let f=le();i(0,"div",1)(1,"div",2),m(2),n(),i(3,"div",3)(4,"div",4)(5,"form",5)(6,"div",6)(7,"mat-form-field",7)(8,"mat-label"),m(9,"Fecha de corte"),n(),c(10,"input",8)(11,"mat-datepicker-toggle",9)(12,"mat-datepicker",null,0),n(),i(14,"mat-form-field",7)(15,"mat-label"),m(16,"Tipo de pago"),n(),i(17,"mat-select",10),h(18,Le,2,1,"ng-container",11),P(19,"async"),n()(),i(20,"mat-form-field",7)(21,"mat-label"),m(22,"Empresa"),n(),i(23,"mat-select",12),h(24,ze,2,1,"ng-container",11),P(25,"async"),n()()(),i(26,"div",13)(27,"div",14),m(28," Opciones "),n(),i(29,"div",15)(30,"button",16),b("click",function(){return V(f),G(e.closeDialog())}),i(31,"span"),m(32," Atras "),n()(),i(33,"button",17),b("click",function(){return V(f),G(e.onGet())}),i(34,"span"),m(35," Consultar "),n()(),i(36,"button",18),b("click",function(){return V(f),G(e.onSave())}),i(37,"span"),m(38," Pagar "),n()()()()()()(),h(39,Ye,3,4,"div",19)(40,qe,6,3,"div",20),i(41,"div",21),h(42,He,5,3,"span",22)(43,Je,5,3,"span",22)(44,Ke,5,3,"span",22),n()()}if(t&2){let f=se(13);r(2),x(" ","Pago trabajadores"," "),r(3),s("formGroup",e.form),r(5),s("matDatepicker",f)("formControlName","fechaFinal"),r(),s("for",f),r(6),s("formControlName","idTipoPagoTrabajador"),r(),s("ngIf",T(19,17,e.tipoPago$)),r(5),s("formControlName","idSubEmpresa"),r(),s("ngIf",T(25,19,e.empresa$)),r(6),s("color","primary"),r(3),s("color","primary"),r(3),s("ngClass",me(21,Be,e.data.length==0,e.data.length>0))("disabled",e.data.length==0),r(3),k(e.data.length?39:e.message?40:-1),r(3),k(e.subtotal?42:-1),r(),k(e.totalComision?43:-1),r(),k(e.totalPagar?44:-1)}},dependencies:[fe,u,M,Y,z,Se,Ce,U,_e,F,Me,De,ke,_,E,B,be,Fe,ve,de,ce,q,Te,we,pe]});let a=o;return a})();var We={validation:!1},Oe=(()=>{let o=class o{constructor(){this.fuseService=p(R),this.currencyPipe=p(u),this.decimalPipe=p(w),this.router=p(j),this.activatedRoute=p(ge),this.datePipe=p(g),this.pagoTrabajadorService=p(D),this.data=[],this.form={fechaCreacion:"",fechaFinal:"",fechaIncial:"",nombreSubempresa:"",total:""},this.columns=["N\xFAmero de identificaci\xF3n","Fecha de creaci\xF3n","N\xFAmero de cuota","Valor"],this.columnPropertyMap={"N\xFAmero de identificaci\xF3n":"documentoTrabajador","Fecha de creaci\xF3n":"fechaCobro","N\xFAmero de cuota":"numCuota",Valor:"valorPago"}}ngOnDestroy(){this.subscription$.unsubscribe()}ngOnInit(){this.id=this.activatedRoute.snapshot.paramMap.get("id"),this.getTrabajador(this.id)}getTrabajador(l){this.subscription$=this.pagoTrabajadorService.getPagosTrabajador(l).pipe(A(t=>(t.data.detallePagoTrabajador?.forEach(e=>{e.fechaCobro=this.datePipe.transform(e.fechaCobro,"dd/MM/yyyy"),e.valorPago=this.currencyPipe.transform(e.valorPago,"USD","symbol","1.2-2")}),t))).subscribe(t=>{console.log("Si entra"),this.data=t.data.detallePagoTrabajador,this.form.fechaCreacion=this.datePipe.transform(t.data.fechaCreacion,"dd/MM/YYYY"),this.form.fechaFinal=t.data.fechaFinal,this.form.nombreSubempresa=t.data.nombreSubempresa,this.form.total=this.currencyPipe.transform(t.data.total,"USD","symbol","1.2-2")})}closeDialog(){this.router.navigate(["/pages/gestion-cobros/trabajadores"])}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=v({type:o,selectors:[["app-form-view-pago-trabajadores"]],standalone:!0,features:[S([{provide:$,useClass:J},{provide:O,useValue:"en-GB"},g,u,w,K(We)]),C],decls:32,vars:9,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"sm:ml-8","mt-8","text-3xl","font-semibold","leading-tight","tracking-tight"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","sm:flex-row","md:px-8"],[1,"mt-6","w-full","shrink-0","sm:mt-0","sm:space-x-2","lg:w-full"],[1,"mt-8"],[1,"flex","flex-col","sm:flex-row","gap-2.5"],["floatLabel","always",1,"w-full","min-w-90"],["matInput","","placeholder","Empresa","readonly","",3,"value"],[1,"relative","p-2","border","border-gray-300","rounded-lg"],[1,"absolute","-top-3","left-4","bg-white","px-2","text-gray-500","font-semibold"],[1,"flex","flex-wrap","justify-end","gap-2.5","sm:mb-4"],["mat-flat-button","",1,"sm:w-auto","w-full","sm:mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"lg:w-auto","w-full","sm:mt-6","bg-green-600","transition","duration-200","text-white","font-semibold","rounded-lg","md:w-auto"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:p-4","sm:mb-10","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data"]],template:function(t,e){t&1&&(i(0,"div",0)(1,"div",1),m(2),n(),i(3,"div",2)(4,"div",3)(5,"form",4)(6,"div",5)(7,"mat-form-field",6)(8,"mat-label"),m(9,"Empresa"),n(),c(10,"input",7),n(),i(11,"mat-form-field",6)(12,"mat-label"),m(13,"Fecha de creaci\xF3n"),n(),c(14,"input",7),n(),i(15,"mat-form-field",6)(16,"mat-label"),m(17,"Total"),n(),c(18,"input",7),n()(),i(19,"div",8)(20,"div",9),m(21," Opciones "),n(),i(22,"div",10)(23,"button",11),b("click",function(){return e.closeDialog()}),i(24,"span"),m(25," Atras "),n()(),i(26,"button",12)(27,"span"),m(28," Descargar "),n()()()()()()(),i(29,"div",13)(30,"div",14),c(31,"app-custom-table",15),n()()()),t&2&&(r(2),x(" ","Detalle pago trabajadores"," "),r(8),s("value",e.form.nombreSubempresa),r(4),s("value",e.form.fechaCreacion),r(4),s("value",e.form.total),r(5),s("color","primary"),r(8),s("columns",e.columns)("displayedColumns",e.columns)("columnPropertyMap",e.columnPropertyMap)("data",e.data))},dependencies:[M,Y,z,U,Pe,F,_,E,B,q]});let a=o;return a})();var na=[{path:"",component:Ve},{path:"pago",component:Ge},{path:"pago/:id",component:Oe}];export{na as default};
