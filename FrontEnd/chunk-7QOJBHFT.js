import{a as x}from"./chunk-4GQ5MQ3M.js";import{a as se}from"./chunk-YEQVMDAS.js";import{a as me}from"./chunk-QE3E4OX7.js";import{a as R,b as le}from"./chunk-GD676RBR.js";import{a as M}from"./chunk-OFEOPKCC.js";import{a as ne}from"./chunk-QYSIOB6Y.js";import"./chunk-ISHIQJYM.js";import{g as X}from"./chunk-CUGJBCL5.js";import{a as J,b as q,c as K}from"./chunk-3P4FUJJD.js";import"./chunk-4CCKGQO6.js";import{C as re,G as D,b as Q,i as E,l as Y,p as Z,q as ee,u as te,w as ie,x as oe,z as ae}from"./chunk-7YVLRDAA.js";import{$ as H,ea as y,ja as U}from"./chunk-T34F2ICN.js";import"./chunk-XMIUBE2U.js";import"./chunk-PDEGUYSW.js";import{f as P,g as j,i as L,n as W}from"./chunk-YH7HM3TK.js";import{Cb as o,Db as t,Eb as p,Fb as T,Gb as A,Ib as B,Ob as g,Yb as l,Za as e,Zb as G,_a as _,_b as k,ec as C,fa as f,ka as v,mc as z,nc as V,pb as h,rb as i,ua as b,va as S}from"./chunk-32HXX3OB.js";import{a as I,d as N}from"./chunk-NEB6MB4Y.js";function de(m,n){if(m&1&&(o(0,"mat-option",19),l(1),t()),m&2){let d=n.$implicit;i("value",d.id),e(),G(d.nombre)}}function fe(m,n){if(m&1&&(T(0),h(1,de,2,2,"mat-option",18),A()),m&2){let d=n.ngIf;e(),i("ngForOf",d.data)}}function ue(m,n){if(m&1&&(o(0,"mat-option",19),l(1),t()),m&2){let d=n.$implicit;i("value",d.id),e(),G(d.nombre)}}function ge(m,n){if(m&1&&(T(0),h(1,ue,2,2,"mat-option",18),A()),m&2){let d=n.ngIf;e(),i("ngForOf",d.data)}}var $=(()=>{let n=class n{constructor(){this.fb=f(ae),this._locacionService=f(se),this.empresasService=f(x),this.dialogRef=f(J),this.fuseService=f(X),this.estadosDatosService=f(M),this.toasService=f(le),this.departamentos$=this._locacionService.getDepartamentos(),this._matData=f(q)}getMunicipios(s){let a=s.value;this.municipios$=this._locacionService.getMunicipio(a)}ngOnInit(){this.createForm();let s=this._matData;if(s.edit){let a=s.data;this.form.patchValue(a);let{idDepartamento:r}=a;this.municipios$=this._locacionService.getMunicipio(r)}}createForm(){this.form=this.fb.group({id:[null],nit:[""],razonSocial:[""],correo:[""],telefono:[""],direccion:[""],idDepartamento:[""],idMunicipio:[""]})}onSave(){if(this.form.valid)if(this._matData.edit){let a=this.form.getRawValue(),{idDepartamento:c}=a,u=N(a,["idDepartamento"]);this.fuseService.open(I({},R)).afterClosed().subscribe(w=>{w==="confirmed"?this.empresasService.putEmpresa(u).subscribe(O=>{this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro actualizado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}else{let s=this.form.getRawValue(),{idDepartamento:c}=s,u=N(s,["idDepartamento"]);this.fuseService.open(I({},R)).afterClosed().subscribe(w=>{w==="confirmed"?this.empresasService.postEmpresa(u).subscribe(O=>{console.log(O),this.estadosDatosService.stateGrid.next(!0),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.closeDialog()}):this.closeDialog()})}}closeDialog(){this.dialogRef.close()}};n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=v({type:n,selectors:[["app-form-empresas"]],standalone:!0,features:[C],decls:49,vars:18,consts:[["data",""],[1,"w-full","sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto"],[1,""],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[1,"mt-8",3,"formGroup"],[1,"flex","mb-4","gap-2"],[1,"w-full"],["id","nit","matInput","","placeholder","Nit",3,"formControlName"],["matInput","","placeholder","Raz\xF3n social",3,"formControlName"],["matInput","","placeholder","Correo electronico",3,"formControlName"],["matInput","","placeholder","Tel\xE9fono",3,"formControlName"],[3,"selectionChange","formControlName"],[4,"ngIf"],[3,"formControlName"],["matInput","",3,"formControlName"],[1,"flex","flex-wrap","justify-end","gap-2.5"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","bg-credigray-100","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(a,r){if(a&1){let c=B();o(0,"div",1)(1,"div",2)(2,"div",3),l(3),t(),o(4,"form",4)(5,"div",5)(6,"mat-form-field",6)(7,"mat-label"),l(8,"Nit"),t(),p(9,"input",7),t(),o(10,"mat-form-field",6)(11,"mat-label"),l(12,"Raz\xF3n social"),t(),p(13,"input",8),t()(),o(14,"div",5)(15,"mat-form-field",6)(16,"mat-label"),l(17,"Correo"),t(),p(18,"input",9),t(),o(19,"mat-form-field",6)(20,"mat-label"),l(21,"Tel\xE9fono"),t(),p(22,"input",10),t()(),o(23,"div",5)(24,"mat-form-field",6)(25,"mat-label"),l(26,"Departamento"),t(),o(27,"mat-select",11,0),g("selectionChange",function(F){return b(c),S(r.getMunicipios(F))}),h(29,fe,2,1,"ng-container",12),z(30,"async"),t()(),o(31,"mat-form-field",6)(32,"mat-label"),l(33,"Ciudad"),t(),o(34,"mat-select",13),h(35,ge,2,1,"ng-container",12),z(36,"async"),t()()(),o(37,"div",5)(38,"mat-form-field",6)(39,"mat-label"),l(40,"Direcci\xF3n"),t(),p(41,"input",14),t()(),o(42,"div",15)(43,"button",16),g("click",function(){return b(c),S(r.closeDialog())}),o(44,"span"),l(45," Cancelar "),t()(),o(46,"button",17),g("click",function(){return b(c),S(r.onSave())}),o(47,"span"),l(48),t()()()()()()}a&2&&(e(3),k(" ",r._matData.edit?"Actualizar empresa":"Agregar empresa"," "),e(),i("formGroup",r.form),e(5),i("formControlName","nit"),e(4),i("formControlName","razonSocial"),e(5),i("formControlName","correo"),e(4),i("formControlName","telefono"),e(5),i("formControlName","idDepartamento"),e(2),i("ngIf",V(30,14,r.departamentos$)),e(5),i("formControlName","idMunicipio"),e(),i("ngIf",V(36,16,r.municipios$)),e(6),i("formControlName","direccion"),e(2),i("color","primary"),e(3),i("color","primary"),e(2),k(" ",r._matData.edit?"Actualizar":"Guardar"," "))},dependencies:[E,D,y,Q,ne,H,j,L,P,re,te,Y,Z,ee,ie,oe]});let m=n;return m})();var ce=(()=>{let n=class n{constructor(s,a,r){this._matDialog=s,this.empresasService=a,this.estadoDatosService=r,this.searchTerm="",this.data=[],this.columns=["Nit","Razon social","Correo","Telefono","Direccion"],this.columnPropertyMap={Nit:"nit","Razon social":"razonSocial",Correo:"correo",Telefono:"telefono",Direccion:"direccion"},this.buttons=[{label:"Edit",icon:"edit",action:c=>{console.log("Editing",c),this.selectedData=c,this.onEdit()}}]}onNew(){this._matDialog.open($,{autoFocus:!1,data:{edit:!1},maxHeight:"90vh",width:"50%",maxWidth:"100%",disableClose:!0})}onEdit(){this._matDialog.open($,{autoFocus:!1,data:{edit:!0,data:this.selectedData},maxHeight:"90vh",width:"50%",maxWidth:"100%",disableClose:!0})}getEmpresas(){this.subcription$=this.empresasService.getEmpresas().subscribe(s=>{this.data=s.data})}ngOnInit(){this.getEmpresas(),this.listenGrid()}listenGrid(){this.estadoDatosService.stateGrid.asObservable().subscribe(a=>{a&&this.getEmpresas()})}onSearch(s){let a=s.target;this.searchTerm=a.value.trim().toLowerCase()}ngOnDestroy(){this.subcription$.unsubscribe()}ngAfterViewInit(){}};n.\u0275fac=function(a){return new(a||n)(_(K),_(x),_(M))},n.\u0275cmp=v({type:n,selectors:[["app-grid-empresas"]],standalone:!0,features:[C],decls:15,vars:12,consts:[[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","rounded-lg","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"input","autocomplete","placeholder"],["mat-flat-button","",1,"ml-4","bg-crediblue-50","rounded-lg","transition","duration-200","text-white","font-semibold",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons","searchTerm"]],template:function(a,r){a&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),l(3,"Empresas Maestras"),t(),o(4,"div",3)(5,"mat-form-field",4),p(6,"mat-icon",5),o(7,"input",6),g("input",function(u){return r.onSearch(u)}),t()(),o(8,"button",7),g("click",function(){return r.onNew()}),p(9,"mat-icon",8),o(10,"span",9),l(11,"Agregar"),t()()()(),o(12,"div",10)(13,"div",11),p(14,"app-custom-table",12),t()()()),a&2&&(e(5),i("subscriptSizing","dynamic"),e(),i("svgIcon","heroicons_solid:magnifying-glass"),e(),i("autocomplete","off")("placeholder","Buscar"),e(),i("color","primary"),e(),i("svgIcon","heroicons_outline:plus"),e(5),i("columns",r.columns)("displayedColumns",r.columns)("columnPropertyMap",r.columnPropertyMap)("data",r.data)("buttons",r.buttons)("searchTerm",r.searchTerm))},dependencies:[W,E,U,y,D,me]});let m=n;return m})();var Ke=[{path:"",component:ce}];export{Ke as default};
